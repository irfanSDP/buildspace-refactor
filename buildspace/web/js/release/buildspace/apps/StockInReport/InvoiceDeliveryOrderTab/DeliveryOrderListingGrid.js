(function(){define("buildspace/apps/StockInReport/InvoiceDeliveryOrderTab/DeliveryOrderListingGrid","dojo/_base/declare dojo/_base/lang dojox/grid/enhanced/plugins/Menu dojox/grid/enhanced/plugins/Rearrange dojo/store/Memory buildspace/widget/grid/plugins/FormulatedColumn dojo/request dijit/focus dijit/Toolbar dijit/form/Button dijit/DropDownMenu dijit/form/DropDownButton dijit/MenuItem dijit/layout/BorderContainer buildspace/widget/grid/cells/Formatter buildspace/widget/grid/cells/FormulaTextBox buildspace/widget/grid/Filter ./DeliveryOrderItemListGrid ./PrintPreviewDialog/PrintSelectedDOItemGrid dojo/i18n!../../../nls/StockIn".split(" "),
function(k,B,C,r,t,u,l,D,v,E,w,x,y,m,n,F,p,z,A,c){var q;q=k("buildspace.apps.StockInReport.InvoiceInformation.DeliveryOrderListingGrid",dojox.grid.EnhancedGrid,{style:"border-top:none;",keepSelection:!0,rowSelector:"0px",region:"center",deliveryOrderContainer:null,invoice:null,constructor:function(){this.rearranger=r(this,{});return this.formulatedColumn=u(this,{})},canSort:function(){return!1},refreshGrid:function(){this.store.save();this.store.close();return this.setStore(this.store)}});return k("buildspace.apps.StockInReport.InvoiceInformation.DeliveryOrderContainer",
m,{invoice:null,doItemCheckedStore:null,style:"height:100%;width:100%;padding:0;margin:0;",gutters:!1,postCreate:function(){var a,f,b,d,g,e;this.inherited(arguments);d=this;e="stockInReportInvoiceDeliveryOrderList-"+this.invoice.id[0];(g=dijit.byId(e+"-stackContainer"))&&dijit.byId(e+"-stackContainer").destroyRecursive();g=d.stackContainer=new dijit.layout.StackContainer({style:"width:100%;height:100%;",region:"center",id:e+"-stackContainer"});a=new dojo.data.ItemFileWriteStore({url:"stockIn/getDeliveryOrderListings/invoiceId/"+
this.invoice.id[0],clearOnClose:!0,urlPreventCache:!0});f=new q({structure:d.getDeliveryOrderGridLayout(),store:a,invoice:this.invoice,invoiceId:this.invoice.id[0],escapeHTMLInData:!1,deliveryOrderContainer:d,onRowDblClick:function(a){var b,e;d=this;b=this.getItem(a.rowIndex);if(0<b.id[0])return e=new buildspace.dialog.indeterminateProgressBar({title:c.processing+"..."}),e.show(),l.get("stockIn/getDeliveryOrderItemQuantities",{query:{deliveryOrderId:b.id},handleAs:"json"}).then(function(a){e.hide();
return d.deliveryOrderContainer.createDeliveryOrderItemQuantityView(b,a)},function(a){return e.hide()})}});a=new p({region:"top",grid:f,editableGrid:!1,filterFields:[{delivery_order_no:c.doNo}]});b=new m({region:"top",gutters:!1});b.addChild(a);b.addChild(new dijit.layout.ContentPane({style:"width:100%",content:f,region:"center"}));a=new dijit.layout.ContentPane({title:c.deliveryOrder,content:b});g.addChild(a);a=new dijit.layout.StackController({region:"top",containerId:e+"-stackContainer"});a=new dijit.layout.ContentPane({style:"padding: 0px; overflow: hidden;",
baseClass:"breadCrumbTrail",region:"top",content:a});this.addChild(g);this.addChild(a);return dojo.subscribe(e+"-stackContainer-selectChild","",function(a){var b,c,d;if(c=dijit.byId(e+"-stackContainer")){b=c.getChildren();a=dojo.indexOf(b,dijit.byId(a.id))+1;for(d=[];b.length>a;)c.removeChild(b[a]),b[a].destroyRecursive(),d.push(a+=1);return d}})},createDeliveryOrderItemQuantityView:function(a,f){var b,d,g,e,h;e=this;this.doItemCheckedStore=new t({idProperty:"id"});b=new dojo.data.ItemFileWriteStore({data:f,
clearOnClose:!0,urlPreventCache:!0});d=new z({gridContainer:e,invoice:e.invoice,invoiceId:e.invoice.id[0],deliveryOrder:a,store:b,structure:e.getDeliveryOrderItemQuantityViewGridLayout()});b=new dijit.layout.BorderContainer({style:"padding:0px;width:100%;height:100%;",baseClass:"form",gutters:!1,region:"center"});b.addChild(new p({region:"top",grid:d,editableGrid:!1,filterFields:[{description:c.description},{uom:c.unit},{invoiceQuantity:c.invoiceQuantity},{doQuantity:c.doQuantity},{remarks:c.remarks}]}));
h=new v({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;border-bottom:none;"});g=new w({style:"display: none;"});g.addChild(new y({label:c.printDOItemsByResourceTrade,iconClass:"icon-16-container icon-16-print",onClick:function(){return e.openPreviewDialogForSelectedDOItems(a)}}));h.addChild(new x({label:c.print,id:"stockInReport-doItem-printButton-"+e.invoice.id[0],iconClass:"icon-16-container icon-16-print",dropDown:g}));b.addChild(h);b.addChild(new dijit.layout.ContentPane({style:"width:100%",
content:d,region:"center"}));return e.makePane(a.delivery_order_no[0],b)},getDeliveryOrderGridLayout:function(){var a;a=new n;return[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:a.rowCountCellFormatter,noresize:!0},{name:c.deliveryOrderNo,field:"delivery_order_no",width:"auto",formatter:a.treeCellFormatter,noresize:!0},{name:c.downloadFile,field:"download_file",width:"100px",styles:"text-align: center;",noresize:!0},{name:c.date_of_delivery_order,field:"delivery_order_date",
width:"160px",styles:"text-align: center;",filterable:!1,noresize:!0}]},getDeliveryOrderItemQuantityViewGridLayout:function(){var a;a=new n;return[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:a.rowCountCellFormatter},{name:c.description,field:"description",width:"auto",formatter:a.treeCellFormatter},{name:c.remarks,field:"remarks",width:"280px",formatter:a.rfqSupplierRemarkCellFormatter},{name:c.unit,field:"uom",width:"70px",styles:"text-align: center;",formatter:a.rfqUnitCellFormatter},
{name:c.invoiceQuantity,field:"invoiceQuantity",width:"90px",styles:"text-align: right;",cellType:"buildspace.widget.grid.cells.FormulaTextBox",formatter:a.rfqQuantityCellFormatter},{name:c.doQuantity,field:"doQuantity",width:"90px",styles:"text-align: right;",cellType:"buildspace.widget.grid.cells.FormulaTextBox",formatter:a.rfqQuantityCellFormatter}]},openPreviewDialogForSelectedDOItems:function(a){var f,b,d;d=this.doItemCheckedStore;f=[];d.query().forEach(function(a){return f.push(a.id)});f=f.reverse().filter(function(a,
b,c){return-1===c.indexOf(a,b+1)}).reverse();b=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+"..."});b.show();return l.post("stockInReporting/getPrintPreviewStockOutDOItems",{handleAs:"json",data:{deliveryOrderId:a.id[0],item_ids:JSON.stringify(f)}}).then(function(d){(new A({title:c.printDOItemsByResourceTrade,deliveryOrderId:a.id[0],data:d,selectedItems:f})).show();return b.hide()},function(a){console.log(a);return b.hide()})},makePane:function(a,c){var b,d;d=dijit.byId("stockInReportInvoiceDeliveryOrderList-"+
this.invoice.id[0]+"-stackContainer");b=new dijit.layout.ContentPane({title:a,content:c});d.addChild(b);return d.selectChild(b)}})})}).call(this);
