define("buildspace/apps/ScheduleOfRateLibraryReport/grid","dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/aspect dojo/request dojo/dom-attr dijit/TooltipDialog dijit/popup dojox/grid/enhanced/plugins/Menu dojo/number dojox/grid/enhanced/plugins/Selector dojox/grid/enhanced/plugins/Rearrange buildspace/widget/grid/plugins/FormulatedColumn dojox/grid/enhanced/plugins/IndirectSelection buildspace/widget/grid/Filter dojo/_base/event dojo/keys dijit/focus dojo/_base/html dojo/request/xhr dijit/PopupMenuItem buildspace/widget/grid/cells/Textarea buildspace/widget/grid/cells/FormulaTextBox dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem ./PrintItemsDialog dojo/i18n!buildspace/nls/ScheduleOfRateLibrary".split(" "),
function(k,l,d,z,p,m,A,q,g,B,C,D,r,t,E,u,F,G,H,I,J,K,L,M,v,w,x,n,e){var y=k("buildspace.apps.ScheduleOfRateLibraryReport.Grid",dojox.grid.EnhancedGrid,{type:null,libraryId:0,tradeId:0,style:"border-top:none;",selectedItem:null,borderContainerWidget:null,keepSelection:!0,rowSelector:"0px",gridContainer:null,constructor:function(a){this.rearranger=r(this,{});this.formulatedColumn=t(this,{});this.plugins={indirectSelection:{headerSelector:!0,width:"40px",styles:"text-align: center;"}};this.inherited(arguments)},
canSort:function(a){return!1},dodblclick:function(a){this.onRowDblClick(a)},postCreate:function(){var a=this,b=null;a.inherited(arguments);"tree"===a.type&&p.after(a,"_onFetchComplete",function(){a.gridContainer.markedCheckBoxObject(a,a.gridContainer.selectedItemStore[a.libraryId])});if("tree"===a.type){var h={"rate-value":1};this._connects.push(d.connect(this,"onCellMouseOver",function(a){var c=a.cell.field,e=a.cell.field_name,d=a.rowIndex,f=this.getItem(d);"undefined"!==typeof h[e]&&(c=c.replace("-value",
""),"undefined"!==typeof f[c+"-has_formula"]&&f[c+"-has_formula"][0]&&(f=f[c+"-value"][0],f=this.formulatedColumn.convertItemIdToRowIndex(f,d),null===b&&(b=new q({content:f,onMouseLeave:function(){g.close(b)}}),g.open({popup:b,around:a.cellNode}))))}));this._connects.push(d.connect(this,"onCellMouseOut",function(){null!==b&&(g.close(b),b=null)}));this._connects.push(d.connect(this,"onStartEdit",function(){null!==b&&(g.close(b),b=null)}))}},startup:function(){var a=this;a.inherited(arguments);this._connects.push(d.connect(this,
"onCellClick",function(b){""===b.cell.name&&a.singleCheckBoxSelection(b)}));this._connects.push(d.connect(this.rowSelectCell,"toggleAllSelection",function(b){a.toggleAllSelection(b)}))}});return k("buildspace.apps.ScheduleOfRateLibraryReport.grid",dijit.layout.BorderContainer,{pageId:"page-00",style:"padding:0px;border:0px;width:100%;height:100%;",gutters:!1,stackContainerTitle:null,libraryId:0,tradeId:0,rowSelector:null,gridOpts:{},type:null,postCreate:function(){var a=this,b;this.inherited(arguments);
l.mixin(a.gridOpts,{libraryId:a.libraryId,tradeId:a.tradeId,type:a.type,region:"center",borderContainerWidget:a});var h=new w({style:"display: none;"}),c=new dijit.Toolbar({region:"top",style:"padding:2px;border-bottom:none;width:100%;"}),d=this.grid=new y(a.gridOpts);b="tree"==a.type?[{description:e.description},{uom_symbol:e.unit},{"rate-final_value":e.rate}]:[{description:e.description}];dojo.forEach(["selectedItems","selectedItemsWithBuildUpRates"],function(b){var c;switch(b){case "selectedItems":c=
"openPrintSelectedItems";break;case "selectedItemsWithBuildUpRates":c="openPrintSelectedItemsWithBuildUpRates"}h.addChild(new x({label:e[b],onClick:function(){a[c](b)}}))});c.addChild(new v({label:e.printPreview,iconClass:"icon-16-container icon-16-print",dropDown:h}));a.addChild(new u({region:"top",grid:d,filterFields:b,editableGrid:!0}));a.addChild(c);a.addChild(new dijit.layout.ContentPane({style:"width:100%",content:d,region:"center"}));if(b=dijit.byId("scheduleOfRate_report_"+a.libraryId+"-stackContainer"))c=
document.createElement("div"),c=new dojox.layout.ContentPane({title:buildspace.truncateString(a.stackContainerTitle,60),id:a.pageId,executeScripts:!0},c),b.addChild(c),c.set("content",a),l.mixin(c,{grid:d}),b.selectChild(a.pageId)},openPrintSelectedItems:function(){var a=this,b=[];a.gridOpts.gridContainer.selectedItemStore[a.libraryId].query().forEach(function(a){b.push(a.id)});var d=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});d.show();m.post("scheduleOfRateReporting/getPrintPreviewSelectedItems",
{handleAs:"json",data:{libraryId:a.libraryId,item_ids:JSON.stringify(a.gridOpts.gridContainer.arrayUnique(b))}}).then(function(c){(new n({libraryId:a.libraryId,title:e.selectedItems,data:c,selectedItems:b,printURL:"scheduleOfRateReporting/printingSelectedItems",exportURL:"scheduleOfRateExportExcelReporting/exportExcelSelectedItems"})).show();d.hide()},function(a){console.log(a);d.hide()})},openPrintSelectedItemsWithBuildUpRates:function(){var a=this,b=[];a.gridOpts.gridContainer.selectedItemStore[a.libraryId].query().forEach(function(a){b.push(a.id)});
var d=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});d.show();m.post("scheduleOfRateReporting/getPrintPreviewSelectedItemsWithBuildUpRates",{handleAs:"json",data:{libraryId:a.libraryId,item_ids:JSON.stringify(a.gridOpts.gridContainer.arrayUnique(b))}}).then(function(c){(new n({libraryId:a.libraryId,title:e.selectedItemsWithBuildUpRates,data:c,selectedItems:b,printURL:"scheduleOfRateReporting/printingPreviewSelectedItemsWithBuildUpRates",exportURL:"scheduleOfRateExportExcelReporting/exportExcelSelectedItemsWithBuildUpRates"})).show();
d.hide()},function(a){console.log(a);d.hide()})},destroy:function(){this.inherited(arguments);dojo.forEach(this._connects,d.disconnect);delete this._connects}})});
