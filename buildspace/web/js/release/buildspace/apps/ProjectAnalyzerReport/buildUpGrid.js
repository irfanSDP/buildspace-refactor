define("buildspace/apps/ProjectAnalyzerReport/buildUpGrid","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-attr dojox/grid/enhanced/plugins/Menu buildspace/widget/grid/plugins/FormulatedColumn dojo/_base/event dojo/keys dojo/currency dijit/focus dojo/_base/html dojo/request/xhr buildspace/widget/grid/cells/Textarea buildspace/widget/grid/cells/FormulaTextBox dojo/i18n!buildspace/nls/BuildUpGrid".split(" "),function(k,m,r,t,u,n,v,w,p,x,y,z,A,B,q){return k("buildspace.apps.ProjectAnalyzerReport.BuildUpGrid",
dojox.grid.EnhancedGrid,{resource:null,billItem:null,style:"border-top:none;",selectedItem:null,keepSelection:!0,rowSelector:"0px",updateUrl:null,pasteUrl:null,buildUpSummaryWidget:null,constructor:function(a){this.formulatedColumn=n(this,{});this.currencySetting=buildspace.billCurrencyAbbreviation?buildspace.billCurrencyAbbreviation:buildspace.currencyAbbreviation},canSort:function(a){return!1},canEdit:function(a,c){var d=this,b=this.getItem(c);if(void 0!=a&&b.hasOwnProperty("id")&&0>b.id[0])window.setTimeout(function(){d.edit.cancel();
d.focus.setFocusIndex(c,a.index)},10);else return this._canEdit},postCreate:function(){this.inherited(arguments)},doApplyCellEdit:function(a,c,d){var b=this,e=b.getItem(c),g=b.store;if(a!==e[d][0]){var h=d.replace("-value","");-1!==d.indexOf("-value")&&(a=this.formulatedColumn.convertRowIndexToItemId(a,c));var h={id:e.id,attr_name:h,val:a,_csrf_token:e._csrf_token?e._csrf_token:null},f=this.updateUrl;e.id==buildspace.constants.GRID_LAST_ROW&&(f=0<c?b.getItem(c-1):!1,m.mixin(h,{prev_item_id:f?f.id:
0,relation_id:e.relation_id,resource_id:b.resource.id}),f=this.addUrl);var k=function(a,b){for(var c in a)e.hasOwnProperty(c)&&c!=b._getIdentifierAttribute()&&b.setValue(e,c,a[c]),dojo.forEach(a.affected_nodes,function(a){b.fetchItemByIdentity({identity:a.id,onItem:function(c){for(var d in a)e.hasOwnProperty(d)&&d!=b._getIdentifierAttribute()&&b.setValue(c,d,a[d])}})});b.save()},l=buildspace.dialog.indeterminateProgressBar({title:q.pleaseWait+"..."});l.show();dojo.xhrPost({url:f,content:h,handleAs:"json",
load:function(a){if(a.success){0<e.id?k(a.data,g):(g.deleteItem(e),g.save(),dojo.forEach(a.items,function(a){g.newItem(a)}),g.save());b.updateTotalBuildUp(a.total_build_up);var f=b.getCellByField(d);window.setTimeout(function(){b.focus.setFocusIndex(c,f.index)},10)}l.hide()},error:function(a){l.hide()}})}b.inherited(arguments)},updateTotalBuildUp:function(a){dijit.byId("accPane-"+this.resource.id+"-"+this.billItem.id).set("title",this.resource.name+'<span style="color:blue;float:right;">'+this.currencySetting+
"&nbsp;"+p.format(a)+"</span>");this.buildUpSummaryWidget.refreshTotalCost()}})});
