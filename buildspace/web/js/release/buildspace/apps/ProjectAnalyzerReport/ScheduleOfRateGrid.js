define("buildspace/apps/ProjectAnalyzerReport/ScheduleOfRateGrid","dojo/_base/declare dojo/_base/connect dojo/_base/lang dojo/request dijit/form/Button dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem dojo/store/Memory dojo/aspect dojo/json buildspace/widget/grid/plugins/FormulatedColumn dojox/grid/enhanced/plugins/IndirectSelection ./ScheduleOfRatePrintPreviewDialog/PrintSelectedScheduleOfRateItemGridDialog ./ScheduleOfRatePrintPreviewDialog/PrintSelectedTradeItemBillItemGridDialog ./ScheduleOfRatePrintPreviewDialog/PrintPreviewFormDialog dojo/i18n!buildspace/nls/ProjectAnalyzer".split(" "),
function(n,p,q,h,y,k,l,e,m,v,g,w,z,r,t,u,d){var x=n("buildspace.apps.ProjectAnalyzerReport.ScheduleOfRateEnhancedGrid",dojox.grid.EnhancedGrid,{type:null,style:"border-top:none;",rowSelector:"0px",region:"center",tradeId:-1,updateUrl:null,project:null,unsorted:!1,gridContainer:null,constructor:function(a){if("trade"===a.type||"tradeItem"===a.type||"billItem"===a.type)this.plugins={indirectSelection:{headerSelector:!0,width:"40px",styles:"text-align: center;"}};this.inherited(arguments)},canSort:function(a){return!1},
postCreate:function(){this.formulatedColumn=w(this,{});var a=this,b;a.inherited(arguments);"tradeItem"===a.type?b=a.gridContainer.tradeItemSelectBoxStore:"billItem"===a.type&&(b=a.gridContainer.tradeBillItemSelectBoxStore[a.trade.id[0]]);b&&v.after(a,"_onFetchComplete",function(){a.gridContainer.markedCheckBoxObject(a,b)})},startup:function(){this.inherited(arguments);var a=this;if("trade"===a.type||"tradeItem"===a.type||"billItem"===a.type)this._connects.push(p.connect(this,"onCellClick",function(b){""===
b.cell.name&&a.singleCheckBoxSelection(b)})),this._connects.push(p.connect(this.rowSelectCell,"toggleAllSelection",function(b){a.toggleAllSelection(b)}))},onStyleRow:function(a){this.inherited(arguments);2<=a.node.children[0].children[0].rows.length&&dojo.style(a.node.children[0].children[0].rows[1],"display","none")}});return n("buildspace.apps.ProjectAnalyzerReport.ScheduleOfRateGrid",dijit.layout.BorderContainer,{stackContainerTitle:"",style:"padding:0px;width:100%;height:100%;",gutters:!1,project:null,
gridOpts:{},pageId:0,type:null,scheduleOfRate:null,contractorList:[],postCreate:function(){var a=this;this.inherited(arguments);q.mixin(a.gridOpts,{project:a.project,type:this.type});var b=new dijit.Toolbar({region:"top",style:"outline:none!important; border-bottom:none; padding:2px; width:100%;"}),f=this.grid=new x(a.gridOpts);if("trade"===this.type){var c=new l({style:"display: none;"});c.addChild(new e({label:d.sorItems,iconClass:"icon-16-container icon-16-print",onClick:function(){a.openSelectedSoRItemPrintPreviewDialog()}}));
c.addChild(new e({label:d.sorItemsWithSelectedTendererRates,iconClass:"icon-16-container icon-16-print",disabled:a.contractorList&&0<a.contractorList.items.length&&a.contractorList.items[0].awarded?!1:!0,onClick:function(){a.openSelectedSoRItemBySelectedTendererPrintPreviewDialog()}}));c.addChild(new e({label:d.scheduleOfRateItemsCostAnalysis,iconClass:"icon-16-container icon-16-print",onClick:function(){a.printSelectedSoRItemCostAnalysis()}}));b.addChild(new k({label:d.print,iconClass:"icon-16-container icon-16-print",
dropDown:c}));this.addChild(b)}else"tradeItem"===this.type?(c=new l({style:"display: none;"}),c.addChild(new e({label:d.sorItems,onClick:function(){a.openSelectedSoRItemPrintPreviewDialog()}})),c.addChild(new e({label:d.sorWithBillItems,onClick:function(){a.openSelectedBillItemPrintPreviewDialog()}})),c.addChild(new e({label:d.sorWithBillItemsWithSelectedTendererRates,disabled:a.contractorList&&0<a.contractorList.items.length&&a.contractorList.items[0].awarded?!1:!0,onClick:function(){a.openSelectedBillItemWithTendererRatesPrintPreviewDialog()}})),
c.addChild(new e({label:d.billItemsCostAnalysis,onClick:function(){a.printBillItemCostAnalysis()}})),b.addChild(new k({label:d.print,iconClass:"icon-16-container icon-16-print",dropDown:c})),this.addChild(b)):"billItem"===this.type&&(c=new l({style:"display: none;"}),c.addChild(new e({label:d.sorWithBillItems,onClick:function(){a.openSelectedBillItemPrintPreviewDialog()}})),c.addChild(new e({label:d.sorWithBillItemsWithSelectedTendererRates,disabled:a.contractorList&&0<a.contractorList.items.length&&
a.contractorList.items[0].awarded?!1:!0,onClick:function(){a.openSelectedBillItemWithTendererRatesPrintPreviewDialog()}})),c.addChild(new e({label:d.billItemsCostAnalysis,onClick:function(){a.printBillItemCostAnalysis()}})),b.addChild(new k({label:d.print,iconClass:"icon-16-container icon-16-print",dropDown:c})),this.addChild(b));this.addChild(new dijit.layout.ContentPane({style:"width:100%",content:f,region:"center"}));if(c=dijit.byId("projectAnalyzer-sor_project_"+a.project.id+"-stackContainer"))b=
document.createElement("div"),b=new dojox.layout.ContentPane({title:buildspace.truncateString(a.stackContainerTitle,60),id:a.pageId,executeScripts:!0},b),c.addChild(b),b.set("content",a),q.mixin(b,{grid:f}),c.selectChild(a.pageId)},openSelectedSoRItemPrintPreviewDialog:function(){var a=this,b=[];b=a.getTradeItemIds();var f=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});f.show().then(function(){h.post("scheduleOfRateProjectAnalyzerReport/getPrintingSelectedTradeItems",{handleAs:"json",
data:{pid:a.project.id,trade_item_ids:g.stringify(a.arrayUnique(b)),scheduleOfRateId:a.scheduleOfRate.id}}).then(function(c){(new r({project:a.project,title:d.sorItems,data:c,selectedItems:b,projectId:a.project.id,scheduleOfRateId:a.scheduleOfRate.id,printURL:"printReport/printSelectedScheduleOfRateTradeItems",exportURL:"exportExcelReport/exportSelectedScheduleOfRateTradeItems"})).show();f.hide()},function(a){console.log(a);f.hide()})})},openSelectedSoRItemBySelectedTendererPrintPreviewDialog:function(){var a=
this,b=[];a.gridOpts.gridContainer.tradeItemSelectBoxStore.query().forEach(function(a){b.push(a.id)});var f=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});f.show().then(function(){h.post("scheduleOfRateProjectAnalyzerReport/getPrintingSelectedTradeItemsWithSelectedTenderer",{handleAs:"json",data:{pid:a.project.id,trade_item_ids:g.stringify(a.arrayUnique(b)),scheduleOfRateId:a.scheduleOfRate.id}}).then(function(c){(new r({project:a.project,title:d.sorItemsWithSelectedTendererRates,
data:c,selectedItems:b,projectId:a.project.id,scheduleOfRateId:a.scheduleOfRate.id,printURL:"printReport/printSelectedScheduleOfRateTradeItemsWithSelectedTendererRates",exportURL:"exportExcelReport/exportSelectedScheduleOfRateTradeItemsWithSelectedTendererRates"})).show();f.hide()},function(a){console.log(a);f.hide()})})},printSelectedSoRItemCostAnalysis:function(){(new u({title:d.scheduleOfRateItemsCostAnalysis,selectedRows:this.gridOpts.gridContainer.getTradeIds(),printURL:null,exportURL:"exportExcelReport/exportSelectedScheduleOfRateTradeItemsCostAnalysis",
projectId:this.project.id[0],scheduleOfRateId:this.scheduleOfRate.id[0],_csrf_token:this.gridOpts._csrf_token})).show()},openSelectedBillItemPrintPreviewDialog:function(){this.gridOpts.gridContainer.tradeBillItemSelectBoxStore[this.gridOpts.trade.id[0]]||(this.gridOpts.gridContainer.tradeBillItemSelectBoxStore[this.gridOpts.trade.id[0]]=new m({idProperty:"id"}));var a=this,b=a.gridOpts.gridContainer.tradeBillItemSelectBoxStore[a.gridOpts.trade.id[0]],f=[],c=[];a.gridOpts.gridContainer.tradeItemSelectBoxStore.query().forEach(function(a){f.push(a.id)});
b.query().forEach(function(a){c.push(a.id)});var e=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});e.show().then(function(){h.post("scheduleOfRateProjectAnalyzerReport/getPrintingSelectedBillItems",{handleAs:"json",data:{pid:a.project.id,scheduleOfRateId:a.scheduleOfRate.id,scheduleOfRateTradeId:a.gridOpts.trade.id,tradeItemIds:g.stringify(a.arrayUnique(f)),bill_item_ids:g.stringify(a.arrayUnique(c))}}).then(function(b){(new t({project:a.project,title:d.sorItems+" ("+a.gridOpts.trade.description+
")",data:b,tradeItemIds:f,selectedItems:c,projectId:a.project.id,scheduleOfRateId:a.scheduleOfRate.id,tradeId:a.gridOpts.trade.id,contractorList:a.contractorList,printURL:"printReport/printSelectedScheduleOfRateTradeBillItem",exportURL:"exportExcelReport/exportSelectedScheduleOfRateTradeBillItem"})).show();e.hide()},function(a){console.log(a);e.hide()})})},openSelectedBillItemWithTendererRatesPrintPreviewDialog:function(){this.gridOpts.gridContainer.tradeBillItemSelectBoxStore[this.gridOpts.trade.id[0]]||
(this.gridOpts.gridContainer.tradeBillItemSelectBoxStore[this.gridOpts.trade.id[0]]=new m({idProperty:"id"}));var a=this,b=a.gridOpts.gridContainer.tradeBillItemSelectBoxStore[a.gridOpts.trade.id[0]],f=[],c=[];a.gridOpts.gridContainer.tradeItemSelectBoxStore.query().forEach(function(a){f.push(a.id)});b.query().forEach(function(a){c.push(a.id)});var e=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});e.show().then(function(){h.post("scheduleOfRateProjectAnalyzerReport/getPrintingSelectedBillItemsWithSelectedTendererRates",
{handleAs:"json",data:{pid:a.project.id,scheduleOfRateId:a.scheduleOfRate.id,scheduleOfRateTradeId:a.gridOpts.trade.id,tradeItemIds:g.stringify(a.arrayUnique(f)),bill_item_ids:g.stringify(a.arrayUnique(c))}}).then(function(b){(new t({project:a.project,title:d.sorWithBillItemsWithSelectedTendererRates+" ("+a.gridOpts.trade.description+")",data:b,tradeItemIds:f,selectedItems:c,projectId:a.project.id,scheduleOfRateId:a.scheduleOfRate.id,tradeId:a.gridOpts.trade.id,printURL:"printReport/printSelectedScheduleOfRateTradeBillItemWithSelectedTendererRates",
exportURL:"exportExcelReport/exportSelectedScheduleOfRateTradeBillItemWithSelectedTendererRates"})).show();e.hide()},function(a){console.log(a);e.hide()})})},arrayUnique:function(a){return a.reverse().filter(function(a,d,c){return-1===c.indexOf(a,d+1)}).reverse()},getTradeItemIds:function(){var a=[];this.gridOpts.gridContainer.tradeItemSelectBoxStore.query().forEach(function(b){a.push(b.id)});return a},getBillItemIds:function(){this.gridOpts.gridContainer.tradeBillItemSelectBoxStore[this.gridOpts.trade.id[0]]||
(this.gridOpts.gridContainer.tradeBillItemSelectBoxStore[this.gridOpts.trade.id[0]]=new m({idProperty:"id"}));var a=[];this.gridOpts.gridContainer.tradeBillItemSelectBoxStore[this.gridOpts.trade.id[0]].query().forEach(function(b){a.push(b.id)});return a},printBillItemCostAnalysis:function(){(new u({title:d.billItemsCostAnalysis,selectedRows:this.getBillItemIds(),tradeItemIds:this.getTradeItemIds(),printURL:null,exportURL:"exportExcelReport/exportSelectedScheduleOfRateTradeBillItemCostAnalysis",projectId:this.project.id[0],
scheduleOfRateId:this.scheduleOfRate.id[0],tradeId:this.gridOpts.trade.id[0],_csrf_token:this.gridOpts.trade._csrf_token[0]})).show()}})});
