define("buildspace/apps/ProjectBuilder/ScheduleOfRateBillForm","dojo/_base/declare dojo/html dojo/dom dojo/keys dojo/dom-style dijit/form/Form dijit/form/ValidationTextBox dijit/form/Textarea dijit/form/Select dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/scheduleOfRateBillForm.html dojo/i18n!buildspace/nls/ProjectBuilder dojo/on".split(" "),function(f,g,h,k,d,u,v,w,l,m,n,p,q,r,e,x){var t=f("buildspace.apps.ProjectBuilder.ScheduleOfRateBillFormWidget",
[m,n,p,q],{templateString:r,baseClass:"buildspace-form",region:"center",dialogObj:null,billId:-1,parentId:null,projectBreakdownGrid:null,nls:e,style:"padding:5px;overflow:auto;",postCreate:function(){this.inherited(arguments);var a=new dojo.data.ItemFileReadStore({url:"projectBuilder/getUnitTypes"});this.unitTypeSelect=(new l({name:"schedule_of_rate_bill[unit_type]",style:"width:80px;padding:2px!important;",store:a,searchAttr:"name"})).placeAt(this.unitTypeInputDivNode)},startup:function(){this.inherited(arguments);
var a=this;0<this.billId?this.toggleEditableInputElements(!1):this.toggleEditableInputElements(!0);var c=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});c.show();dojo.xhrGet({url:"scheduleOfRateBill/billForm",handleAs:"json",content:{id:this.billId,parent_id:this.parentId},load:function(b){a.scheduleOfRateBillForm.setFormValues(b);g.set(a.unitTypeViewDivNode,b.unitTypeText?b.unitTypeText:"");c.hide()},error:function(a){c.hide()}})},toggleEditableInputElements:function(a){a?
(d.set(this.unitTypeViewDivNode,"display","none"),d.set(this.unitTypeInputDivNode,"display","")):(d.set(this.unitTypeViewDivNode,"display",""),d.set(this.unitTypeInputDivNode,"display","none"))},save:function(){var a=buildspace.dialog.indeterminateProgressBar({title:e.savingData+"..."}),c=this,b=dojo.formToObject(c.scheduleOfRateBillForm.id);this.scheduleOfRateBillForm.validate()&&(a.show(),dojo.xhrPost({url:"scheduleOfRateBill/billUpdate",content:b,handleAs:"json",load:function(b){dojo.query('[id^="error-schedule_of_rate_bill_"]').forEach(function(a){a.innerHTML=
""});if(b.success)b=dijit.byId("bill_element_container_"+c.projectBreakdownGrid.rootProject.id+"-bill-"+b.item.id),c.projectBreakdownGrid.reload(),b&&b.reconstructBillContainer(),c.dialogObj&&c.dialogObj.hide();else for(var d in b.errors)g.set(h.byId("error-schedule_of_rate_bill_"+d),b.errors[d]);a.hide()},error:function(b){a.hide()}}))},close:function(){},onCancel:function(){}});return f("buildspace.apps.ProjectBuilder.ScheduleOfRateBillFormDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",billId:-1,
parentId:null,projectBreakdownGrid:null,title:null,buildRendering:function(){var a=this.createForm();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){d.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(a){a.keyCode==k.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},createForm:function(){var a=new dijit.layout.BorderContainer({style:"padding:0px;width:500px;height:240px;",
gutters:!1}),c=new t({dialogObj:this,billId:this.billId,parentId:this.parentId,projectBreakdownGrid:this.projectBreakdownGrid}),b=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});b.addChild(new dijit.form.Button({label:e.save,iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(c,"save")}));b.addChild(new dijit.ToolbarSeparator);b.addChild(new dijit.form.Button({label:e.close,iconClass:"icon-16-container icon-16-close",
style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));a.addChild(b);a.addChild(c);return a}})});
