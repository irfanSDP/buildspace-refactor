define("buildspace/apps/ProjectBuilder/LevelForm","dojo/_base/declare dojo/html dojo/dom dojo/keys dojo/dom-style dijit/form/Form dijit/form/ValidationTextBox dijit/form/Textarea dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/levelForm.html dojo/i18n!buildspace/nls/ProjectBuilder".split(" "),function(e,f,g,h,k,t,u,v,l,m,n,p,q,d){var r=e("buildspace.apps.ProjectBuilder.LevelFormWidget",[l,m,n,p],{templateString:q,baseClass:"buildspace-form",
region:"center",dialogObj:null,levelId:-1,parentId:null,projectBreakdownGrid:null,nls:d,style:"padding:5px;overflow:auto;",postCreate:function(){this.inherited(arguments)},startup:function(){this.inherited(arguments);var a=this,c=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});c.show().then(function(){dojo.xhrGet({url:"projectBuilder/levelForm",handleAs:"json",content:{id:a.levelId,parent_id:a.parentId},load:function(b){a.levelForm.setFormValues(b);c.hide()},error:function(a){c.hide()}})})},
save:function(){var a=buildspace.dialog.indeterminateProgressBar({title:d.savingData+"..."}),c=this,b=dojo.formToObject(this.levelForm.id);this.levelForm.validate()&&a.show().then(function(){dojo.xhrPost({url:"projectBuilder/levelUpdate",content:b,handleAs:"json",load:function(b){dojo.query('[id^="error-project_level_"]').forEach(function(a){a.innerHTML=""});if(b.success)c.projectBreakdownGrid.reload(),c.dialogObj&&c.dialogObj.hide();else for(var d in b.errors)f.set(g.byId("error-project_level_"+
d),b.errors[d]);a.hide()},error:function(b){a.hide()}})})},close:function(){},onCancel:function(){}});return e("buildspace.apps.ProjectBuilder.LevelFormDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",levelId:-1,parentId:null,projectBreakdownGrid:null,title:d.addLevel,buildRendering:function(){var a=this.createForm();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){k.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},
_onKey:function(a){a.keyCode==h.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},createForm:function(){var a=new dijit.layout.BorderContainer({style:"padding:0px;width:400px;height:150px;",gutters:!1}),c=new r({dialogObj:this,levelId:this.levelId,parentId:this.parentId,projectBreakdownGrid:this.projectBreakdownGrid}),b=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});b.addChild(new dijit.form.Button({label:d.save,iconClass:"icon-16-container icon-16-save",
style:"outline:none!important;",onClick:dojo.hitch(c,"save")}));b.addChild(new dijit.ToolbarSeparator);b.addChild(new dijit.form.Button({label:d.close,iconClass:"icon-16-container icon-16-close",style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));a.addChild(b);a.addChild(c);return a}})});
