define("buildspace/apps/PostContract/ClaimCertificatePaymentDialog","dojo/_base/declare dojo/aspect dijit/focus dojo/_base/lang dojo/_base/connect dojo/dom dojo/keys dojo/_base/array dojo/dom-style dojo/currency dojo/number dojox/grid/EnhancedGrid buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/PostContract".split(" "),function(f,r,t,u,v,w,l,x,m,y,z,n,p,b){var q=f("buildspace.apps.PostContract.ClaimCertificatePaymentGrid",n,{claimCertificate:null,claimCertificatesGrid:null,style:"border:none;",
region:"center",keepSelection:!0,rowSelector:"0px",escapeHTMLInData:!1,canSort:function(a){return!1},postCreate:function(){this.inherited(arguments)},dodblclick:function(a){this.onRowDblClick(a)},doApplyCellEdit:function(a,c,h){var g=this,d=this.getItem(c),e=this.store;if(String(a)!==String(d[h])){var k=buildspace.dialog.indeterminateProgressBar({title:b.savingData+". "+b.pleaseWait+"..."}),f={id:d.id,attr_name:h,val:a,cid:this.claimCertificate.id,_csrf_token:d._csrf_token?d._csrf_token:null};k.show().then(function(){dojo.xhrPost({url:"postContract/claimCertificatePaymentUpdate",
content:f,handleAs:"json",load:function(a){if(a.success){isNaN(parseInt(d.id[0]))?(e.deleteItem(d),e.save(),dojo.forEach(a.items,function(a){e.newItem(a)}),e.save()):dojo.forEach(a.items,function(a){var c=e,b;for(b in a)d.hasOwnProperty(b)&&b!=c._getIdentifierAttribute()&&c.setValue(d,b,a[b]);c.save()});g.claimCertificatesGrid.reload();var b=g.getCellByField(h);window.setTimeout(function(){g.selection.select(c);g.focus.setFocusIndex(c,b.index)},10);k.hide()}},error:function(a){k.hide()}})})}this.inherited(arguments)},
doCancelEdit:function(a){this.inherited(arguments);this.views.renormalizeRow(a);this.scroller.rowHeightChanged(a,!0)},onStyleRow:function(a){this.inherited(arguments);if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length){var c=a.node.children[0].children[0].rows[1],b=a.node.children[0].children[0].rows[0].children;c.parentNode.removeChild(c);dojo.forEach(b,function(a,c){var b=dojo.attr(a,"rowSpan");(!b||2>b)&&dojo.attr(a,"rowSpan",2)})}},reload:function(){this.store.close();this._refresh()}});
return f("buildspace.apps.PostContract.ClaimCertificatePaymentDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",title:b.claimCertificatePayments,claimCertificate:null,claimCertificatesGrid:null,refocus:!1,autofocus:!1,buildRendering:function(){var a=this.createContent();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){m.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(a){a.keyCode==
l.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},createContent:function(){var a=new dijit.layout.BorderContainer({style:"padding:0;margin:0;width:980px;height:450px;",gutters:!1}),c=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;border:none;"});c.addChild(new dijit.form.Button({label:b.close,iconClass:"icon-16-container icon-16-close",style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));a.addChild(c);c=new p;c=new q({claimCertificate:this.claimCertificate,
claimCertificatesGrid:this.claimCertificatesGrid,store:dojo.data.ItemFileWriteStore({url:"postContract/getClaimCertificatePayments/cid/"+this.claimCertificate.id,clearOnClose:!0}),structure:[{name:"No.",field:"id",width:"40px",styles:"text-align:center;",formatter:c.rowCountCellFormatter},{name:b.paidAmount,field:"amount",width:"150px",styles:"text-align:right;",formatter:c.currencyCellFormatter,editable:!0,cellType:"buildspace.widget.grid.cells.TextBox"},{name:b.remarks,field:"remarks",width:"auto",
styles:"text-align:left;",cellType:"buildspace.widget.grid.cells.TextBox",editable:!0},{name:b.created_at,field:"created_at",width:"120px",styles:"text-align:center;"}]});a.addChild(c);return a}})});
