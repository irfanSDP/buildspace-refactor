define("buildspace/apps/PostContract/PostContractClaim/ClaimImportDialog","dojo/_base/declare dojo/keys dojo/dom-style dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!../templates/claimsImportForm.html dojo/i18n!buildspace/nls/PostContract".split(" "),function(h,k,l,m,n,p,q,r,d){var u=h("buildspace.apps.Claims.ClaimFileImportForm",[m,n,p,q],{templateString:r,baseClass:"buildspace-form",region:"center",dialogObj:null,rootProject:null,nls:d,style:"padding:5px;overflow:auto;",
postCreate:function(){this.inherited(arguments);var a=this.fileUploaderNode;a.on("Complete",dojo.hitch(this,"uploadComplete"));a.on("Begin",dojo.hitch(this,"uploadBegin"))},startup:function(){this.inherited(arguments)},uploadBegin:function(a){(this.pb=buildspace.dialog.indeterminateProgressBar({title:d.importingData+". "+d.pleaseWait+"..."})).show()},uploadComplete:function(a){if(a.running){a=new dijit.ProgressBar({value:0,title:"Importing Claims",layoutAlign:"center"});var c=new dijit.Dialog({content:a,
style:"background:#fff;padding:5px;height:78px;width:280px;",splitter:!1});c.closeButtonNode.style.display="none";c._onKey=function(b){b.keyCode==k.ESCAPE&&dojo.stopEvent(b)};c.onHide=function(){c.destroyRecursive()};this.getImportLogStatus(c,a)}else this.dialogObj.hide(),this.pb&&this.pb.hide()},getImportLogStatus:function(a,c){var b=this;dojo.xhrGet({url:"claimTransfer/getImportClaimProgress",content:{id:parseInt(String(this.rootProject.id))},handleAs:"json",sync:!1,load:function(e){var g=parseInt(e.total_imported_files),
f=parseInt(e.total_files),t=parseInt(e.version);e.exists?(!a.open&&0<f&&g!=f&&(b.dialogObj.open&&b.dialogObj.hide(),b.pb&&b.pb.hide(),a.show()),a.set({title:"Importing "+g+"/"+f+" Files for Claim Revision "+t}),c.set({value:g/f*100}),setTimeout(function(){b.getImportLogStatus(a,c)},2E3)):(dijit.byId("claimCertificatePage-"+b.rootProject.id+"-importClaimsButton").setDisabled(!0),a.open&&a.hide(),b.dialogObj.open&&b.dialogObj.hide(),b.pb&&b.pb.hide())},error:function(e){b.dialogObj.open&&b.dialogObj.hide();
b.pb&&b.pb.hide()}})}});return h("buildspace.apps.Claims.ClaimImportDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",title:d.importClaims,rootProject:null,importUrl:null,buildRendering:function(){var a=this.createForm();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){l.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(a){a.keyCode==k.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},
createForm:function(){var a=new dijit.layout.BorderContainer({style:"padding:0px;width:400px;height:120px;",gutters:!1}),c=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});c.addChild(new dijit.form.Button({label:d.close,iconClass:"icon-16-container icon-16-close",style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));a.addChild(c);a.addChild(new u({dialogObj:this,title:this.title,rootProject:this.rootProject,importUrl:this.importUrl}));return a}})});
