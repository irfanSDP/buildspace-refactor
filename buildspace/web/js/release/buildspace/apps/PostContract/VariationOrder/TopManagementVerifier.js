var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.owns=function(b,c){return Object.prototype.hasOwnProperty.call(b,c)};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){if(b==Array.prototype||b==Object.prototype)return b;b[c]=a.value;return b};$jscomp.getGlobal=function(b){b=["object"==typeof globalThis&&globalThis,b,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<b.length;++c){var a=b[c];if(a&&a.Math==Math)return a}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(b,c){var a=$jscomp.propertyToPolyfillSymbol[c];if(null==a)return b[c];a=b[a];return void 0!==a?a:b[c]};
$jscomp.polyfill=function(b,c,a,e){c&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(b,c,a,e):$jscomp.polyfillUnisolated(b,c,a,e))};$jscomp.polyfillUnisolated=function(b,c,a,e){a=$jscomp.global;b=b.split(".");for(e=0;e<b.length-1;e++){var f=b[e];if(!(f in a))return;a=a[f]}b=b[b.length-1];e=a[b];c=c(e);c!=e&&null!=c&&$jscomp.defineProperty(a,b,{configurable:!0,writable:!0,value:c})};
$jscomp.polyfillIsolated=function(b,c,a,e){var f=b.split(".");b=1===f.length;e=f[0];e=!b&&e in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var l=0;l<f.length-1;l++){var m=f[l];if(!(m in e))return;e=e[m]}f=f[f.length-1];a=$jscomp.IS_SYMBOL_NATIVE&&"es6"===a?e[f]:null;c=c(a);null!=c&&(b?$jscomp.defineProperty($jscomp.polyfills,f,{configurable:!0,writable:!0,value:c}):c!==a&&(void 0===$jscomp.propertyToPolyfillSymbol[f]&&($jscomp.propertyToPolyfillSymbol[f]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(f):
$jscomp.POLYFILL_PREFIX+f),$jscomp.defineProperty(e,$jscomp.propertyToPolyfillSymbol[f],{configurable:!0,writable:!0,value:c})))};$jscomp.polyfill("Object.values",function(b){return b?b:function(c){var a=[],e;for(e in c)$jscomp.owns(c,e)&&a.push(c[e]);return a}},"es8","es3");
define("buildspace/apps/PostContract/VariationOrder/TopManagementVerifier","dojo/_base/declare dojo/html dojo/dom-style dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/FilteringSelect dojo/text!./templates/topManagementVerifier.html dojo/text!../templates/topManagementVerifierSelectionRow.html dojo/i18n!buildspace/nls/PostContract".split(" "),function(b,c,a,e,f,l,m,r,t,k){var u=b("buildspace.apps.PostContract.VariationOrder.TopManagementVerifier.Form",[e,f,l],{region:"center",
templateString:r,baseClass:"buildspace-form",nls:k,title:null,project:null,variationOrder:null,constructor:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.populatePostContractClaimTopManagementVerifierRecords();this.variationOrder.can_be_edited[0]?this.btnAddVerifier.set("onClick",dojo.hitch(this,"addVerifierRow")):(a.set(this.btnAddVerifier.domNode,"display","none"),a.set(this.actionHeaderNode,"display","none"),a.set(this.deleteHeaderNode,"display","none"))},
populatePostContractClaimTopManagementVerifierRecords:function(){var d=this,g=buildspace.dialog.indeterminateProgressBar({title:k.pleaseWait+"..."});dojo.empty(d.topManagementVerifierRowContainer);g.show().then(function(){dojo.xhrGet({url:"variationOrder/getSavedTopManagementVerifiers",content:{variationOrderId:d.variationOrder.id},handleAs:"json",load:function(h){0<h.records.length&&dojo.forEach(h.records,function(n){(new q({editMode:!1,locked:!d.variationOrder.can_be_edited[0],addVerifierButton:d.btnAddVerifier,
project:d.project,variationOrder:d.variationOrder,recordInfo:n,topManagementVerifierForm:d,_csrf_token:d.variationOrder._csrf_token})).placeAt(d.topManagementVerifierRowContainer)});g.hide()},error:function(h){g.hide()}})})},addVerifierRow:function(){(new q({editMode:!0,locked:!1,addVerifierButton:this.btnAddVerifier,project:this.project,variationOrder:this.variationOrder,topManagementVerifierForm:this,_csrf_token:this.variationOrder._csrf_token})).placeAt(this.topManagementVerifierRowContainer);
this.btnAddVerifier.set("disabled",!0)}}),q=b("buildspace.apps.PostContract.VariationOrder.TopManagementVerifier.SelectionRow",[e,f,l],{templateString:t,baseClass:"buildspace-form",nls:k,name:null,value:null,textAlign:null,editMode:null,locked:null,addVerifierButton:null,verifierSelect:null,variationOrder:null,topManagementVerifierForm:null,recordInfo:null,_csrf_token:null,project:null,constructor:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.toggleEditableInputElements();
this.locked?(a.set(this.actionColumnNode,"display","none"),a.set(this.deleteColumnNode,"display","none")):this.editMode?(a.set(this.editButton.domNode,"display","none"),a.set(this.saveButton.domNode,"display","")):(a.set(this.saveButton.domNode,"display","none"),a.set(this.editButton.domNode,"display",""))},toggleEditableInputElements:function(){if(this.editMode){var d=new dojo.data.ItemFileReadStore({url:"variationOrder/getTopManagementVerifiers/pid/"+this.project.id});d=new m({name:"variationOrder[top_management_verifiers][]",
store:d,style:"width:100%;padding-top:2px;padding-bottom:2px;",searchAttr:"name",readOnly:!1,required:!0});d.placeAt(this.verifierSelectNode);this.verifierSelect=d;a.set(this.verifierSelectDivNode,"display","");a.set(this.verifierViewNode,"display","none")}else null!=this.recordInfo&&(c.set(this.verifierViewNode,this.recordInfo.name),c.set(this.verifierEmailNode,this.recordInfo.email)),a.set(this.verifierSelectDivNode,"display","none"),a.set(this.verifierViewNode,"display","")},edit:function(){this.addVerifierButton.set("disabled",
!0);a.set(this.editButton.domNode,"display","none");a.set(this.saveButton.domNode,"display","");this.editMode=!0;var d=new dojo.data.ItemFileReadStore({url:"variationOrder/getTopManagementVerifiers/pid/"+this.project.id}),g=new m({name:"claim_certificate[top_management_verifiers][]",store:d,style:"width:100%;padding-top:2px;padding-bottom:2px;",searchAttr:"name",readOnly:!1,required:!0});d.fetchItemByIdentity({identity:this.recordInfo.user_id,onItem:function(h){g.set("item",h)}});g.placeAt(this.verifierSelectNode);
this.verifierSelect=g;a.set(this.verifierSelectDivNode,"display","");a.set(this.verifierViewNode,"display","none")},save:function(){var d=this,g=buildspace.dialog.indeterminateProgressBar({title:k.savingData+"..."}),h=d.verifierSelect.get("value"),n=d.recordInfo?d.recordInfo.id:-1,v=d.recordInfo?"variationOrder/updateTopManagementVerifier":"variationOrder/saveTopManagementVerifier";g.show().then(function(){dojo.xhrPost({url:v,content:{"post_contract_claim_top_management_verifier[id]":n,"post_contract_claim_top_management_verifier[user_id]":h,
"post_contract_claim_top_management_verifier[objectId]":d.variationOrder.id,"post_contract_claim_top_management_verifier[_csrf_token]":d._csrf_token},handleAs:"json",load:function(p){p.success?(d.topManagementVerifierForm.populatePostContractClaimTopManagementVerifierRecords(),d.addVerifierButton.set("disabled",!1)):buildspace.dialog.alert("Warning",Object.values(p.errors)[0],100,300);g.hide()},error:function(p){g.hide()}});g.hide()})},removeColumn:function(){var d=this,g=buildspace.dialog.indeterminateProgressBar({title:k.deleting+
". "+k.pleaseWait+"..."});null!==d.recordInfo?new buildspace.dialog.confirm(k.deletePostContractTopManagementVerifierDialogBoxTitle,k.deletePostContractTopManagementVerifierDialogBoxMsg,80,320,function(){g.show().then(function(){dojo.xhrPost({url:"variationOrder/deleteTopManagementVerifier",content:{id:d.recordInfo.id},handleAs:"json",load:function(h){!0===h.success&&(d.topManagementVerifierForm.populatePostContractClaimTopManagementVerifierRecords(),d.addVerifierButton.set("disabled",!1));g.hide()},
error:function(h){g.hide()}})})}):(this.destroyRecursive(),this.addVerifierButton.set("disabled",!1))}});return b("buildspace.apps.PostContract.VariationOrder.TopManagementVerifier",dijit.layout.BorderContainer,{style:"padding:0;margin:0;border:0px;width:100%;height:100%;",gutters:!1,title:null,project:null,variationOrder:null,locked:!1,constructor:function(){this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.addChild(new u({project:this.project,variationOrder:this.variationOrder}))}})});
