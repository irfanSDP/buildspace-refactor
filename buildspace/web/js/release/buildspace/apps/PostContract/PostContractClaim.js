define("buildspace/apps/PostContract/PostContractClaim","dojo/_base/declare dojo/_base/lang dojo/aspect dojo/currency dijit/focus dojo/number dijit/layout/ContentPane dojox/grid/EnhancedGrid ./PostContractClaim/PostContractClaimGrid ./PostContractClaim/PostContractClaimItemContainer buildspace/apps/Attachment/UploadAttachmentContainer buildspace/widget/grid/cells/Select dojox/grid/enhanced/plugins/Rearrange buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/PostContract".split(" "),function(n,
v,p,w,x,y,z,A,q,r,s,B,C,t,f){return n("buildspace.apps.PostContract.PostContractClaim",dijit.layout.BorderContainer,{style:"padding:0;margin:0;border:none;width:100%;height:100%;",region:"center",title:null,gutters:!1,rootProject:null,type:null,locked:!1,withProgressClaim:null,borderContainerWidget:null,claimCertificate:null,postCreate:function(){this.inherited(arguments);var b=this,l=new t,d=[{name:f.no,field:"id",width:"30px",editable:!1,styles:"text-align: center;",formatter:l.rowCountCellFormatter},
{name:f.description,field:"description",width:"auto",styles:"text-align: left;",editable:!0,cellType:"buildspace.widget.grid.cells.Textarea"},{name:f.attachment,field:"attachment",width:"128px",styles:"text-align:center;",formatter:{blueCellFormatter:function(a,b,d){a=this.grid.getItem(b);return 0<=a.id?'<span style="color:blue;">'+a.attachment+"</span>":null}}.blueCellFormatter,noresize:!0},{name:f.claimCertificateNumber,field:"claim_cert_number",width:"120px",editable:!1,styles:"text-align: center;"},
{name:f.amount,field:"amount",width:"120px",styles:"text-align: right;",formatter:l.unEditableCurrencyCellFormatter}],a,g,e,c,h,k;switch(parseInt(b.type)){case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_ADVANCE_PAYMENT:d.splice(2,0,{name:f.priority,field:"priority",width:"100px",styles:"text-align: center;",editable:!0,type:"dojox.grid.cells.Select",options:[buildspace.apps.PostContract.ProjectStructureConstants.ADVANCE_PAYMENT_PRIORITY_NORMAL_TEXT,buildspace.apps.PostContract.ProjectStructureConstants.ADVANCE_PAYMENT_PRIORITY_HIGH_TEXT],
values:[buildspace.apps.PostContract.ProjectStructureConstants.ADVANCE_PAYMENT_PRIORITY_NORMAL,buildspace.apps.PostContract.ProjectStructureConstants.ADVANCE_PAYMENT_PRIORITY_HIGH],noresize:!0});a="advancePayment/getAdvancePaymentList/pid/"+this.rootProject.id;g="advancePayment/advancePaymentAdd";e="advancePayment/advancePaymentUpdate";c="advancePayment/advancePaymentDelete";h="advancePayment/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_ADVANCE_PAYMENT_TEXT;break;
case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_POST_CONTRACT_CLAIM_MATERIAL_ON_SITE:a="postContractClaimMaterialOnSite/getMaterialOnSiteList/pid/"+this.rootProject.id;g="postContractClaimMaterialOnSite/materialOnSiteAdd";e="postContractClaimMaterialOnSite/materialOnSiteUpdate";c="postContractClaimMaterialOnSite/materialOnSiteDelete";h="postContractClaimMaterialOnSite/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_MATERIAL_ON_SITE_TEXT;break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_DEPOSIT:a=
"postContractClaimDeposit/getDepositList/pid/"+this.rootProject.id;g="postContractClaimDeposit/depositAdd";e="postContractClaimDeposit/depositUpdate";c="postContractClaimDeposit/depositDelete";h="postContractClaimDeposit/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_DEPOSIT_TEXT;break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PURCHASE_ON_BEHALF:a="postContractClaimPurchaseOnBehalf/getPurchaseOnBehalfList/pid/"+this.rootProject.id;g="postContractClaimPurchaseOnBehalf/purchaseOnBehalfAdd";
e="postContractClaimPurchaseOnBehalf/purchaseOnBehalfUpdate";c="postContractClaimPurchaseOnBehalf/purchaseOnBehalfDelete";h="postContractClaimPurchaseOnBehalf/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PURCHASE_ON_BEHALF_TEXT;break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PERMIT:a="postContractClaimPermit/getPermitList/pid/"+this.rootProject.id;g="postContractClaimPermit/permitAdd";e="postContractClaimPermit/permitUpdate";c="postContractClaimPermit/permitDelete";
h="postContractClaimPermit/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PERMIT_TEXT;break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_KONGSIKONG:a="postContractClaimKongSiKong/getKongSiKongList/pid/"+this.rootProject.id;g="postContractClaimKongSiKong/kongSiKongAdd";e="postContractClaimKongSiKong/kongSiKongUpdate";c="postContractClaimKongSiKong/kongSiKongDelete";h="postContractClaimKongSiKong/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_KONGSIKONG_TEXT;
break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WORK_ON_BEHALF:a="postContractClaimWorkOnBehalf/getWorkOnBehalfList/pid/"+this.rootProject.id;g="postContractClaimWorkOnBehalf/workOnBehalfAdd";e="postContractClaimWorkOnBehalf/workOnBehalfUpdate";c="postContractClaimWorkOnBehalf/workOnBehalfDelete";h="postContractClaimWorkOnBehalf/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WORK_ON_BEHALF_TEXT;break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WORK_ON_BEHALF_BACKCHARGE:a=
"postContractClaimWorkOnBehalfBackcharge/getWorkOnBehalfBackchargeList/pid/"+this.rootProject.id;g="postContractClaimWorkOnBehalfBackcharge/workOnBehalfBackchargeAdd";e="postContractClaimWorkOnBehalfBackcharge/workOnBehalfBackchargeUpdate";c="postContractClaimWorkOnBehalfBackcharge/workOnBehalfBackchargeDelete";h="postContractClaimWorkOnBehalfBackcharge/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WORK_ON_BEHALF_BACKCHARGE_TEXT;break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PENALTY:a=
"postContractClaimPenalty/getPenaltyList/pid/"+this.rootProject.id;g="postContractClaimPenalty/penaltyAdd";e="postContractClaimPenalty/penaltyUpdate";c="postContractClaimPenalty/penaltyDelete";h="postContractClaimPenalty/getVerifierList";k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PENALTY_TEXT;break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WATER_DEPOSIT:a="postContractClaimWaterDeposit/getWaterDepositList/pid/"+this.rootProject.id,g="postContractClaimWaterDeposit/waterDepositAdd",
e="postContractClaimWaterDeposit/waterDepositUpdate",c="postContractClaimWaterDeposit/waterDepositDelete",h="postContractClaimWaterDeposit/getVerifierList",k=buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WATER_DEPOSIT_TEXT}b.withProgressClaim&&d.push({name:f.currentPayback,field:"current_payback",width:"120px",styles:"text-align: right;",formatter:l.unEditableCurrencyCellFormatter},{name:f.upToDatePayback,field:"up_to_date_payback",width:"120px",styles:"text-align: right;",formatter:l.unEditableCurrencyCellFormatter});
b.claimObject&&(a+="/oid/"+this.claimObject.id);b.claimCertificate&&(a+="/claimRevision/"+this.claimCertificate.post_contract_claim_revision_id);d.push({name:f.status,field:"status",width:"120px",styles:"text-align: center;",editable:!0,type:"dojox.grid.cells.Select",formatter:function(a,b,d){switch(a){case buildspace.apps.PostContract.ProjectStructureConstants.STATUS_APPROVED:a=buildspace.apps.PostContract.ProjectStructureConstants.STATUS_APPROVED_TEXT;d.customClasses.push("green-cell");break;case buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PENDING:a=
buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PENDING_TEXT;d.customClasses.push("yellow-cell");break;case buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PREPARING:a=buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PREPARING_TEXT;break;default:a=""}return a.toUpperCase()},options:[buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PENDING_TEXT,buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PREPARING_TEXT],values:[buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PENDING,
buildspace.apps.PostContract.ProjectStructureConstants.STATUS_PREPARING],noresize:!0},{name:f.lastUpdated,field:"updated_at",width:"120px",styles:"text-align: center;"});var u=dojo.data.ItemFileWriteStore({url:a,clearOnClose:!0}),m=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});m.show().then(function(){dojo.xhrGet({url:"postContract/getClaimGridEditableStatus",handleAs:"json",content:{id:b.rootProject.id}}).then(function(a){b.locked||(b.locked=!a.editable);a=b.grid=new q({project:b.rootProject,
type:b.type,itemLevel:!1,locked:b.locked,postContractClaimFirstLevelContainer:b,gridOpts:{structure:d,store:u,addUrl:g,updateUrl:e,deleteUrl:c,verifierListUrl:h,withProgressClaim:b.withProgressClaim,claimCertificate:b.claimCertificate,locked:b.locked,onRowDblClick:function(a){(a=this.getItem(a.rowIndex))&&(!isNaN(parseInt(String(a.id)))&&0<String(a.description).length)&&new r({stackContainerTitle:String(a.description),project:this.project,itemType:this.type,withProgressClaim:this.withProgressClaim,
locked:this.locked,postContractClaim:a,claimCertificate:this.claimCertificate,id:"post_contract_claim_items-"+a.id+"-"+this.project.id,pageId:"post_contract_claim_items-"+a.id+"-"+this.project.id+"-page"})}}});a=b.makeGridContainer(a,k);b.borderContainerWidget=a;b.addChild(a);m.hide()})})},makeGridContainer:function(b,f){var d=this.rootProject.id,a;switch(parseInt(b.type)){case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_ADVANCE_PAYMENT:a="advancePayment-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_POST_CONTRACT_CLAIM_MATERIAL_ON_SITE:a=
"materialOnSite-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_DEPOSIT:a="deposit-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PURCHASE_ON_BEHALF:a="purchaseOnBehalf-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PERMIT:a="permit-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_KONGSIKONG:a="kongSiKong-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WORK_ON_BEHALF:a="workOnBehalf-";
break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WORK_ON_BEHALF_BACKCHARGE:a="workOnBehalfBackcharge-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_PENALTY:a="penalty-";break;case buildspace.apps.PostContract.ProjectStructureConstants.TYPE_WATER_DEPOSIT:a="waterDeposit-"}var g=dijit.byId(a+d+"-stackContainer");g&&dijit.byId(a+d+"-stackContainer").destroyRecursive();g=new dijit.layout.StackContainer({style:"width:100%;height:100%;border:none;",region:"center",
id:a+d+"-stackContainer"});g.addChild(new dijit.layout.ContentPane({title:f,content:b,grid:b.grid}));var e=new dijit.layout.StackController({region:"top",containerId:a+d+"-stackContainer"}),e=new dijit.layout.ContentPane({style:"padding:0;overflow:hidden;","class":"breadCrumbTrail",region:"top",content:e}),c=new dijit.layout.BorderContainer({style:"padding:0;margin:0;width:100%;height:100%;border:none;",gutters:!1,region:"center"});c.addChild(g);c.addChild(e);dojo.subscribe(a+d+"-stackContainer-selectChild",
"",function(b){var g=dijit.byId(a+d+"-stackContainer");if(g){var e=g.getChildren(),c=dojo.indexOf(e,b),c=c+1;if(e.length>c){for(;e.length>c;)g.removeChild(e[c]),e[c].destroyDescendants(),e[c].destroyRecursive(),c+=1;var f=b.grid.selection.selectedIndex;b.grid.store.save();b.grid.store.close();var l=p.after(b.grid,"_onFetchComplete",function(){l.remove();-1<f&&(this.scrollToRow(f,!0),this.selection.setSelected(f,!0))});b.grid.sort()}}});return c},addUploadAttachmentContainer:function(b){var f="project-"+
this.rootProject.id+"-uploadAttachment",d=dijit.byId(f);d&&(this.borderContainerWidget.removeChild(d),d.destroy());d=new s({id:f,region:"bottom",item:b,disableEditing:!b.can_be_edited[0],style:"padding:0;margin:0;border:none;width:100%;height:40%;"});this.borderContainerWidget.addChild(d);return d}})});
