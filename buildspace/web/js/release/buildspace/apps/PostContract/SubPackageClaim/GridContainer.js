define("buildspace/apps/PostContract/SubPackageClaim/GridContainer","dojo/_base/declare dojo/currency dojo/number dojox/grid/EnhancedGrid buildspace/widget/grid/cells/Formatter buildspace/widget/grid/plugins/FormulatedColumn buildspace/widget/grid/cells/FormulaTextBox dojo/i18n!buildspace/nls/PostContract".split(" "),function(g,q,r,h,l,m,t,a){var p=g("buildspace.apps.PostContract/SubPackageClaim/Grid",h,{style:"border:none;",region:"center",project:null,keepSelection:!0,escapeHTMLInData:!1,constructor:function(){this.formulatedColumn=
m(this,{})},canSort:function(){return!1},canEdit:function(b,c){var a=this;return void 0!=b&&0>=this.getItem(c).id[0]?(window.setTimeout(function(){a.edit.cancel();a.focus.setFocusIndex(c,b.index)},10),!1):this._canEdit},doApplyCellEdit:function(b,c,d){var f=this,e=this.getItem(c),n=this.store;if("profit_and_attendance_percent"===d){b=parseFloat(b);if(b!==e[d][0]){var k=buildspace.dialog.indeterminateProgressBar({title:a.savingData+". "+a.pleaseWait+"..."}),g=function(b,a){for(var c in b)e.hasOwnProperty(c)&&
c!=a._getIdentifierAttribute()&&a.setValue(e,c,b[c])},h={url:"subPackageClaim/updateProfitAndAttendancePercentage",content:{pid:this.project.id,sid:e.id,val:b,_csrf_token:e._csrf_token?e._csrf_token:null},handleAs:"json",load:function(b){if(b.success){e&&!isNaN(parseInt(e.id[0]))&&g(b.data,n);var a=f.getCellByField(d);window.setTimeout(function(){f.focus.setFocusIndex(c,a.index)},10);k.hide()}},error:function(b){k.hide()}};k.show().then(function(){dojo.xhrPost(h)})}this.inherited(arguments)}},doCancelEdit:function(b){this.inherited(arguments);
this.views.renormalizeRow(b);this.scroller.rowHeightChanged(b,!0)},onStyleRow:function(b){this.inherited(arguments);if(b.node.children[0]&&2<=b.node.children[0].children[0].rows.length){var a=b.node.children[0].children[0].rows[1],d=b.node.children[0].children[0].rows[0].children;a.parentNode.removeChild(a);dojo.forEach(d,function(b,a){a=dojo.attr(b,"rowSpan");(!a||2>a)&&dojo.attr(b,"rowSpan",2)})}},reload:function(){this.store.close();this._refresh()}});return g("buildspace.apps.PostContract.SubPackageClaim.GridContainer",
dijit.layout.BorderContainer,{region:"center",style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1,grid:null,stackContainer:null,project:null,postCreate:function(){this.inherited(arguments);this.formatter=new l;var b=this.stackContainer=this.createStackContainer(),a=new dijit.layout.BorderContainer({title:this.title,style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1,region:"center"});a.addChild(this.createGrid());b.addChild(a)},exportProjectReport:function(){form=document.createElement("form");
form.setAttribute("method","post");form.setAttribute("action","budgetReportExport/exportProjectReport/pid/"+this.project.id);form.setAttribute("action","subPackageClaimExport/export/pid/"+this.project.id);form.setAttribute("target","_self");document.body.appendChild(form);return form.submit()},getGridStructure:function(){return{noscroll:!1,cells:[[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:this.formatter.rowCountCellFormatter,rowSpan:2},{name:a.description,field:"description",
width:"auto",rowSpan:2},{name:a.claimNumber,field:"claim_no",width:"90px",styles:"text-align: center;",formatter:this.formatter.unEditableIntegerCellFormatter,rowSpan:2},{name:a.contractAmount,field:"contract_amount",width:"90px",styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter,rowSpan:2},{name:a.voAmount,field:"vo_amount",width:"90px",styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter,rowSpan:2},{name:a.workDone,field:"accumulative_work_done",
width:"90px",styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter},{name:a.voWorkDone,field:"accumulative_vo_work_done",width:"90px",styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter},{name:a.amountCertified,field:"amount_certified",width:"90px",styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter,rowSpan:2},{name:a.percent,field:"profit_and_attendance_percent",width:"90px",styles:"text-align: center;",
editable:!0,cellType:"buildspace.widget.grid.cells.FormulaTextBox",formatter:this.formatter.editablePercentageCellFormatter},{name:a.workDone,field:"profit_and_attendance_work_done",width:"90px",styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter},{name:a.voWorkDone,field:"profit_and_attendance_vo_work_done",width:"90px",styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter},{name:a.total,field:"profit_and_attendance_total",width:"90px",
styles:"text-align: right;",formatter:this.formatter.unEditableCurrencyCellFormatter}],[{name:a.accumulative,styles:"text-align:center;",headerClasses:"staticHeader",colSpan:2},{name:a.profitAndAttendance,styles:"text-align:center;",headerClasses:"staticHeader",colSpan:4}]]}},createStackContainer:function(){var b=this.id+"-subPackageClaim-stackContainer",a=this.stackContainer=new dijit.layout.StackContainer({style:"border:0px;width:100%;height:100%;",region:"center",id:b});dojo.subscribe(b+"-selectChild",
"",function(a){var c=dijit.byId(b);if(c){var d=c.getChildren();a=dojo.indexOf(d,a);a+=1;if(d.length>a)for(;d.length>a;)c.removeChild(d[a]),d[a].destroyDescendants(),d[a].destroyRecursive(),a+=1}});var d=new dijit.layout.StackController({region:"top",containerId:b});d=new dijit.layout.ContentPane({style:"padding:0px;overflow:hidden;",baseClass:"breadCrumbTrail",region:"top",id:this.id+"-subPackageClaim-controllerPane",content:d});this.addChild(a);this.addChild(d);return a},createGrid:function(){var b=
this,c=new dijit.Toolbar({region:"top",style:"outline:none!important;border:none;padding:2px;width:100%;"});c.addChild(new dijit.form.Button({label:a.export,iconClass:"icon-16-container icon-16-print",style:"outline:none!important;",onClick:function(){b.exportProjectReport()}}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({id:b.project.id+"ReloadGrid-button",label:a.reload,iconClass:"icon-16-container icon-16-reload",onClick:function(a){b.grid.reload()}}));var d=this.grid=
p({project:b.project,structure:b.getGridStructure(),store:new dojo.data.ItemFileWriteStore({clearOnClose:!0,url:"subPackageClaim/getSubPackages/pid/"+b.project.id})}),f=new dijit.layout.BorderContainer({style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1,region:"center"});f.addChild(c);f.addChild(d);return f},close:function(){this.parentContainer.removeChild(this);return this.destroyRecursive()}})});
