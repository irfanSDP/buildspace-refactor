(function(){define("buildspace/apps/CompanyDirectories/Branches/CompanyBranchContainer","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-attr dojox/grid/enhanced/plugins/Menu dojox/grid/enhanced/plugins/Selector dojox/grid/enhanced/plugins/Rearrange dojo/_base/event dojo/keys dojo/dom-style dijit/focus dojo/_base/html dojo/request/xhr dijit/Toolbar dijit/form/Button dijit/PopupMenuItem dojo/request dijit/layout/BorderContainer buildspace/widget/grid/cells/Textarea buildspace/widget/grid/cells/Formatter ./CompanyBranchForm dojo/i18n!../../../nls/CompanyDirectories".split(" "),
function(g,t,u,v,w,x,n,y,z,A,B,C,D,p,h,E,k,q,F,r,l,e){var m;m=g("buildspace.apps.CompanyDirectories.Branches.CompanyBranchGrid",dojox.grid.EnhancedGrid,{style:"border-top:none;",keepSelection:!0,rowSelector:"0px",region:"center",companyBranchContainer:null,editable:!0,constructor:function(a){return this.rearranger=n(this,{})},canSort:function(a){return!1},noDataMessage:e.noBranchAvailableInGrid,postCreate:function(){this.inherited(arguments);return this.on("RowClick",function(a){return(a=this.getItem(a.rowIndex))&&
0<a.id[0]&&this.editable?this.disableToolbarButtons(!1):this.disableToolbarButtons(!0)})},onRowDblClick:function(a){if(0<this.getItem(a.rowIndex).id[0])return this.editExistingBranch(this.getItem(a.rowIndex))},editExistingBranch:function(a){var c,b;b=this;c=new buildspace.dialog.indeterminateProgressBar({title:e.processing+"..."});c.show();return k.get("companyDirectories/getBranchInformation",{query:{companyId:b.companyId,branchId:a.id},handleAs:"json"}).then(function(d){var f;f=new l({companyId:b.companyId,
branchId:a.id,formInfo:d.branchInformationForm,companyBranchContainer:b.companyBranchContainer,editable:b.editable});d=new dijit.layout.BorderContainer({style:"padding:0px;width:100%;height:100%;",baseClass:"form",gutters:!1,region:"center"});d.addChild(f);b.companyBranchContainer.makePane(e.editBranch,d);return c.hide()},function(a){return c.hide()})},deleteRow:function(a){var c,b,d;b=this;a=this.getItem(a);c=buildspace.dialog.indeterminateProgressBar({title:e.deleting+". "+e.pleaseWait+"..."});
c.show();d={url:"companyDirectories/deleteBranchInfo",content:{branchId:a.id,_csrf_token:a._csrf_token},handleAs:"json",load:function(a){c.hide();return a.success?b.refreshGrid():console.log(a)},error:function(a){return c.hide()}};return new buildspace.dialog.confirm(e.deleteBranchTitle,e.deleteBranchMsg,80,320,function(){return dojo.xhrPost(d)},function(){return c.hide()})},refreshGrid:function(){this.store.save();this.store.close();return this.setStore(this.store)},disableToolbarButtons:function(a,
c){var b=dijit.byId("deleteBranchFromCompanyDirectories");b&&b.set("disabled",a)}});return g("buildspace.apps.CompanyDirectories.Branches.CompanyBranchContainer",q,{companyId:-1,dialogContainer:null,style:"padding:0px;width:100%;height:100%;",title:e.tabBranchesDesc,gutters:!1,formInfo:null,editable:!0,postCreate:function(){var a,c,b,d,f;this.inherited(arguments);b=this;(d=dijit.byId("companyDirectoriesBranchMaintenance-stackContainer"))&&dijit.byId("companyDirectoriesBranchMaintenance-stackContainer").destroyRecursive();
d=b.stackContainer=new dijit.layout.StackContainer({style:"width:100%;height:100%;",region:"center",id:"companyDirectoriesBranchMaintenance-stackContainer"});a=new dojo.data.ItemFileWriteStore({url:"companyDirectories/getBranchesListing/companyId/"+this.companyId,clearOnClose:!0,urlPreventCache:!0});c=this.grid=new m({structure:b.getGridLayout(),store:a,companyId:this.companyId,formInfo:this.formInfo,companyBranchContainer:b,editable:b.editable});a=new dijit.layout.BorderContainer({region:"top",gutters:!1});
this.editable&&(f=new p({region:"top",style:"outline:none!important;padding:2px;border:none;overflow:hidden;"}),f.addChild(new h({label:e.addNewBranch,iconClass:"icon-16-container icon-16-add",disabled:b.editable?!1:!0,onClick:function(){var a=new buildspace.dialog.indeterminateProgressBar({title:e.processing+"..."});a.show();return k.get("companyDirectories/getBranchInformation",{query:{companyId:b.companyId,branchId:-1},handleAs:"json"}).then(function(c){var d;d=new l({companyId:b.companyId,branchId:-1,
formInfo:c.branchInformationForm,companyBranchContainer:b});c=new dijit.layout.BorderContainer({style:"padding:0px;width:100%;height:100%;",baseClass:"form",gutters:!1,region:"center"});c.addChild(d);b.makePane(e.addNewBranch,c);return a.hide()},function(b){return a.hide()})}})),f.addChild(new dijit.ToolbarSeparator),f.addChild(new h({label:e["delete"],id:"deleteBranchFromCompanyDirectories",iconClass:"icon-16-container icon-16-delete",disabled:!0,onClick:function(){return c.deleteRow(c.selection.selectedIndex)}})),
a.addChild(f));a.addChild(c);a=new dijit.layout.ContentPane({title:e.tabBranchesDesc,content:a});d.addChild(a);a=new dijit.layout.StackController({region:"top",containerId:"companyDirectoriesBranchMaintenance-stackContainer"});a=new dijit.layout.ContentPane({style:"padding: 0px; overflow: hidden;",baseClass:"breadCrumbTrail",region:"top",content:a});this.addChild(d);this.addChild(a);return dojo.subscribe("companyDirectoriesBranchMaintenance-stackContainer-selectChild","",function(a){var b,c,d;if(c=
dijit.byId("companyDirectoriesBranchMaintenance-stackContainer")){b=c.getChildren();a=dojo.indexOf(b,dijit.byId(a.id));a+=1;for(d=[];b.length>a;)c.removeChild(b[a]),b[a].destroyRecursive(),d.push(a+=1);return d}})},makePane:function(a,c){var b,d;d=dijit.byId("companyDirectoriesBranchMaintenance-stackContainer");b=new dijit.layout.ContentPane({title:a,content:c});d.addChild(b);return d.selectChild(b)},getGridLayout:function(){return[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:(new r).rowCountCellFormatter},
{name:e.branchName,field:"branch_name",width:"auto"},{name:e.country,field:"country",width:"120px",styles:"text-align: center;"},{name:e.state,field:"state",width:"120px",styles:"text-align: center;"}]}})})}).call(this);
