define("buildspace/apps/PostContractReport/VariationOrder/VariationOrderGrid","dojo/_base/declare dojo/_base/lang dojo/_base/html dojo/aspect dojo/request dojo/_base/connect dijit/TooltipDialog dijit/popup dojo/number dijit/focus dojo/_base/event dojo/keys dojox/grid/EnhancedGrid dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem dijit/PopupMenuItem dojox/grid/enhanced/plugins/Rearrange buildspace/widget/grid/plugins/FormulatedColumn dojox/grid/enhanced/plugins/IndirectSelection ./BillDialog ./PrintAllSelectedVODialog ./PrintAllVOWithClaims ./PrintSelectedVOItemsDialog ./PrintAllVOItemsWithClaimDialog ./PrintSelectedVOItemsWithBuildUpQtyDialog dojo/i18n!buildspace/nls/PostContract".split(" "),
function(m,n,F,p,g,h,q,k,G,H,I,J,r,t,u,v,K,w,x,L,y,z,A,B,C,D,e){var E=m("buildspace.apps.PostContractReport.VariationOrder.VariationOrderEnhancedGrid",r,{escapeHTMLInData:!1,type:null,style:"border-top:none;",rowSelector:"0px",selectedItem:null,region:"center",project:null,locked:!1,keepSelection:!0,variationOrder:null,constructor:function(a){this.rearranger=w(this,{});this.formulatedColumn=x(this,{});this.plugins={indirectSelection:{headerSelector:!0,width:"40px",styles:"text-align: center;"}}},
postCreate:function(){var a=this,b,c=null;a.inherited(arguments);b="vo"===a.type?a.gridContainer.voSelectedStore:a.gridContainer.voItemSelectedStore;p.after(a,"_onFetchComplete",function(){a.gridContainer.markedCheckBoxObject(a,b)});"vo"!==a.type&&(this._connects.push(h.connect(this,"onCellMouseOver",function(b){var d=a.getItem(b.rowIndex),e=b.rowIndex,l=b.cell.field.replace("-value","");"undefined"!==typeof d[l+"-has_formula"]&&d[l+"-has_formula"][0]&&(d=d[l+"-value"][0],d=this.formulatedColumn.convertItemIdToRowIndex(d,
e),null===c&&(c=new q({content:d,onMouseLeave:function(){k.close(c)}}),k.open({popup:c,around:b.cellNode})))})),this._connects.push(h.connect(this,"onCellMouseOut",function(a){null!==c&&(k.close(c),c=null)})))},startup:function(){var a=this;a.inherited(arguments);this._connects.push(h.connect(this,"onCellClick",function(b){""===b.cell.name&&a.singleCheckBoxSelection(b)}));this._connects.push(h.connect(this.rowSelectCell,"toggleAllSelection",function(b){a.toggleAllSelection(b)}))},canSort:function(a){return!1},
canEdit:function(a,b){return!1},onStyleRow:function(a){this.inherited(arguments);if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length){var b=a.node.children[0].children[0].rows[1],c=a.node.children[0].children[0].rows[0].children;b.parentNode.removeChild(b);dojo.forEach(c,function(a,b){var c=dojo.attr(a,"rowSpan");(!c||2>c)&&dojo.attr(a,"rowSpan",2)})}},editableCellDblClick:function(a){var b;b=1<this._click.length&&has("ie")?this._click[1]:1<this._click.length&&this._click[0].rowIndex!=
this._click[1].rowIndex?this._click[0]:a;this.focus.setFocusCell(b.cell,b.rowIndex);this.onRowClick(b);this.onRowDblClick(a)},dodblclick:function(a){if(a.cellNode)if(a.cell.editable)this.editableCellDblClick(a);else this.onCellDblClick(a);else this.onRowDblClick(a)},openBillDialog:function(a){0<a&&--a;if(-1<a)var b=this.getItem(a);(new y({variationOrderItem:b,variationOrder:this.variationOrder,type:"omit_from_bill",locked:this.locked,variationOrderItemGrid:this})).show()},destroy:function(){this.inherited(arguments);
dojo.forEach(this._connects,h.disconnect);delete this._connects}});return m("buildspace.apps.PostContractReport.VariationOrder.VariationOrderGrid",dijit.layout.BorderContainer,{stackContainerTitle:"",style:"padding:0px;width:100%;height:100%;",gutters:!1,project:null,variationOrder:null,gridOpts:{},locked:!1,type:null,pageId:0,postCreate:function(){var a=this,b;this.inherited(arguments);n.mixin(a.gridOpts,{type:a.type,project:a.project,variationOrder:a.variationOrder,locked:a.locked});var c=new u({style:"display: none;"}),
d=this.grid=new E(a.gridOpts),f=new dijit.Toolbar({region:"top",style:"padding:2px;border-bottom:none;width:100%;"});switch(this.type){case "vo":b="variationOrder-"+a.project.id;break;case "vo-items":b="variationOrderReportingItems-"+a.project.id+"_"+a.variationOrder.id;break;case "vo-claims":break;default:throw Error("type must be set!");}dojo.forEach(["voSummary","voSummaryWithClaims","voSelectedItems","voItemsWithClaim","voItemsWithBuildUpQty"],function(b){var d;switch(b){case "voSummary":d="openPrintAllSelectedVODialog";
break;case "voSummaryWithClaims":d="openPrintAllVOWithClaims";break;case "voSelectedItems":d="openPrintAllSelectedVOItems";break;case "voItemsWithClaim":d="openPrintAllVOItemsWithClaim";break;case "voItemsWithBuildUpQty":d="openPrintSelectedVOItemsWithBuildUpQty"}c.addChild(new v({label:e[b],onClick:function(){a[d](b)}}))});f.addChild(new t({label:e.printPreview,iconClass:"icon-16-container icon-16-print",dropDown:c}));this.addChild(f);this.addChild(new dijit.layout.ContentPane({style:"width:100%",
content:d,region:"center"}));"vo-claims"!==this.type&&(b=dijit.byId(b+"-stackContainer"))&&(f=document.createElement("div"),f=new dojox.layout.ContentPane({title:buildspace.truncateString(a.stackContainerTitle,60),id:a.pageId,executeScripts:!0},f),b.addChild(f),f.set("content",a),n.mixin(f,{grid:d}),b.selectChild(a.pageId))},openPrintAllSelectedVODialog:function(){var a=this,b=[];a.gridOpts.gridContainer.voSelectedStore.query().forEach(function(a){b.push(a.id)});var c=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+
"..."});c.show();g.post("variationOrderReporting/getPrintingSelectedVO",{handleAs:"json",data:{pid:a.project.id[0],vo_ids:JSON.stringify(a.gridOpts.gridContainer.arrayUnique(b))}}).then(function(d){(new z({project:a.project,projectId:a.project.id,title:e.voSummary,data:d,selectedItems:b})).show();c.hide()},function(a){console.log(a);c.hide()})},openPrintAllVOWithClaims:function(){var a=this,b=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});b.show();g.post("variationOrderReporting/getPrintingVOWithClaims",
{handleAs:"json",data:{pid:a.project.id[0]}}).then(function(c){(new A({project:a.project,projectId:a.project.id,title:e.voSummaryWithClaims,data:c})).show();b.hide()},function(a){console.log(a);b.hide()})},openPrintAllSelectedVOItems:function(){var a=this,b=[];a.gridOpts.gridContainer.voItemSelectedStore.query().forEach(function(a){b.push(a.id)});var c=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});c.show();g.post("variationOrderReporting/getPrintingSelectedVOItemsDialog",
{handleAs:"json",data:{pid:a.project.id[0],item_ids:JSON.stringify(a.gridOpts.gridContainer.arrayUnique(b))}}).then(function(d){(new B({project:a.project,projectId:a.project.id,title:e.voSelectedItems,data:d,selectedItems:b})).show();c.hide()},function(a){console.log(a);c.hide()})},openPrintAllVOItemsWithClaim:function(){var a=this,b=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});b.show();g.post("variationOrderReporting/getPrintingVOItemsWithClaim",{handleAs:"json",data:{pid:a.project.id[0]}}).then(function(c){(new C({project:a.project,
projectId:a.project.id,title:e.voItemsWithClaim,data:c})).show();b.hide()},function(a){console.log(a);b.hide()})},openPrintSelectedVOItemsWithBuildUpQty:function(){var a=this,b=[];a.gridOpts.gridContainer.voItemSelectedStore.query().forEach(function(a){b.push(a.id)});var c=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});c.show();g.post("variationOrderReporting/getPrintingSelectedVOItemsWithBuildUpQty",{handleAs:"json",data:{pid:a.project.id[0],item_ids:JSON.stringify(a.gridOpts.gridContainer.arrayUnique(b))}}).then(function(d){(new D({project:a.project,
projectId:a.project.id,title:e.voItemsWithBuildUpQty,data:d,selectedItems:b})).show();c.hide()},function(a){console.log(a);c.hide()})}})});
