define("buildspace/apps/PostContractReport/VariationOrder/VariationOrderClaim","dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/focus dojo/_base/event dojo/keys dojox/grid/EnhancedGrid buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/PostContract".split(" "),function(l,v,w,m,x,y,n,p,d){var q=function(b,a,c){a=this.grid.getItem(a);c.customClasses.push("disable-cell");return 0<a.id?d.version+" "+d.no+" "+b:"&nbsp;"},r=function(b,a,c){if(0<this.grid.getItem(a).id)return b?'<span class="icon-16-container icon-16-checkmark2" style="margin:0px auto; display:block;"></span>':
'<a href="#" onclick="return false;">'+d.printThisRevision+"</a>";c.customClasses.push("disable-cell");return"&nbsp;"},t=function(b,a,c){a=this.grid.getItem(a);a.can_be_edited[0]||c.customClasses.push("disable-cell");return 0<a.id?1==parseInt(b)?d.addendumProgressing:d.addendumLocked:"&nbsp;"},u=l("buildspace.apps.PostContractReport.VariationOrder.VariationOrderClaimEnhancedGrid",n,{style:"border-top:none;",rowSelector:"0px",variationOrder:null,variationOrderItemContainer:null,region:"center",constructor:function(b){var a=
new p;this.store=new dojo.data.ItemFileWriteStore({url:"variationOrder/getClaimList/id/"+b.variationOrder.id,clearOnClose:!0});this.structure=[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:a.rowCountCellFormatter},{name:d.claimVersion,field:"revision",width:"auto",formatter:q},{name:d.currentPrintingRevision,field:"is_viewing",width:"140px",styles:"text-align: center;",formatter:r},{name:d.status,field:"status",width:"120px",styles:"text-align: center;",formatter:t}]},
canSort:function(b){return!1},postCreate:function(){var b=this;b.inherited(arguments);this.on("CellClick",function(a){var c=a.cell.field;a=b.getItem(a.rowIndex);"is_viewing"==c&&a&&0<a.id&&!a.is_viewing[0]&&b.changeCurrentViewingRevision(a)})},changeCurrentViewingRevision:function(b){var a=this,c=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});m.curNode.blur();m.curNode=null;c.show();dojo.xhrPost({url:"variationOrder/viewClaimRevision",content:{id:b.id,_csrf_token:b._csrf_token},
handleAs:"json",load:function(k){if(k.success){var f=a.store;dojo.forEach(k.items,function(e){f.fetchItemByIdentity({identity:e.id,onItem:function(g){for(var h in e)g.hasOwnProperty(h)&&h!=f._getIdentifierAttribute()&&f.setValue(g,h,e[h])}})});f.save();dojo.xhrGet({url:"variationOrder/getClaimStatus",content:{id:a.variationOrder.id},handleAs:"json"}).then(function(e){dojo.xhrGet({url:"variationOrder/getUnits",handleAs:"json"}).then(function(g){a.variationOrderItemContainer.createVariationOrderItemGrid(g,
e,!1)})})}c.hide();a.selection.clear();a.disableToolbarButtons(!0)},error:function(k){a.selection.clear();a.disableToolbarButtons(!0);c.hide()}})}});return l("buildspace.apps.PostContractReport.VariationOrder.VariationOrderClaim",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;",gutters:!1,variationOrder:null,variationOrderItemContainer:null,claimStatus:null,postCreate:function(){this.inherited(arguments);var b=new u({variationOrder:this.variationOrder,variationOrderItemContainer:this.variationOrderItemContainer});
this.addChild(new dijit.layout.ContentPane({style:"width:100%",content:b,region:"center"}))}})});
