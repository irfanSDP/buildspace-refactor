define("buildspace/apps/PostContractSubPackage/VariationOrder","dojo/_base/declare dojo/aspect dojo/currency dojo/number dijit/layout/ContentPane ./VariationOrder/VariationOrderGrid ./VariationOrder/VariationOrderItemContainer buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/PostContract".split(" "),function(l,m,k,n,x,p,q,r,a){var t=[a.pending,a.approved],u=["false","true"],v=function(b,c,d){if(this.grid.getItem(c).id==buildspace.constants.GRID_LAST_ROW)return d.customClasses.push("disable-cell"),
"&nbsp;";if("true"==b)return d.customClasses.push("green-cell"),a.approved.toUpperCase();d.customClasses.push("yellow-cell");return a.pending.toUpperCase()},w=function(b,a,d){d.customClasses.push("disable-cell");b=n.parse(b);return 0>b?'<span style="color:#FF0000">'+k.format(b)+"</span>":0==b?"&nbsp;":'<span style="color:#42b449;">'+k.format(b)+"</span>"};return l("buildspace.apps.PostContractSubPackage.VariationOrder",dijit.layout.BorderContainer,{style:"padding:0;margin:0;border:none;width:100%;height:100%;",
gutters:!1,region:"center",subPackage:null,postCreate:function(){this.inherited(arguments);var b=this,c=new r,d=dojo.data.ItemFileWriteStore({url:"variationOrder/getSpVariationOrderList/spid/"+b.subPackage.id,clearOnClose:!0}),c=new p({id:"variation_order-"+b.subPackage.id,stackContainerTitle:a.scheduleOfRates,pageId:"variation_order-"+b.subPackage.id,subPackage:b.subPackage,type:"vo",gridOpts:{store:d,addUrl:"variationOrder/spVariationOrderAdd",updateUrl:"variationOrder/spVariationOrderUpdate",deleteUrl:"variationOrder/spVariationOrderDelete",
structure:[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:c.rowCountCellFormatter},{name:a.description,field:"description",width:"auto",editable:!0,cellType:"buildspace.widget.grid.cells.Textarea"},{name:a.omission,field:"omission",width:"150px",styles:"text-align:right;color:#FF0000;",formatter:c.unEditableCurrencyCellFormatter},{name:a.addition,field:"addition",width:"150px",styles:"text-align:right;",formatter:c.unEditableCurrencyCellFormatter},{name:a.nettOmissionAddition,
field:"nett_omission_addition",width:"150px",styles:"text-align:right;",formatter:w},{name:a.upToDateClaim,field:"total_claim",width:"150px",styles:"text-align:right;",formatter:c.unEditableCurrencyCellFormatter},{name:a.status,field:"is_approved",width:"80px",styles:"text-align:center;",editable:!0,type:"dojox.grid.cells.Select",options:t,values:u,formatter:v},{name:a.lastUpdated,field:"updated_at",width:"120px",styles:"text-align: center;"}],onRowDblClick:function(a){a=this.getItem(a.rowIndex);
0<a.id&&null!==a.description[0]&&0<a.description[0].length&&new q({stackContainerTitle:a.description,subPackage:b.subPackage,variationOrder:a,id:"SP_variation_order_items-"+a.id+"-"+b.subPackage.id,pageId:"SP_variation_order_items-"+a.id+"-"+b.subPackage.id+"-page"})}}}),c=this.makeGridContainer(c,a.variationOrders);this.addChild(c)},makeGridContainer:function(a,c){var b=this.subPackage.id,e=dijit.byId("SP_variationOrder-"+b+"-stackContainer");e&&dijit.byId("SP_variationOrder-"+b+"-stackContainer").destroyRecursive();
e=new dijit.layout.StackContainer({style:"width:100%;height:100%;border:none;",region:"center",id:"SP_variationOrder-"+b+"-stackContainer"});e.addChild(new dijit.layout.ContentPane({title:c,content:a,grid:a.grid}));var g=new dijit.layout.StackController({region:"top",containerId:"SP_variationOrder-"+b+"-stackContainer"}),g=new dijit.layout.ContentPane({style:"padding:0;overflow:hidden;","class":"breadCrumbTrail",region:"top",content:g}),h=new dijit.layout.BorderContainer({style:"padding:0;margin:0;width:100%;height:100%;border:none;",
gutters:!1,region:"center"});h.addChild(e);h.addChild(g);dojo.subscribe("SP_variationOrder-"+b+"-stackContainer-selectChild","",function(a){var c=dijit.byId("SP_variationOrder-"+b+"-stackContainer");if(c){var d=c.getChildren(),f=dojo.indexOf(d,a),f=f+1;if(d.length>f){for(;d.length>f;)c.removeChild(d[f]),d[f].destroyDescendants(),d[f].destroyRecursive(),f+=1;var e=a.grid.selection.selectedIndex;a.grid.store.save();a.grid.store.close();var g=m.after(a.grid,"_onFetchComplete",function(){g.remove();-1<
e&&(this.scrollToRow(e,!0),this.selection.setSelected(e,!0))});a.grid.sort()}}});return h}})});
