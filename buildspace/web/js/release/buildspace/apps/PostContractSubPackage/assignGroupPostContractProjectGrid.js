(function(){define("buildspace/apps/PostContractSubPackage/assignGroupPostContractSubPackageProjectGrid","dojo/_base/declare dojo/aspect dojo/_base/lang dojo/_base/connect dojo/when dojo/html dojo/dom dojo/keys dojo/dom-style buildspace/widget/grid/cells/Formatter dojox/grid/enhanced/plugins/IndirectSelection dojo/i18n!buildspace/nls/PostContractSubPackage".split(" "),function(f,l,q,e,r,t,u,m,n,p,v,d){var h,k;k=f("buildspace.apps.PostContractSubPackage.AssignGroupPostContractSubPackageProjectGrid",
dojox.grid.EnhancedGrid,{style:"border-top:none;",region:"center",rootProjectId:-1,itemIds:[],selectedGroups:null,constructor:function(b){this.itemIds=[];this.plugins={indirectSelection:{headerSelector:!0,width:"20px",styles:"text-align:center;"}};return this.inherited(arguments)},canSort:function(){return!1},postCreate:function(){var b,a=this;b=this;b.inherited(arguments);l.after(this,"_onFetchComplete",function(){return a.markedCheckBoxObject(a.selectedGroups,!0)});this._connects.push(e.connect(this,
"onCellClick",function(a){return""!==a.cell.name?!1:b.selectTree(a)}));return this._connects.push(e.connect(this.rowSelectCell,"toggleAllSelection",function(a){return b.toggleAllSelection(a)}))},save:function(){var b,a;b=this.getItem(0);b={id:this.rootProjectId,"project_structure[post_contract_groups_list][]":this.itemIds,"project_structure[_csrf_token]":b._csrf_token[0]};a=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});a.show();return dojo.xhrPost({url:"postContract/updatePostContractSubPackageProjectGroupInfo",
handleAs:"json",content:b,load:function(b){return a.hide()},error:function(b){return a.hide()}})},selectTree:function(b){var a;a=b.rowIndex;b=this.selection.selected[a];if(a=this.getItem(a))return this.pushItemIdIntoGridArray(a,b)},markedCheckBoxObject:function(b,a){var c,d,g,f,e;g=this;f=this.store;c=-1;e=[];for(d in b)e.push(f.fetchItemByIdentity({identity:d,onItem:function(b){c=b._0;g.pushItemIdIntoGridArray(b,a);return g.selection.setSelected(c,a)}}));return e},pushItemIdIntoGridArray:function(b,
a){var c;c=dojo.indexOf(this.itemIds,b.id[0]);if(a){if(-1===c)return this.itemIds.push(b.id[0])}else if(-1!==c)return this.itemIds.splice(c,1)},toggleAllSelection:function(b){var a,c;a=this;c=a.selection;if(b)return c.selectRange(0,a.rowCount-1),a.itemIds=[],a.store.fetch({onComplete:function(b){return dojo.forEach(b,function(b,c){if(0<b.id)return a.itemIds.push(b.id[0])})}});c.deselectAll();return a.itemIds=[]},destroy:function(){this.inherited(arguments);dojo.forEach(this._connects,e.disconnect);
return delete this._connects}});h=f("buildspace.apps.PostContractSubPackage.AssignGroupPostContractSubPackageProjectGridContainer",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;",region:"center",gutters:!1,dialog:null,store:null,structure:null,rootProjectId:-1,rootProjectTitle:null,selectedGroups:null,postCreate:function(){var b,a,c;a=this;a.inherited(arguments);b=this.grid=new k({rootProjectId:a.rootProjectId,store:a.store,structure:a.structure,selectedGroups:a.selectedGroups[0]});
c=new dijit.Toolbar({region:"top",style:"padding:2px;border-bottom:none;width:100%;"});c.addChild(new dijit.form.Button({label:d.save,iconClass:"icon-16-container icon-16-save",disabled:a.isSuperAdmin?!0:!1,onClick:function(){return b.save()}}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({label:d.close,iconClass:"icon-16-container icon-16-close",onClick:function(){return a.dialog.hide()}}));a.addChild(c);return a.addChild(new dijit.layout.ContentPane({style:"width:100%",
content:b,region:"center"}))}});return f("buildspace.apps.PostContractSubPackage.GroupProjectAssignmentDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",title:d.addGroupsToPostContractSubPackageProject,rootProjectId:-1,rootProjectTitle:null,data:null,isSuperAdmin:!1,buildRendering:function(){var b;b=this.createContent();b.startup();this.content=b;this.title=""+d.addGroupsToPostContractSubPackageProject+" ("+this.rootProjectTitle+")";return this.inherited(arguments)},postCreate:function(){n.set(this.containerNode,
{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";return this.inherited(arguments)},_onKey:function(b){if(b.keyCode===m.ESCAPE)return dojo.stopEvent(b)},onHide:function(){return this.destroyRecursive()},createContent:function(){var b,a,c;b=new dijit.layout.BorderContainer({style:"padding:0px;width:950px;height:500px;",gutters:!1});c=dojo.data.ItemFileWriteStore({data:this.data.data});a=new p;a=new h({dialog:this,selectedGroups:this.data.groups,rootProjectId:this.rootProjectId,
rootProjectTitle:this.rootProjectTitle,store:c,structure:[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:a.rowCountCellFormatter},{name:d.name,field:"name",width:"auto"},{name:d.lastUpdated,field:"updated_at",width:"120px",styles:"text-align: center;"}]});b.addChild(a);return b}})})}).call(this);
