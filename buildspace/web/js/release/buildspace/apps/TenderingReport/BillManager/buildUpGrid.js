define("buildspace/apps/TenderingReport/BillManager/buildUpGrid","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/dom-attr dojo/_base/connect dojox/grid/enhanced/plugins/Menu dojox/grid/enhanced/plugins/Selector dojox/grid/enhanced/plugins/Rearrange buildspace/widget/grid/plugins/FormulatedColumn dojo/_base/event dojo/keys dojo/currency dijit/focus dojo/_base/html dojo/request/xhr dijit/PopupMenuItem buildspace/widget/grid/cells/Select buildspace/widget/grid/cells/Textarea buildspace/widget/grid/cells/FormulaTextBox dijit/popup dijit/TooltipDialog dojo/i18n!buildspace/nls/BuildUpGrid".split(" "),
function(h,l,r,t,d,u,v,m,n,w,x,p,y,z,A,B,C,D,E,f,k,F){var q=h("buildspace.apps.TenderingReport.BillManager.BuildUp.grid",dojox.grid.EnhancedGrid,{itemId:-1,resource:null,BQItem:null,style:"border-top:none;",selectedItem:null,unitObj:null,keepSelection:!0,rowSelector:"0px",addUrl:null,updateUrl:null,deleteUrl:null,pasteUrl:null,buildUpSummaryWidget:null,currentBillLockedStatus:!1,disableEditingMode:!1,constructor:function(a){this.rearranger=m(this,{});this.formulatedColumn=n(this,{});this.currencySetting=
buildspace.billCurrencyAbbreviation?buildspace.billCurrencyAbbreviation:buildspace.currencyAbbreviation},postCreate:function(){var a=null;this.inherited(arguments);this._connects.push(d.connect(this,"onCellMouseOver",function(g){var c=g.cell.field,e=g.rowIndex,b=this.getItem(e),c=c.replace("-value","");"undefined"!==typeof b[c+"-has_formula"]&&b[c+"-has_formula"][0]&&(b=b[c+"-value"][0],b=this.formulatedColumn.convertItemIdToRowIndex(b,e),null===a&&(a=new k({content:b,onMouseLeave:function(){f.close(a)}}),
f.open({popup:a,around:g.cellNode})))}));this._connects.push(d.connect(this,"onCellMouseOut",function(){null!==a&&(f.close(a),a=null)}));this._connects.push(d.connect(this,"onStartEdit",function(){null!==a&&(f.close(a),a=null)}))},canSort:function(a){return!1},onCellFocus:function(a,g){var c=this,e=c.getItem(g);"description"!==a.field||0>e.id[0]||!e.linked[0]?c.closeToolTipDialogIfAvailable():dojo.xhrGet({url:"resourceLibrary/getBuildUpRatesToolTipInformation",content:{id:e.id,type:"bill"},handleAs:"json",
load:function(b){if(b.success){c.closeToolTipDialogIfAvailable();var e=!1,d='<h1 style="font-size: 12px; text-shadow: 1px 1px 1px #000;background-color: rgba(35, 35, 35, .85); color: #fff; padding: 4px 10px;">'+b.items[0].description+"</h1>";1<Object.keys(b.items).length&&(e=!0,d+='<table style="width: 100%; border-collapse: collapse;">');dojo.forEach(b.items,function(a,b){0!==b&&(d+='<tr><td style="border: 1px dotted #D5CDB5; font-weight: bold; font-size: 11px; padding-left:'+16*a.level+'px;">'+
a.description+"</td></td>")});e&&(d+="</table>");c.myTooltipDialog=new k({id:"buildUpRatesTooltipDialog-"+c.itemId[0],style:"width: 300px;",content:d});f.open({popup:c.myTooltipDialog,around:a.view.rowNodes[g],orient:["below"]})}},error:function(a){console.log(a)}})},onRowMouseOut:function(){this.closeToolTipDialogIfAvailable()},updateTotalBuildUp:function(a){dijit.byId("accPane-"+this.resource.id+"-"+this.BQItem.id).set("title",this.resource.name+'<span style="color:blue;float:right;">'+this.currencySetting+
"&nbsp;"+p.format(a)+"</span>");this.buildUpSummaryWidget.refreshTotalCost()},closeToolTipDialogIfAvailable:function(){var a=dijit.byId("buildUpRatesTooltipDialog-"+this.itemId[0]);void 0!==this.myTooltipDialog&&void 0!==a&&(f.close(),a.destroy())},destroy:function(){this.inherited(arguments);dojo.forEach(this._connects,d.disconnect);delete this._connects}});return h("buildspace.apps.TenderingReport.BillManager.BuildUpGrid",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;border:0px;",
gutters:!1,resource:null,BQItem:null,gridOpts:{},postCreate:function(){this.inherited(arguments);l.mixin(this.gridOpts,{resource:this.resource,BQItem:this.BQItem,region:"center"});var a=this.grid=new q(this.gridOpts);this.addChild(new dijit.layout.ContentPane({style:"width:100%",content:a,region:"center"}))}})});
