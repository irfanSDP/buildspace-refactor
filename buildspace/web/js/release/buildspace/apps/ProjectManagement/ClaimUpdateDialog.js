define("buildspace/apps/ProjectManagement/ClaimUpdateDialog","dojo/_base/declare dojo/_base/lang dojo/html dojo/dom dojo/keys dojo/currency dojo/number dojo/dom-style dojox/grid/EnhancedGrid buildspace/widget/grid/cells/Textarea buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/ProjectManagement".split(" "),function(k,u,v,w,l,m,h,n,p,x,q,g){var t=k("buildspace.apps.ProjectManagement.ClaimUpdateGrid",p,{escapeHTMLInData:!1,style:"border-top:none;",keepSelection:!0,scheduleTaskItemBillItem:null,
tagBillItemGrid:null,type:null,doApplyCellEdit:function(c,d,e){var f=this,a=this.getItem(d),b=buildspace.dialog.indeterminateProgressBar({title:g.pleaseWait+"..."});if(c!==a[e][0]&&0<a.id){var a={id:a.id[0],attr_name:e,val:c,t:"up_to_date_claim_percentage"==this.type?"p":"a",_csrf_token:a._csrf_token?a._csrf_token:null},r=this.getCellByField(e);b.show();dojo.xhrPost({url:"projectManagement/updateClaimByUnit",content:a,handleAs:"json",load:function(a){a.success&&(f.tagBillItemGrid&&(f.tagBillItemGrid.store.save(),
f.tagBillItemGrid.store.close(),f.tagBillItemGrid.sort()),b.hide());window.setTimeout(function(){f.focus.setFocusIndex(d,r.index)},10)},error:function(a){b.hide()}})}this.inherited(arguments)},canSort:function(c){return!1},doCancelEdit:function(c){this.inherited(arguments);this.views.renormalizeRow(c);this.scroller.rowHeightChanged(c,!0)},canEdit:function(c,d){if(void 0!=c){var e=this.getItem(d);if(e&&0<e.id)return this._canEdit}return!1}});return k("buildspace.apps.ProjectManagement.ClaimUpdateDialog",
dijit.Dialog,{style:"padding:0;margin:0;",scheduleTaskItemBillItem:null,tagBillItemGrid:null,type:null,buildRendering:function(){var c=this.createContent();c.startup();this.content=c;this.inherited(arguments)},postCreate:function(){n.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(c){c.keyCode==l.ESCAPE&&dojo.stopEvent(c)},onHide:function(){this.destroyRecursive()},createContent:function(){var c=new dijit.layout.BorderContainer({style:"padding:0;margin:0;width:480px;height:280px;",
gutters:!1}),d=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;border-bottom:none;"});d.addChild(new dijit.form.Button({label:g.close,iconClass:"icon-16-container icon-16-close",style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));c.addChild(d);var d=new q,e=function(a,b,c){a=this.grid.getItem(b);b="&nbsp;";if(a.hasOwnProperty("value")&&0<a.id){var d=h.parse(a.value[0]);b=isNaN(d)||0==d||null==d?"&nbsp;":m.format(d);b=0<=d?b:'<span style="color:#FF0000">'+
b+"</span>";a.id==buildspace.constants.GRID_LAST_ROW&&(c.customClasses.push("disable-cell"),b="&nbsp;")}return b},f=function(a,b,c){a=this.grid.getItem(b);b="&nbsp;";a&&a.hasOwnProperty("type")&&1>a.type&&c.customClasses.push("invalidTypeItemCell");if(a.hasOwnProperty("value")&&0<a.id){b=h.parse(a.value[0]);if(isNaN(b)||0==b||null==b)b="&nbsp;";else{var d=h.format(b,{places:2})+"%";b=0<=b?'<span style="color:blue;">'+d+"</span>":'<span style="color:#FF0000">'+d+"</span>"}a.id==buildspace.constants.GRID_LAST_ROW&&
(c.customClasses.push("disable-cell"),b="&nbsp;")}return b};c.addChild(t({region:"center",scheduleTaskItemBillItem:this.scheduleTaskItemBillItem,tagBillItemGrid:this.tagBillItemGrid,type:this.type,store:dojo.data.ItemFileWriteStore({url:"projectManagement/getTaggedUnitList/id/"+this.scheduleTaskItemBillItem.id+"/t/"+("up_to_date_claim_percentage"==this.type?"p":"a"),clearOnClose:!0}),structure:[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:d.rowCountCellFormatter},{name:g.description,
field:"description",width:"auto",formatter:d.typeListTreeCellFormatter},{field:"value",name:"up_to_date_claim_percentage"==this.type?"%":g.amount,width:"up_to_date_claim_percentage"==this.type?"70px":"120px",styles:"text-align:right;",editable:!0,cellType:"buildspace.widget.grid.cells.Textarea",formatter:"up_to_date_claim_percentage"==this.type?f:e}]}));return c}})});
