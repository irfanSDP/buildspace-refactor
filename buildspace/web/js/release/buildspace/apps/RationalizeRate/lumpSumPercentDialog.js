define("buildspace/apps/RationalizeRate/lumpSumPercentDialog","dojo/_base/declare dojo/_base/lang dojo/when dojo/html dojo/dom dojo/keys dojo/dom-style dijit/form/Form dijit/form/CurrencyTextBox dijit/form/NumberTextBox dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/lumpSumPercentForm.html dojo/currency dojo/number dojo/i18n!buildspace/nls/RationalizeRate".split(" "),function(h,w,x,y,z,m,n,k,A,B,p,q,r,t,u,C,l,d){k=h("buildspace.apps.RationalizeRate.LumpSumPercentForm",
[p,q,r,t],{templateString:u,baseClass:"buildspace-form",style:"outline:none;",itemObj:null,nls:d,companyId:null,projectId:null,billGridStore:null,elementGridStore:null,region:"center",disableEditingMode:!1,constructor:function(a){this.inherited(arguments);this.currencyAbbreviation=buildspace.billCurrencyAbbreviation?buildspace.billCurrencyAbbreviation:buildspace.currencyAbbreviation},postCreate:function(){this.inherited(arguments);var a=this;dojo.connect(this.rateNode,"onKeyUp",function(){a.updateTotal()});
dojo.connect(this.percentageNode,"onKeyUp",function(){a.updateTotal()});this.rateNode.set("readOnly",this.disableEditingMode);this.percentageNode.set("readOnly",this.disableEditingMode)},startup:function(){this.inherited(arguments);var a=this,b=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."}),c={url:"viewTenderer/lumpSumPercentageForm",handleAs:"json",content:{id:this.itemObj.id,cid:this.companyId,pid:this.projectId},load:function(f){a.lumpSumPercentageForm.setFormValues(f);
b.hide()},error:function(f){b.hide()}};b.show().then(function(){dojo.xhrGet(c)})},submit:function(a){var b=buildspace.dialog.indeterminateProgressBar({title:d.savingData+"..."}),c=this.billGridStore,f=this.itemObj,v={url:"viewTenderer/lumpSumPercentageUpdate",content:dojo.formToObject(this.lumpSumPercentageForm.id),handleAs:"json",load:function(e){if(e.success){e=e.data;for(var g in e)f.hasOwnProperty(g)&&g!=c._getIdentifierAttribute()&&c.setValue(f,g,e[g]);c.save();b.hide();a.hide()}},error:function(e){b.hide();
a.hide()}};this.lumpSumPercentageForm.validate()&&b.show().then(function(){dojo.xhrPost(v)})},updateTotal:function(){var a=isNaN(this.rateNode.get("value"))?0:this.rateNode.get("value"),b=isNaN(this.percentageNode.get("value"))?0:this.percentageNode.get("value");a=l.parse(a)*(l.parse(b)/100);this.amountNode.set("value",a)}});return h("buildspace.apps.RationalizeRate.LumpSumPercentDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",title:d.lumpSumPercentage,itemObj:null,companyId:null,billGridStore:null,
rootProject:null,elementGridStore:null,currentBillLockedStatus:!1,disableEditingMode:!1,constructor:function(a){a.currentBillLockedStatus&&(this.disableEditingMode=!0)},buildRendering:function(){var a=this.createContent();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){n.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(a){key=a.keyCode;key==m.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},
createContent:function(){var a=new dijit.layout.BorderContainer({style:"padding:0px;width:400px;height:150px;",gutters:!1}),b=new k({itemObj:this.itemObj,companyId:this.companyId,projectId:this.rootProject.id,billGridStore:this.billGridStore,elementGridStore:this.elementGridStore,disableEditingMode:this.disableEditingMode}),c=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});c.addChild(new dijit.form.Button({label:d.save,iconClass:"icon-16-container icon-16-save",
style:"outline:none!important;",onClick:dojo.hitch(b,"submit",this),disabled:this.disableEditingMode}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({label:d.close,iconClass:"icon-16-container icon-16-close",style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));a.addChild(c);a.addChild(b);return a}})});
