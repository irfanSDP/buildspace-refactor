define("buildspace/apps/Location/ProjectLocationManagement/_base","dojo/_base/declare dojo/aspect ./LocationAssignment/LocationAssignmentContainer ./BQLocation/BQLocationContainer ./BillSettings/BillSettingsContainer ./ProgressClaim/ProgressClaimContainer buildspace/apps/ProjectBuilder/Builder buildspace/apps/Tendering/Builder buildspace/apps/PostContract/Builder dojo/i18n!buildspace/nls/Location".split(" "),function(h,t,k,l,m,n,p,q,r,d){return h("buildspace.apps.ProjectLocationManagement",buildspace.apps._App,
{type:null,win:null,project:null,locationAssignmentContainer:null,canEdit:!0,init:function(a){var b=this.project=a.project;this.type=a.type;this.canEdit=a.canEdit;a=this.getModuleTitle();this.win=new buildspace.widget.Window({title:a+" > "+d.locationManagement+" - "+buildspace.truncateString(b.title,100),onClose:dojo.hitch(this,"kill")});b=this.createMainTab();b.startup();this.win.addChild(b);this.win.show();this.win.startup()},createMainTab:function(){var a=new k({title:d.locationAssignment,project:this.project,
baseApp:this}),b=new l({id:this.project.id+"-bqLocationContainer",title:d.bqLocationsView,project:this.project,baseApp:this}),c=new dijit.Toolbar({region:"top",style:"border-top:none;border-left:none;border-right:none;padding:2px;width:100%;"});c.addChild(new dijit.form.Button({label:d.backTo+" "+this.getModuleTitle(),iconClass:"icon-16-container icon-16-directional_left",style:"outline:none!important;",onClick:dojo.hitch(this,"openBuilderWin",this.project)}));var e=this.tabContainer=new dijit.layout.TabContainer({style:"padding:0px;margin:0px;border:0px;width:100%;height:100%;"});
parseInt(this.project.status_id)==buildspace.constants.STATUS_POSTCONTRACT&&(c.addChild(new dijit.ToolbarSeparator),c.addChild(new dijit.form.Button({label:d.progressClaims,iconClass:"icon-16-container icon-16-list",style:"outline:none!important;",onClick:dojo.hitch(this,"openTabByType",e,"progressClaimContainer")})));this.canEdit&&(c.addChild(new dijit.ToolbarSeparator),c.addChild(new dijit.form.Button({label:d.billSettings,iconClass:"icon-16-container icon-16-gear",style:"outline:none!important;",
onClick:dojo.hitch(this,"openTabByType",e,"billSettingsContainer")})),c.addChild(new dijit.ToolbarSeparator),c.addChild(new dijit.form.Button({label:d.save,iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(a,"save")})));a.addChild(c);e.addChild(a);e.addChild(b);return e},resetBQLocationTab:function(a){a=this.tabContainer.getChildren();var b;for(b in a)if(a[b].id==this.project.id+"-bqLocationContainer"){var c=a[b];break}c&&dojo.xhrGet({url:"location/getLocationCodeLevels",
handleAs:"json",preventCache:!0,content:{pid:this.project.id},load:function(a){c.renderContent(a)},error:function(a){}})},openTabByType:function(a,b){var c=!1,e=a.getChildren(),g;for(g in e)if(e[g].id==this.project.id+"-"+b){c=!0;a.selectChild(e[g]);break}if(!c){switch(b){case "progressClaimContainer":var f=new n({id:this.project.id+"-"+b,title:d.progressClaims,closable:!0,project:this.project,baseApp:this});break;case "billSettingsContainer":f=new m({id:this.project.id+"-"+b,title:d.billSettings,
closable:!0,project:this.project,baseApp:this})}f&&(a.addChild(f),a.selectChild(f))}},openBuilderWin:function(a){this.kill();this.project=a;var b=this.getModuleTitle();this.win=new buildspace.widget.Window({title:b+" > "+buildspace.truncateString(a.title,100)+" ("+d.status+"::"+a.status[0].toUpperCase()+")",onClose:dojo.hitch(this,"kill")});switch(this.type){case buildspace.constants.STATUS_PRETENDER:a=p({project:a});break;case buildspace.constants.STATUS_TENDERING:a=q({project:a});break;default:a=
r({project:a})}this.win.addChild(a);this.win.show();this.win.startup()},getModuleTitle:function(){switch(this.type){case buildspace.constants.STATUS_PRETENDER:var a=d.ProjectBuilder;break;case buildspace.constants.STATUS_TENDERING:a=d.tendering;break;default:a=d.postContract}return a},kill:function(){"undefined"!=typeof this.win&&this.win.close()}})});
