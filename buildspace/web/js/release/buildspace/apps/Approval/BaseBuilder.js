define("buildspace/apps/Approval/BaseBuilder",["dojo/_base/declare","dojo/_base/lang","dojo/i18n!buildspace/nls/Approval"],function(h,f,b){return h("buildspace.apps.Approval.Builder",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;",gutters:!1,project:null,viewArea:null,url:null,data:null,postCreate:function(){this.inherited(arguments);var a=this,c=new dijit.Toolbar({region:"top",style:"padding:2px;width:100%;"});c.addChild(new dijit.form.Button({label:b.approve,id:"approve-button",
iconClass:"icon-16-container icon-16-container icon-16-hand_thumbsup",onClick:dojo.hitch(a,"approve")}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({label:b.reject,id:"reject-button",iconClass:"icon-16-container icon-16-container icon-16-hand_thumbsdown",onClick:dojo.hitch(a,"reject")}));var d=buildspace.dialog.indeterminateProgressBar({title:b.processing+"..."});d.show().then(function(){dojo.xhrPost({url:"default/getCsrfToken",handleAs:"json",load:function(b){a.xhrPostData=
{project_id:a.project.id,module_identifier:a.object.module_identifier,"form[_csrf_token]":b._csrf_token};a.object.id&&(a.xhrPostData.object_id=a.object.id)}}).then(function(){var b=a.viewArea=a.initViewArea();b.startup();a.addChild(c);a.addChild(b);d.hide()})})},initViewArea:function(){},refreshViewArea:function(){this.viewArea.destroyRecursive();var a=this.viewArea=this.initViewArea();a.startup();this.addChild(a)},approve:function(){var a=this,c=buildspace.dialog.indeterminateProgressBar({title:b.processing+
"..."});buildspace.dialog.confirmWithInput(b.confirm,"<div>"+b.confirmApprove+"</div>",180,360,function(d){c.show().then(function(){var e=a.xhrPostData;f.mixin(e,{approve:!0,remarks:d});dojo.xhrPost({url:a.url,content:e,handleAs:"json",load:function(g){g.errors?buildspace.dialog.alert(b.alert,"<div>"+g.errors+"</div>",90,360,function(){}):(a.refreshViewArea(),a.disableToolbarButtons());c.hide()},error:function(a){c.hide()}})})},function(){},b.addRemarks)},reject:function(){var a=this,c=buildspace.dialog.indeterminateProgressBar({title:b.processing+
"..."});buildspace.dialog.confirmWithInput(b.confirm,"<div>"+b.confirmReject+"</div>",180,360,function(d){c.show().then(function(){var e=a.xhrPostData;f.mixin(e,{approve:!1,remarks:d});dojo.xhrPost({url:a.url,content:e,handleAs:"json",load:function(d){d.success?a.disableToolbarButtons():buildspace.dialog.alert(b.alert,"<div>"+d.errors+"</div>",90,360,function(){});c.hide()},error:function(a){c.hide()}})})},function(){},b.addRemarks)},disableToolbarButtons:function(){dijit.byId("approve-button")._setDisabledAttr(!0);
dijit.byId("reject-button")._setDisabledAttr(!0)}})});
