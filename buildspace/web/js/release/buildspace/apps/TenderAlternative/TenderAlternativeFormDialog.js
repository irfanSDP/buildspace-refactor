define("buildspace/apps/TenderAlternative/TenderAlternativeFormDialog","dojo/_base/declare dojo/html dojo/dom dojo/keys dojo/dom-style dojo/on dijit/form/Form dijit/form/ValidationTextBox dijit/form/Textarea dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/tenderAlternativeForm.html dojo/i18n!buildspace/nls/TenderAlternative".split(" "),function(g,k,l,m,n,w,x,y,z,p,q,r,t,u,e){var v=g("buildspace.apps.TenderAlternative.TenderAlternativeFormWidget",
[p,q,r,t],{templateString:u,baseClass:"buildspace-form",region:"center",dialogObj:null,project:null,projectBreakdownGrid:null,tenderAlternativeId:-1,nls:e,style:"padding:5px;overflow:auto;",startup:function(){this.inherited(arguments);var a=this,b=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});b.show().then(function(){dojo.xhrGet({url:"tenderAlternative/tenderAlternativeForm",handleAs:"json",content:{id:a.tenderAlternativeId,pid:a.project.id},load:function(c){a.tenderAlternativeForm.setFormValues(c);
b.hide()},error:function(c){b.hide()}})})},postCreate:function(){this.inherited(arguments)},save:function(){if(this.tenderAlternativeForm.validate()){var a=buildspace.dialog.indeterminateProgressBar({title:e.savingData+"..."}),b=this,c=dojo.formToObject(this.tenderAlternativeForm.id);a.show().then(function(){dojo.xhrPost({url:"tenderAlternative/tenderAlternativeUpdate",content:c,handleAs:"json",load:function(d){dojo.query('[id^="error-tender_alternative_"]').forEach(function(f){f.innerHTML=""});if(d.success){if(d.item.rebuild_breakdown_grid)dojo.xhrGet({url:"getTenderAlternativeProject/"+
String(b.project.id),handleAs:"json"}).then(function(f){f=b.projectBreakdownGrid.workArea.createProjectBreakdownTab(f,!1);b.projectBreakdownGrid=f.grid});else if(d=dijit.byId("main-project_breakdown"))b.projectBreakdownGrid=d.grid,b.projectBreakdownGrid.reload();b.tenderAlternativeId&&0<parseInt(b.tenderAlternativeId)&&(d=dijit.byId(String(b.project.id)+"-"+b.tenderAlternativeId+"-tenderAlternative-billListGrid"))&&d.reload();b.close()}else for(var h in d.errors)k.set(l.byId("error-tender_alternative_"+
h),d.errors[h]);a.hide()},error:function(d){a.hide()}})})}},close:function(){this.projectBreakdownGrid.workArea.initTab({id:this.project.id,type:1337},{projectBreakdownGrid:this.projectBreakdownGrid,project:this.project,editable:!0},!1);var a=dijit.byId(String(this.project.id)+"-tenderAlternative-tenderAlternativeListGrid");a&&a.reload();this.dialogObj&&this.dialogObj.hide()},onCancel:function(){}});return g("buildspace.apps.TenderAlternative.TenderAlternativeFormDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",
project:null,projectBreakdownGrid:null,tenderAlternativeId:-1,title:e.createNewTenderAlternative,buildRendering:function(){var a=this.createForm();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){n.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(a){a.keyCode==m.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},createForm:function(){var a=new dijit.layout.BorderContainer({style:"padding:0px;width:580px;height:240px;",
gutters:!1}),b=new v({dialogObj:this,project:this.project,projectBreakdownGrid:this.projectBreakdownGrid,tenderAlternativeId:this.tenderAlternativeId}),c=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});c.addChild(new dijit.form.Button({label:e.save,iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(b,"save")}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({label:e.close,iconClass:"icon-16-container icon-16-close",
style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));a.addChild(c);a.addChild(b);return a}})});
