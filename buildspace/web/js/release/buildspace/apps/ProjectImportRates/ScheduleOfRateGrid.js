define("buildspace/apps/ProjectImportRates/ScheduleOfRateGrid",["dojo/_base/declare","dojo/i18n!buildspace/nls/ProjectImportRates"],function(m,c){return m("buildspace.apps.ProjectImportRates.ScheduleOfRateGrid",dojox.grid.EnhancedGrid,{type:null,style:"border-top:none;",rowSelector:"0px",region:"center",canSort:function(e){return!1},postCreate:function(){var e=this;this.inherited(arguments);if("item"==this.type)this.on("RowClick",function(a){var d=a.cell.field;a=this.getItem(a.rowIndex);"import_rate"==
d&&0<parseInt(String(a.id))&&null!==String(a.description)&&null!==String(a["rate-value"])&&parseInt(String(a.type))!=buildspace.widget.grid.constants.HIERARCHY_TYPE_HEADER&&parseInt(String(a.type))!=buildspace.widget.grid.constants.HIERARCHY_TYPE_HEADER_N&&parseInt(String(a.type))!=buildspace.widget.grid.constants.HIERARCHY_TYPE_NOID&&void 0!=a.recalculate_resources_library_status&&!a.recalculate_resources_library_status[0]&&e.importRates(a)},!0)},importRates:function(e){var a=dijit.byId("project_bill_item-grid");
if("undefined"==typeof a)buildspace.dialog.alert(c.noBillItemAlert,c.pleaseOpenBillItem+".",90,320);else if(0<a.selection.getSelected().length){var d=[];dojo.forEach(a.selection.getSelected(),function(b){b&&0<parseInt(String(b.id))&&parseInt(String(b.type))!=buildspace.widget.grid.constants.HIERARCHY_TYPE_HEADER&&parseInt(String(b.type))!=buildspace.widget.grid.constants.HIERARCHY_TYPE_HEADER_N&&parseInt(String(b.type))!=buildspace.widget.grid.constants.HIERARCHY_TYPE_NOID&&parseInt(String(b.type))!=
buildspace.widget.grid.constants.HIERARCHY_TYPE_ITEM_PC_RATE&&d.push(parseInt(String(b.id)))});if(0<d.length&&a.element){var h=buildspace.dialog.indeterminateProgressBar({title:c.savingData+". "+c.pleaseWait+"..."});h.show().then(function(){dojo.xhrPost({url:"billManagerImportRate/import",content:{element_id:parseInt(String(a.element.id)),schedule_of_rate_id:parseInt(String(e.id)),_csrf_token:a.element._csrf_token,ids:d.toString()},handleAs:"json",load:function(b){if(b.success){var f=a.store;dojo.forEach(b.items,
function(k){f.fetchItemByIdentity({identity:k.id,onItem:function(l){for(var g in k)l.hasOwnProperty(g)&&g!=f._getIdentifierAttribute()&&f.setValue(l,g,k[g])}})});f.save()}h.hide();a.selection.clear()},error:function(b){h.hide();a.selection.clear()}})})}else a.selection.clear()}else buildspace.dialog.alert(c.noItemSelectedAlert,c.pleaseSelectItem+".",90,320)}})});
