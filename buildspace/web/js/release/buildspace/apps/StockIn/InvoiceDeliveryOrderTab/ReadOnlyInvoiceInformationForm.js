(function(){define("buildspace/apps/StockIn/InvoiceDeliveryOrderTab/ReadOnlyInvoiceInformationForm","dojo/_base/declare dojo/_base/lang dojo/on dojo/keys dojo/parser dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Toolbar dijit/form/Button dijit/layout/BorderContainer dijit/form/ValidationTextBox dijit/form/DateTextBox dojo/dom-construct dojo/dom-style dojo/dom-attr dojo/dom-form dojo/request dojox/validate/web dijit/form/FilteringSelect dojo/store/Memory dojox/form/Manager dojo/text!./templates/readOnlyInvoiceForm.html dojo/i18n!../../../nls/StockIn".split(" "),
function(k,v,h,w,x,m,n,p,q,y,z,r,A,B,f,g,C,D,t,E,F,G,H,u,e){var l;l=k("buildspace.apps.StockIn.InvoiceInformation.ReadOnlyInvoiceForm",[m,n,p,q],{baseClass:"buildspace-form",templateString:u,region:"center",style:"overflow: auto;",formInfo:null,nls:e,invoiceId:-1,startup:function(){this.inherited(arguments);this.createUploader();if(this.formInfo.attachmentDownloadLink)return this.showDownloadLink(this.formInfo.attachmentDownloadFileName,this.formInfo.attachmentDownloadLink),this.showRemoveLink(this.formInfo.attachmentRemoveLink)},
showDownloadLink:function(a,b){var c,d;d=this["invoiceFileDownloadLink-"+this.invoiceId];g.set(d,"display","block");c=dojo.create("a",{href:b,innerHTML:"Download",download:a});f.empty(d);return f.place(c,d)},hideDownloadLink:function(){return g.set(this["invoiceFileDownloadLink-"+this.invoiceId],"display","none")},showRemoveLink:function(a,b){var c,d;null==b&&(b=this);d=this["invoiceFileRemoveLink-"+this.invoiceId];g.set(d,"display","block");c=dojo.create("a",{href:"#",innerHTML:"Remove"});f.empty(d);
f.place(c,d);return h(c,"click",function(d){var c;c=new buildspace.dialog.indeterminateProgressBar({title:e.processing+"..."});c.show();return t.get(a,{handleAs:"json"}).then(function(a){c.hide();if(a.success)return b.hideDownloadLink(),b.hideRemoveLink()},function(a){return c.hide()})})},hideRemoveLink:function(){return g.set(this["invoiceFileRemoveLink-"+this.invoiceId],"display","none")},createUploader:function(){var a;a=this;this.uploader=new dojox.form.Uploader({label:e.uploadFile,uploadOnSelect:!0,
style:"height:24px;",url:"stockIn/uploadFileForInvoice/invoiceId/"+a.invoiceId+"/_csrf_token/"+this.formInfo["stock_in_invoice[_csrf_token]"],name:"stock_in_invoice[fileUpload]"});h(this.uploader,"Begin",function(b){a.pb=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});return a.pb.show()});h(this.uploader,"Complete",function(b){a.pb.hide();return b.success?(a.showDownloadLink(b.attachmentDownloadFileName,b.attachmentDownloadLink),a.showRemoveLink(b.attachmentRemoveLink)):buildspace.dialog.alert(e.error,
"<div>"+b.errorMsg+"</div>",80,280)});this["invoiceFileUploadContainer-"+a.invoiceId].appendChild(this.uploader.domNode);return this.uploader.startup()}});return k("buildspace.apps.StockIn.InvoiceInformation.ReadOnlyInvoiceFormContainer",r,{style:"padding:0;margin:0;",gutters:!1,invoiceId:-1,formInfo:null,postCreate:function(){var a;this.inherited(arguments);a=new l({invoiceId:this.invoiceId,formInfo:this.formInfo});return this.addChild(a)}})})}).call(this);
