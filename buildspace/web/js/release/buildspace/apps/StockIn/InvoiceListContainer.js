(function(){define("buildspace/apps/StockIn/InvoiceListContainer","dojo/_base/declare dojo/_base/lang dojo/request dijit/focus dijit/Toolbar dijit/form/Button dijit/DropDownMenu dijit/form/DropDownButton dijit/MenuItem dijit/layout/BorderContainer buildspace/widget/grid/cells/Formatter buildspace/widget/grid/Filter ./InvoiceFormDialog ./InvoiceDeliveryOrderTab/MasterTabContainer dojo/i18n!../../nls/StockIn".split(" "),function(f,v,l,g,m,h,w,x,y,n,p,q,r,t,b){var u=f("buildspace.apps.StockIn.InvoiceListGrid",
dojox.grid.EnhancedGrid,{style:"border-top:none;",rowSelector:"0px",region:"center",workArea:null,project:null,canSort:function(a){return!1},postCreate:function(){this.inherited(arguments);return this.on("RowClick",function(a){return(a=this.getItem(a.rowIndex))&&0<a.id[0]?this.disableToolbarButtons(!1):this.disableToolbarButtons(!0)})},deleteRow:function(a){var c,d,e,k;e=this;c=this.getItem(a);d=buildspace.dialog.indeterminateProgressBar({title:b.deleting+". "+b.pleaseWait+"..."});g.curNode.blur();
g.curNode=null;d.show();k={url:"stockIn/deleteInvoice",content:{invoiceId:c.id,_csrf_token:c._csrf_token},handleAs:"json",load:function(b){if(b.success){if(b=dijit.byId("main-invoiceInformation-"+c.id[0]))e.workArea.removeChild(b),b.destroy();e.refreshGrid();d.hide();e.selection.clear();return window.setTimeout(function(){return e.focus.setFocusIndex(a,0)},10)}},error:function(a){e.selection.clear();return d.hide()}};return new buildspace.dialog.confirm(b.deleteInvoiceDialogBoxTitle,b.deleteInvoiceDialogBoxMsg,
80,320,function(){return dojo.xhrPost(k)},function(){return d.hide()})},disableToolbarButtons:function(a){var b=dijit.byId("deleteInvoiceListFromStockIn");b&&b.set("disabled",a)},refreshGrid:function(){this.store.save();this.store.close();return this.setStore(this.store)}});return f("buildspace.apps.StockIn.InvoiceListContainer",n,{workArea:null,project:null,store:null,style:"height:100%;width:100%;padding:0;margin:0;",gutters:!1,postCreate:function(){var a,c,d,e;this.inherited(arguments);d=this;
(a=dijit.byId("StockInInvoiceListMaintenance-stackContainer"))&&dijit.byId("StockInInvoiceListMaintenance-stackContainer").destroyRecursive();a=d.stackContainer=new dijit.layout.StackContainer({style:"width:100%;height:100%;",region:"center",id:"StockInInvoiceListMaintenance-stackContainer"});a=new dojo.data.ItemFileWriteStore({url:"stockIn/getStockInInvoiceList/pId/"+d.project.id,clearOnClose:!0,urlPreventCache:!0});c=this.grid=new u({workArea:d.workArea,structure:d.getGridLayout(),store:a,pId:this.project.id,
escapeHTMLInData:!1,onRowDblClick:function(a){var b,c;a=this.getItem(a.rowIndex);if(0>a.id[0])return!1;b="main-invoiceInformation-"+a.id[0];return(c=dijit.byId(b))?d.workArea.selectChild(c):d.workArea.createContentPaneTab(b,a.invoice_no[0],d.createInvoiceAndDeliveryOrderTabContent(a),!0)}});e=new m({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;border-bottom:none;"});e.addChild(new h({label:b.addNewInvoice,iconClass:"icon-16-container icon-16-add",onClick:function(){return d.showAddNewInvoiceDialog()}}));
e.addChild(new dijit.ToolbarSeparator);e.addChild(new h({label:b["delete"],id:"deleteInvoiceListFromStockIn",iconClass:"icon-16-container icon-16-delete",disabled:!0,onClick:function(){return c.deleteRow(c.selection.selectedIndex)}}));a=new q({region:"top",grid:c,editableGrid:!1,filterFields:[{invoice_no:b.invoiceNo},{selected_po:b.selected_po},{supplier_name:b.supplier},{created_by:b.created_by}]});this.addChild(a);this.addChild(e);return this.addChild(c)},showAddNewInvoiceDialog:function(a){var c;
null==a&&(a=this);c=new buildspace.dialog.indeterminateProgressBar({title:b.processing+"..."});c.show();return l.get("stockIn/getInvoiceFormInformation",{query:{pId:a.project.id},handleAs:"json"}).then(function(b){(new r({invoiceGridContainer:a.grid,project:a.project,formInfo:b.formInformation,poDropDown:b.poDropDown,termDropDown:b.termDropDown})).show();return c.hide()},function(a){return c.hide()})},createInvoiceAndDeliveryOrderTabContent:function(a){return new t({id:"stock-in-master-tabcontainer-"+
a.id[0],project:this.project,invoice:a})},getGridLayout:function(){var a=new p;return[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:a.rowCountCellFormatter,noresize:!0,filterable:!1},{name:b.invoiceNo,field:"invoice_no",styles:"text-align: center; color: red;",width:"140px",noresize:!0},{name:b.selected_po,field:"selected_po",styles:"text-align: center; color: red;",width:"140px",noresize:!0},{name:b.supplier,field:"supplier_name",styles:"text-align: center;",width:"auto",
noresize:!0},{name:b.invoiceTotal,field:"invoice_total",styles:"text-align:right;",width:"120px",formatter:a.unEditableCurrencyCellFormatter,noresize:!0},{name:b.created_by,field:"created_by",styles:"text-align:center;",width:"140px",noresize:!0},{name:b.created_at,field:"invoice_date",styles:"text-align:center;",width:"100px",noresize:!0,filterable:!1}]}})})}).call(this);
