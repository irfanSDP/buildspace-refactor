(function(){define("buildspace/apps/RequestForQuotation/SupplierList/SupplierCompanyInformationDialog","dojo/_base/declare dojo/_base/lang dojo/keys dojo/parser dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/Toolbar dijit/form/Button dijit/layout/BorderContainer dijit/form/ValidationTextBox dijit/form/SimpleTextarea dijit/registry dojo/dom-style dojo/dom-form dojo/request dojox/validate/web dijit/form/Select dijit/form/FilteringSelect dojo/store/Memory dojox/form/Manager dojo/text!./templates/companyForm.html dojo/i18n!../../../nls/CompanyDirectories".split(" "),
function(k,l,p,C,q,r,t,u,v,w,x,D,E,F,h,G,y,H,z,m,A,I,B,e){var n;n=k("buildspace.apps.RequestForQuotation.SupplierList.SupplierCompanyInformationForm",[q,r,t,u],{baseClass:"buildspace-form",rfqId:-1,companyId:-1,newCompanyId:-1,templateString:B,region:"center",style:"overflow: auto;",formInfo:null,businessTypeSelections:null,nls:e,dialogContainer:null,supplierSelectionGridDialog:null,supplierListContainer:null,postCreate:function(){this.inherited(arguments);return this.createDropdown()},startup:function(){this.inherited(arguments);
return this["companyForm-"+this.companyId].setFormValues(this.formInfo)},createDropdown:function(){var a,b,c;b=this;a=new A({idProperty:"id",data:b.businessTypeSelections});a=(new z({name:"company[company_business_type_id]",store:a,labelAttr:"name",maxHeight:-1,style:"width: 180px;padding:2px!important;",selected:b.formInfo["company[company_business_type_id]"]})).placeAt(b.businessTypeSelection);a=new dojo.data.ItemFileReadStore({url:"projectBuilder/getCountry"});this.stateSelectStore=c=new dojo.data.ItemFileReadStore({url:"projectBuilder/getStateByCountry/regionId/"+
b.formInfo["company[region_id]"]});this.countrySelect=(new m({name:"company[region_id]",store:a,style:"width: 180px;padding:2px;",searchAttr:"name",value:b.formInfo["company[region_id]"],required:!0,onChange:function(a){a?b.stateSelect.set("readOnly",!1):b.stateSelect.set("readOnly",!0);return b.updateStateSelectStore(a)}})).placeAt(b.countrySelectDivNode);return this.stateSelect=(new m({name:"company[sub_region_id]",store:c,style:"width: 180px;padding:2px;",searchAttr:"name",readOnly:0<b.formInfo["company[sub_region_id]"]?
!1:!0,value:b.formInfo["company[sub_region_id]"],required:!0})).placeAt(b.stateSelectDivNode)},updateStateSelectStore:function(a){null==a&&(a=0);a||(a=0);this.stateSelectStore=new dojo.data.ItemFileReadStore({url:"projectBuilder/getStateByCountry/regionId/"+a,clearOnClose:!0});this.stateSelect.store.close();this.stateSelect.set("store",this.stateSelectStore);return this.stateSelect.set("value","")},clearInputErrorMsgs:function(){var a,b,c,d;c={name:null,registration_no:null,about:null,contact_person_name:null,
contact_person_email:null,contact_person_direct_line:null,contact_person_mobile:null,phone_number:null,fax_number:null,address:null,postcode:null,website:null};d=[];for(b in c)a=this["error-"+b],a.innerHTML=c[b],d.push(h.set(a,"display","none"));return d},save:function(){var a,b,c;c=this;this.clearInputErrorMsgs();if(!this["companyForm-"+this.companyId].validate())return!1;a=dojo.formToObject(this["companyForm-"+this.companyId].id);b=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+
"..."});0<c.newCompanyId?l.mixin(a,{companyId:c.newCompanyId}):l.mixin(a,{companyId:c.companyId});b.show();return y.post("companyDirectories/updateCompanyInformation/rfqId/"+c.rfqId,{data:a,handleAs:"json"}).then(function(a){var d,f,g;b.hide();if(a.success&&0<a.id)return c.newCompanyId=a.id,-1===c.companyId&&(c.supplierListContainer.grid.refreshGrid(),c.dialogContainer.hide(),c.supplierSelectionGridDialog.hide()),c.dialogContainer.set("title",e.edit+" ("+a.companyName+")");g=[];for(f in a.errorMsgs)"username"!==
f?(d=c["error-"+f],d.innerHTML=a.errorMsgs[f],g.push(h.set(d,"display","block"))):g.push(void 0);return g},function(a){return b.hide()})}});return k("buildspace.apps.CompanyDirectories.CompanyDirectoriesDialog",dijit.Dialog,{title:e.add,style:"padding:0px;margin:0px;",rfqId:-1,companyId:-1,supplierSelectionGridDialog:null,supplierListContainer:null,formInfo:null,businessTypeSelections:null,buildRendering:function(){var a;this.content=a=this.createContent();a.startup();return this.inherited(arguments)},
postCreate:function(){h.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";return this.inherited(arguments)},createContent:function(){var a,b,c,d;c=this;a=new x({style:"width:650px;height:400px;padding:0;margin:0;",gutters:!1});b=new n({rfqId:c.rfqId,companyId:this.companyId,formInfo:this.formInfo,dialogContainer:c,supplierSelectionGridDialog:this.supplierSelectionGridDialog,supplierListContainer:this.supplierListContainer,businessTypeSelections:this.businessTypeSelections});
d=new v({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});d.addChild(new w({label:e.save,iconClass:"icon-16-container icon-16-save",onClick:function(){return b.save()}}));d.addChild(new dijit.ToolbarSeparator);d.addChild(new dijit.form.Button({label:e.close,iconClass:"icon-16-container icon-16-close",onClick:function(){return c.hide()}}));a.addChild(d);a.addChild(b);return a},_onKey:function(a){if(a.keyCode===p.ESCAPE)return dojo.stopEvent(a)},onHide:function(){return this.destroyRecursive()}})})}).call(this);
