define("buildspace/apps/ProjectAnalyzer/plugins/TotalPane","dojo/_base/kernel dojo/_base/declare dojo/_base/array dojo/_base/connect dojo/currency dojo/number dojo/_base/lang dojo/_base/html dojo/text!./templates/TotalPane.html dojox/grid/enhanced/_Plugin dojox/grid/EnhancedGrid dijit/_Widget dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojox/html/metrics dojo/i18n!buildspace/nls/ProjectAnalyzer".split(" "),function(g,h,l,y,p,q,e,d,r,t,u,v,w,z,x,A){var n=h("buildspace.apps.ProjectAnalyzer.ResourceEnhancedGrid.plugins._TotalPane",
[v,w],{templateString:r,constructor:function(b){e.mixin(this,b);this.grid=this.plugin.grid;this.sumTotalCost=this.sumTotalQty=0;this.currencyAbbreviation=buildspace.currencyAbbreviation},postCreate:function(){this.inherited(arguments);var b=this,c=this.grid;this.plugin.connect(c,"_resize",e.hitch(this,"_resetGridHeight"));this._originalResize=c.resize;c.resize=function(a,d){b._changeSize=a;b._resultSize=d;b._originalResize.apply(c,arguments)};this._placeSelf()},destroy:function(){this.inherited(arguments);
this.grid.resize=this._originalResize},_update:function(){this._updateTotalCost()},_placeSelf:function(){var b=this.grid,c="top"==this.position;this.placeAt(c?b.viewsHeaderNode:b.viewsNode,c?"before":"after")},_resetGridHeight:function(b,c){var a=this.grid;b=b||this._changeSize;c=c||this._resultSize;delete this._changeSize;delete this._resultSize;if(!a._autoHeight){var f=a._getPadBorder().h;this.plugin.gh||(this.plugin.gh=(a.domNode.clientHeight||d.style(a.domNode,"height"))+2*f);c&&(b=c);b&&(this.plugin.gh=
d.contentBox(a.domNode).h+2*f);var e=this.plugin.gh,g=a._getHeaderHeight(),m=d.marginBox(this.domNode).h;if("number"===typeof a.autoHeight)f=e+m-f,d.style(a.domNode,"height",f+"px"),d.style(a.viewsNode,"height",f-m-g+"px");else{var k=e-m-g-f;d.style(a.viewsNode,"height",k+"px");var h=l.some(a.views.views,function(a){return a.hasHScrollbar()});l.forEach(a.viewsNode.childNodes,function(a){d.style(a,"height",k+"px")});l.forEach(a.views.views,function(a){a.scrollboxNode&&(!a.hasHScrollbar()&&h?d.style(a.scrollboxNode,
"height",k-x.getScrollbar().h+"px"):d.style(a.scrollboxNode,"height",k+"px"))})}}},_updateTotalCost:function(){this.totalCostNode&&(dojo.attr(this.totalQtyNode,"innerHTML",q.format(this.sumTotalQty,{places:2})),dojo.attr(this.totalCostNode,"innerHTML",p.format(this.sumTotalCost)))}});g=h("buildspace.apps.ProjectAnalyzer.ResourceEnhancedGrid.plugins.TotalPane",t,{name:"totalPane",position:"bottom",init:function(){var b=this.grid;this._store=b.store;this._totalPane="top"!=this.option.position?new n(e.mixin(this.option,
{position:"bottom",plugin:this})):new n(e.mixin(this.option,{position:"top",plugin:this}));var c=this;this.connect(b.store,"_getItemsFromLoadedData",function(a){c._totalPane.sumTotalQty=a.hasOwnProperty("sum_total_qty")?a.sum_total_qty:0;c._totalPane.sumTotalCost=a.hasOwnProperty("sum_total_cost")?a.sum_total_cost:0;c._totalPane._update()})},destroy:function(){this.inherited(arguments);this._totalPane.destroy();this._nls=this._totalPane=null},_onDelete:function(){this.grid.resize();this.grid._refresh()}});
u.registerPlugin(g);return g});
