define("buildspace/apps/ProjectAnalyzer/ScheduleOfRateGrid",["dojo/_base/declare","dojo/_base/lang","buildspace/widget/grid/plugins/FormulatedColumn","dojo/i18n!buildspace/nls/ProjectAnalyzer"],function(g,h,m,l){var n=g("buildspace.apps.ProjectAnalyzer.ScheduleOfRateEnhancedGrid",dojox.grid.EnhancedGrid,{type:null,style:"border-top:none;",rowSelector:"0px",region:"center",updateUrl:null,project:null,unsorted:!1,isScheduleOfRateItemGrid:!1,canSort:function(b){return!1},postCreate:function(){this.formulatedColumn=
m(this,{});this.inherited(arguments)},canEdit:function(b,d){var c=this;if("editable"==this.type&&void 0!=b){var a=this.getItem(d);if(0>=a.id[0]||a.hasOwnProperty("type")&&(a.type[0]==buildspace.widget.grid.constants.HIERARCHY_TYPE_HEADER||a.type[0]==buildspace.widget.grid.constants.HIERARCHY_TYPE_NOID||1>a.type[0])||a.hasOwnProperty("rate-has_build_up")&&a["rate-has_build_up"][0]&&"rate-value"==b.field){window.setTimeout(function(){c.edit.cancel();c.focus.setFocusIndex(d,b.index)},10);return}if(0<
a.id[0]&&a.hasOwnProperty("rate-has_build_up")&&a["rate-has_build_up"][0]&&"rate"==b.field&&this.isScheduleOfRateItemGrid){window.setTimeout(function(){c.edit.cancel();c.focus.setFocusIndex(d,b.index)},10);return}}return this._canEdit},doApplyCellEdit:function(b,d,c){var a=this,e=a.getItem(d),g=a.store,f=c.replace("-value","");if(b!==e[c][0]){var k=buildspace.dialog.indeterminateProgressBar({title:l.mayTakeAWhile+". "+l.pleaseWait+"..."}),h=function(a,b){for(var c in a)e.hasOwnProperty(c)&&c!=b._getIdentifierAttribute()&&
b.setValue(e,c,a[c]),dojo.forEach(a.affected_nodes,function(a){b.fetchItemByIdentity({identity:a.id,onItem:function(c){for(var d in a)e.hasOwnProperty(d)&&d!=b._getIdentifierAttribute()&&b.setValue(c,d,a[d])}})});b.save()},f={url:this.updateUrl,content:{id:e.id,project_id:a.project.id,unsorted:a.unsorted,attr_name:f,val:b,_csrf_token:e._csrf_token?e._csrf_token:null},handleAs:"json",load:function(b){if(b.success){0<e.id&&h(b.data,g);var f=a.getCellByField(c);window.setTimeout(function(){a.focus.setFocusIndex(d,
f.index)},10);k.hide()}},error:function(a){k.hide();console.log(a)}};k.show();dojo.xhrPost(f)}a.inherited(arguments)},onStyleRow:function(b){this.inherited(arguments);2<=b.node.children[0].children[0].rows.length&&dojo.style(b.node.children[0].children[0].rows[1],"display","none")}});return g("buildspace.apps.ProjectAnalyzer.ScheduleOfRateGrid",dijit.layout.BorderContainer,{stackContainerTitle:"",style:"padding:0px;width:100%;height:100%;",gutters:!1,project:null,gridOpts:{},pageId:0,postCreate:function(){this.inherited(arguments);
h.mixin(this.gridOpts,{project:this.project});var b=this.grid=new n(this.gridOpts);this.addChild(new dijit.layout.ContentPane({style:"width:100%",content:b,region:"center"}));var d=dijit.byId("projectAnalyzer-sor_project_"+this.project.id+"-stackContainer");if(d){var c=document.createElement("div"),c=new dojox.layout.ContentPane({title:buildspace.truncateString(this.stackContainerTitle,60),id:this.pageId,executeScripts:!0,content:this},c);d.addChild(c);h.mixin(c,{grid:b});d.selectChild(this.pageId)}}})});
