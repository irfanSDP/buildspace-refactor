define("buildspace/apps/ProjectAnalyzer/ResourceGrid","dojo/_base/declare dojo/_base/lang buildspace/widget/grid/plugins/FormulatedColumn buildspace/apps/ProjectAnalyzer/plugins/TotalPane buildspace/apps/ProjectAnalyzer/MultiRateAnalyzerDialog dojo/i18n!buildspace/nls/ProjectAnalyzer".split(" "),function(g,h,m,q,n,f){var p=g("buildspace.apps.ProjectAnalyzer.ResourceEnhancedGrid",dojox.grid.EnhancedGrid,{type:null,style:"border-top:none;",rowSelector:"0px",region:"center",updateUrl:null,project:null,
unsorted:!1,canSort:function(b){return!1},postCreate:function(){this.formulatedColumn=m(this,{});this.inherited(arguments)},canEdit:function(b,d){var c=this;if("editable"==this.type&&void 0!=b){var a=this.getItem(d);if(1>a.type||0>=a.id[0]||"rate-value"==b.field&&a.hasOwnProperty("multi-rate")&&a["multi-rate"][0]||"wastage-value"==b.field&&a.hasOwnProperty("multi-wastage")&&a["multi-wastage"][0]||a.hasOwnProperty("type")&&(a.type[0]==buildspace.widget.grid.constants.HIERARCHY_TYPE_HEADER||a.type[0]==
buildspace.widget.grid.constants.HIERARCHY_TYPE_NOID)){("rate-value"==b.field&&a.hasOwnProperty("multi-rate")&&a["multi-rate"][0]||"wastage-value"==b.field&&a.hasOwnProperty("multi-wastage")&&a["multi-wastage"][0])&&n({resourceStore:c.store,resourceId:a.id,projectId:c.project.id,columnName:"rate-value"==b.field?"rate":"wastage",title:("rate-value"==b.field?f.ratesForResource:f.wastageForResource)+" "+a.description}).show();window.setTimeout(function(){c.edit.cancel();c.focus.setFocusIndex(d,b.index)},
10);return}}return this._canEdit},doApplyCellEdit:function(b,d,c){var a=this,e=a.getItem(d),g=a.store,k=c.replace("-value","");if(b!==e[c][0]){var l=buildspace.dialog.indeterminateProgressBar({title:f.mayTakeAWhile+". "+f.pleaseWait+"..."}),h=function(a,b){for(var c in a)e.hasOwnProperty(c)&&c!=b._getIdentifierAttribute()&&b.setValue(e,c,a[c]),dojo.forEach(a.affected_nodes,function(a){b.fetchItemByIdentity({identity:a.id,onItem:function(c){for(var d in a)e.hasOwnProperty(d)&&d!=b._getIdentifierAttribute()&&
b.setValue(c,d,a[d])}})});b.save()},k={url:this.updateUrl,content:{id:e.id,project_id:a.project.id,unsorted:a.unsorted,attr_name:k,val:b,_csrf_token:e._csrf_token?e._csrf_token:null},handleAs:"json",load:function(b){if(b.success){0<e.id&&h(b.data,g);var f=a.getCellByField(c);window.setTimeout(function(){a.focus.setFocusIndex(d,f.index)},10);l.hide()}},error:function(a){l.hide()}};l.show();dojo.xhrPost(k)}a.inherited(arguments)}});return g("buildspace.apps.ProjectAnalyzer.ResourceGrid",dijit.layout.BorderContainer,
{stackContainerTitle:"",style:"padding:0px;width:100%;height:100%;",gutters:!1,project:null,gridOpts:{},pageId:0,postCreate:function(){this.inherited(arguments);h.mixin(this.gridOpts,{project:this.project});var b=this.grid=new p(this.gridOpts);this.addChild(new dijit.layout.ContentPane({style:"width:100%",content:b,region:"center"}));var d=dijit.byId("projectAnalyzer-resource_project_"+this.project.id+"-stackContainer");if(d){var c=document.createElement("div"),c=new dojox.layout.ContentPane({title:buildspace.truncateString(this.stackContainerTitle,
60),id:this.pageId,executeScripts:!0,content:this},c);d.addChild(c);h.mixin(c,{grid:b});d.selectChild(this.pageId)}}})});
