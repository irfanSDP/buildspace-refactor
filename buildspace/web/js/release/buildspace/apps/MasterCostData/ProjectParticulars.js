var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.arrayIteratorImpl=function(a){var e=0;return function(){return e<a.length?{done:!1,value:a[e++]}:{done:!0}}};$jscomp.arrayIterator=function(a){return{next:$jscomp.arrayIteratorImpl(a)}};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.SIMPLE_FROUND_POLYFILL=!1;$jscomp.ISOLATE_POLYFILLS=!1;$jscomp.FORCE_POLYFILL_PROMISE=!1;$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1;
$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,e,d){if(a==Array.prototype||a==Object.prototype)return a;a[e]=d.value;return a};$jscomp.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var e=0;e<a.length;++e){var d=a[e];if(d&&d.Math==Math)return d}throw Error("Cannot find global object");};$jscomp.global=$jscomp.getGlobal(this);
$jscomp.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE;$jscomp.polyfills={};$jscomp.propertyToPolyfillSymbol={};$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(a,e){var d=$jscomp.propertyToPolyfillSymbol[e];if(null==d)return a[e];d=a[d];return void 0!==d?d:a[e]};
$jscomp.polyfill=function(a,e,d,h){e&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(a,e,d,h):$jscomp.polyfillUnisolated(a,e,d,h))};$jscomp.polyfillUnisolated=function(a,e,d,h){d=$jscomp.global;a=a.split(".");for(h=0;h<a.length-1;h++){var l=a[h];if(!(l in d))return;d=d[l]}a=a[a.length-1];h=d[a];e=e(h);e!=h&&null!=e&&$jscomp.defineProperty(d,a,{configurable:!0,writable:!0,value:e})};
$jscomp.polyfillIsolated=function(a,e,d,h){var l=a.split(".");a=1===l.length;h=l[0];h=!a&&h in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var p=0;p<l.length-1;p++){var t=l[p];if(!(t in h))return;h=h[t]}l=l[l.length-1];d=$jscomp.IS_SYMBOL_NATIVE&&"es6"===d?h[l]:null;e=e(d);null!=e&&(a?$jscomp.defineProperty($jscomp.polyfills,l,{configurable:!0,writable:!0,value:e}):e!==d&&(void 0===$jscomp.propertyToPolyfillSymbol[l]&&(d=1E9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[l]=$jscomp.IS_SYMBOL_NATIVE?
$jscomp.global.Symbol(l):$jscomp.POLYFILL_PREFIX+d+"$"+l),$jscomp.defineProperty(h,$jscomp.propertyToPolyfillSymbol[l],{configurable:!0,writable:!0,value:e})))};$jscomp.initSymbol=function(){};
$jscomp.polyfill("Symbol",function(a){if(a)return a;var e=function(p,t){this.$jscomp$symbol$id_=p;$jscomp.defineProperty(this,"description",{configurable:!0,writable:!0,value:t})};e.prototype.toString=function(){return this.$jscomp$symbol$id_};var d="jscomp_symbol_"+(1E9*Math.random()>>>0)+"_",h=0,l=function(p){if(this instanceof l)throw new TypeError("Symbol is not a constructor");return new e(d+(p||"")+"_"+h++,p)};return l},"es6","es3");
$jscomp.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var e="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),d=0;d<e.length;d++){var h=$jscomp.global[e[d]];"function"===typeof h&&"function"!=typeof h.prototype[a]&&$jscomp.defineProperty(h.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.iteratorPrototype($jscomp.arrayIteratorImpl(this))}})}return a},"es6",
"es3");$jscomp.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};$jscomp.iteratorFromArray=function(a,e){a instanceof String&&(a+="");var d=0,h=!1,l={next:function(){if(!h&&d<a.length){var p=d++;return{value:e(p,a[p]),done:!1}}h=!0;return{done:!0,value:void 0}}};l[Symbol.iterator]=function(){return l};return l};
$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(e,d){return d})}},"es8","es3");
define("buildspace/apps/MasterCostData/ProjectParticulars","dojo/_base/declare dojo/_base/lang dojox/grid/EnhancedGrid buildspace/widget/grid/cells/Formatter dijit/form/DropDownButton dijit/DropDownMenu dijit/MenuItem dojo/when dojo/aspect buildspace/widget/grid/cells/Textarea buildspace/widget/grid/cells/Select ./SelectComponentsDialog dojo/i18n!buildspace/nls/CostData".split(" "),function(a,e,d,h,l,p,t,B,C,D,E,z,k){var A=a("buildspace.apps.MasterCostData.ProjectParticularsGrid",d,{masterCostData:null,
style:"border:none;",region:"center",keepSelection:!0,rowSelector:"0px",escapeHTMLInData:!1,borderContainerWidget:null,addUrl:"masterCostData/addNewProjectParticular",updateUrl:"masterCostData/updateProjectParticular",constructor:function(c){this.inherited(arguments)},canSort:function(c){return!1},postCreate:function(){var c=this;this.inherited(arguments);this.on("RowClick",function(b){if(b.cell){var f=b.cell.field;b=this.getItem(b.rowIndex);var g=!1;0<b.id[0]&&(g=!0);c.enableToolbarButtons(g);switch(f){case "is_summary_displayed":b&&
0<b.id[0]&&c.borderContainerWidget.toggleDisplayInSummary(b);break;case "is_prime_cost_rate_summary_displayed":b&&0<b.id[0]&&c.borderContainerWidget.togglePrimeCostRateDisplayInSummary(b);break;case "is_used_for_cost_comparison":b&&0<b.id[0]&&c.borderContainerWidget.useForCostComparison(b);break;case "components":b&&0<b.id[0]&&c.borderContainerWidget.createSelectComponentsDialog(b)}}})},enableToolbarButtons:function(c){dijit.byId(this.masterCostData.id+"-project-particular-delete-button")._setDisabledAttr(!c)},
dodblclick:function(c){this.onRowDblClick(c)},doApplyCellEdit:function(c,b,f){var g=this,m=g.getItem(b),n=g.store;if(c!==m[f][0]){var x=buildspace.dialog.indeterminateProgressBar({title:k.savingData+". "+k.pleaseWait+"..."}),w={id:m.id,attr_name:f,val:c,master_cost_data_id:g.masterCostData.id,_csrf_token:m._csrf_token?m._csrf_token:null},u=this.updateUrl;m.id==buildspace.constants.GRID_LAST_ROW&&(u=0<b?g.getItem(b-1):!1,e.mixin(w,{prev_item_id:u?u.id:0}),u=this.addUrl);var y=function(q,v){for(var r in q)m.hasOwnProperty(r)&&
r!=v._getIdentifierAttribute()&&v.setValue(m,r,q[r]);v.save()};w={url:u,content:w,handleAs:"json",load:function(q){if(q.success){0<m.id?y(q.data,n):(n.deleteItem(m),n.save(),dojo.forEach(q.items,function(r){n.newItem(r)}),n.save());var v=g.getCellByField(f);window.setTimeout(function(){g.focus.setFocusIndex(b,v.index)},10)}else buildspace.dialog.alert(k.cannotBeEdited,q.errorMsg,80,300,function(){y(q.data,n)});x.hide()},error:function(q){x.hide()}};x.show();dojo.xhrPost(w)}g.inherited(arguments)},
canEdit:function(c,b){return!0},reload:function(){this.store.close();this._refresh()}});return a("buildspace.apps.MasterCostData.ProjectParticularsContainer",dijit.layout.BorderContainer,{region:"center",style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1,masterCostData:null,grid:null,unitsOfMeasurement:[],postCreate:function(){this.inherited(arguments);this.gridFormatter=new h;var c=this;c.addChild(c.createToolbar());var b=buildspace.dialog.indeterminateProgressBar({title:k.pleaseWait+
"..."});b.show();dojo.xhrPost({url:"default/getAllUnits",handleAs:"json",load:function(f){c.unitsOfMeasurement.values=f.values;c.unitsOfMeasurement.options=f.options},error:function(f){}}).then(function(){var f=c.createBreakdownGrid();f=new dijit.layout.ContentPane({style:"padding:0px;border:none;width:100%;height:100%;",region:"center",content:f,grid:f});c.addChild(f);b.hide()})},createToolbar:function(){var c=this,b=new dijit.Toolbar({region:"top",style:"outline:none!important;border:none;padding:2px;width:100%;"});
b.addChild(new dijit.form.Button({id:this.masterCostData.id+"-project-particular-delete-button",label:k.delete,iconClass:"icon-16-container icon-16-delete",disabled:!0,style:"outline:none!important;",onClick:function(){if(-1<c.grid.selection.selectedIndex){var f=c.grid.getItem(c.grid.selection.selectedIndex);0<f.id[0]&&c.deleteRow(f)}}}));b.addChild(new dijit.ToolbarSeparator);b.addChild(new dijit.form.Button({label:k.refresh,iconClass:"icon-16-container icon-16-reload",style:"outline:none!important;",
onClick:function(){c.grid.reload()}}));return b},createBreakdownGrid:function(){return this.grid=A({masterCostData:this.masterCostData,borderContainerWidget:this,structure:[{name:"No.",field:"count",width:"30px",styles:"text-align:center;",formatter:this.gridFormatter.rowCountCellFormatter},{name:k.description,field:"description",width:"250px",cellType:"buildspace.widget.grid.cells.Textarea",editable:!0},{name:k.unit,field:"uom_id",width:"70px",editable:!0,styles:"text-align:center;",type:"dojox.grid.cells.Select",
options:this.unitsOfMeasurement.options,values:this.unitsOfMeasurement.values,formatter:this.gridFormatter.unitCellFormatter},{name:k.displayInSummary,field:"is_summary_displayed",width:"70px",styles:"text-align:center;",formatter:this.gridFormatter.includedCellFormatter},{name:k.displayInPrimeCostRateSummary,field:"is_prime_cost_rate_summary_displayed",width:"70px",styles:"text-align:center;",formatter:this.gridFormatter.includedCellFormatter},{name:k.summaryDescription,field:"summary_description",
width:"auto",cellType:"buildspace.widget.grid.cells.Textarea",editable:!0},{name:k.displayComparison,field:"is_used_for_cost_comparison",width:"70px",styles:"text-align:center;",formatter:this.gridFormatter.includedCellFormatter},{name:k.components,field:"components",width:"70px",styles:"text-align:center;",formatter:function(c,b,f){return(c=this.grid.getItem(b))&&0<parseInt(String(c.id))?'<a href="#" onclick="return false;">'+k.select+"</a>":"&nbsp;"}}],store:new dojo.data.ItemFileWriteStore({clearOnClose:!0,
url:"masterCostData/getProjectParticularList/master_cost_data_id/"+this.masterCostData.id})})},deleteRow:function(c){var b=this,f=buildspace.dialog.indeterminateProgressBar({title:k.deleting+". "+k.pleaseWait+"..."});buildspace.dialog.confirm(k.confirmation,k.confirmationMessage+"<br/>"+k.cannotBeUndone,80,300,function(){f.show().then(function(){dojo.xhrPost({url:"masterCostData/deleteProjectParticular",content:{id:c.id,_csrf_token:c._csrf_token},handleAs:"json",load:function(g){g.success?(b.grid.reload(),
b.grid.selection.clear(),b.grid.enableToolbarButtons(!1)):buildspace.dialog.alert(k.cannotBeDeleted,g.errorMsg,80,300);f.hide()},error:function(g){f.hide();b.grid.selection.clear();b.grid.enableToolbarButtons(!1)}})})})},toggleDisplayInSummary:function(c){var b=this,f=buildspace.dialog.indeterminateProgressBar({title:k.savingData+". "+k.pleaseWait+"..."});f.show();dojo.xhrPost({url:"masterCostData/toggleDisplayInSummary/master_cost_data_id/"+b.masterCostData.id,content:{id:c.id,_csrf_token:c._csrf_token?
c._csrf_token:null},handleAs:"json",load:function(g){g.success&&(b.grid.store.fetchItemByIdentity({identity:c.id,onItem:function(m){for(var n in g.data)m.hasOwnProperty(n)&&n!=b.grid.store._getIdentifierAttribute()&&b.grid.store.setValue(m,n,g.data[n])}}),b.grid.store.save());f.hide()},error:function(g){f.hide()}})},togglePrimeCostRateDisplayInSummary:function(c){var b=this,f=buildspace.dialog.indeterminateProgressBar({title:k.savingData+". "+k.pleaseWait+"..."});f.show();dojo.xhrPost({url:"masterCostData/togglePrimeCostRateDisplayInSummary/master_cost_data_id/"+
b.masterCostData.id,content:{id:c.id,_csrf_token:c._csrf_token?c._csrf_token:null},handleAs:"json",load:function(g){g.success&&(b.grid.store.fetchItemByIdentity({identity:c.id,onItem:function(m){for(var n in g.data)m.hasOwnProperty(n)&&n!=b.grid.store._getIdentifierAttribute()&&b.grid.store.setValue(m,n,g.data[n])}}),b.grid.store.save());f.hide()},error:function(g){f.hide()}})},useForCostComparison:function(c){var b=this,f=buildspace.dialog.indeterminateProgressBar({title:k.savingData+". "+k.pleaseWait+
"..."});f.show();dojo.xhrPost({url:"masterCostData/useForCostComparison/master_cost_data_id/"+b.masterCostData.id,content:{id:c.id,_csrf_token:c._csrf_token?c._csrf_token:null},handleAs:"json",load:function(g){g.success&&(b.grid.store.fetchItemByIdentity({identity:c.id,onItem:function(m){for(var n in g.data)m.hasOwnProperty(n)&&n!=b.grid.store._getIdentifierAttribute()&&b.grid.store.setValue(m,n,g.data[n])}}),b.grid.store.save());f.hide()},error:function(g){f.hide()}})},createSelectComponentsDialog:function(c){var b=
this,f=buildspace.dialog.indeterminateProgressBar({title:k.pleaseWait+"..."}),g={url:"masterCostData/getProjectParticularGetSelectedComponents/id/"+c.id,content:{_csrf_token:c._csrf_token?c._csrf_token:null},handleAs:"json",load:function(m){m.success&&(new z({gridUrl:"masterCostData/getProjectParticularComponentList/master_cost_data_id/"+b.masterCostData.id+"/id/"+c.id,masterCostData:b.masterCostData,projectParticular:c,selectedItemIds:m.selected_ids})).show();f.hide()},error:function(m){f.hide()}};
f.show();dojo.xhrPost(g)}})});
