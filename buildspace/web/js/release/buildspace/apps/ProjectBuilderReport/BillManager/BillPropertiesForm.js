define("buildspace/apps/ProjectBuilderReport/BillManager/BillPropertiesForm","dojo/_base/declare dojo/html dojo/dom dojo/dom-construct dojo/keys dojo/dom-style dojo/dom-attr dojo/dom-geometry dijit/form/Form dijit/form/RadioButton dijit/form/Select dijit/form/ValidationTextBox dijit/form/NumberTextBox dijit/form/CurrencyTextBox dojo/number dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/billPropertiesForm.html dojo/text!./templates/columnSettingsForm.html dojo/text!./templates/markupSettingsForm.html dojo/i18n!buildspace/nls/ProjectBuilder ./buildUpFloorAreaDialog".split(" "),
function(f,c,w,m,x,b,y,n,g,z,A,B,C,D,h,e,E,k,l,p,q,r,a,t,F){var u=f("buildspace.apps.ProjectBuilderReport.BillManager.MarkupSettingsForm",[e,k,l],{billId:-1,templateString:r,baseClass:"buildspace-form",nls:a,billElementObj:null,markupSettings:null,_csrf_token:0,region:"center",style:"padding:5px;overflow:auto;border:0px;height:146px;",constructor:function(){this.ROUNDING_TYPE_DISABLED=buildspace.constants.ROUNDING_TYPE_DISABLED;this.ROUNDING_TYPE_UPWARD=buildspace.constants.ROUNDING_TYPE_UPWARD;this.ROUNDING_TYPE_DOWNWARD=
buildspace.constants.ROUNDING_TYPE_DOWNWARD;this.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER=buildspace.constants.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER;this.ROUNDING_TYPE_NEAREST_TENTH=buildspace.constants.ROUNDING_TYPE_NEAREST_TENTH;this.ROUNDING_TYPE_DISABLED_TEXT=buildspace.constants.ROUNDING_TYPE_DISABLED_TEXT;this.ROUNDING_TYPE_UPWARD_TEXT=buildspace.constants.ROUNDING_TYPE_UPWARD_TEXT;this.ROUNDING_TYPE_DOWNWARD_TEXT=buildspace.constants.ROUNDING_TYPE_DOWNWARD_TEXT;this.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER_TEXT=
buildspace.constants.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER_TEXT;this.ROUNDING_TYPE_NEAREST_TENTH_TEXT=buildspace.constants.ROUNDING_TYPE_NEAREST_TENTH_TEXT;this.currencyAbbreviation=buildspace.billCurrencyAbbreviation?buildspace.billCurrencyAbbreviation:buildspace.currencyAbbreviation;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.setValues()},setValues:function(){this.elementMarkupEnabledNode.set("checked",this.markupSettings.element_markup_enabled);c.set(this.elementMarkupEnabledViewDivNode,
this.markupSettings.element_markup_enabled?a.yesCapital:a.noCapital);this.itemMarkupEnabledNode.set("checked",this.markupSettings.item_markup_enabled);c.set(this.itemMarkupEnabledViewDivNode,this.markupSettings.item_markup_enabled?a.yesCapital:a.noCapital);this.roundingTypeNode.set("value",this.markupSettings.rounding_type);var d=this.getRoundingTypeText();c.set(this.roundingTypeViewDivNode,d)},getRoundingTypeText:function(){switch(this.markupSettings.rounding_type.toString()){case buildspace.constants.ROUNDING_TYPE_DISABLED:return buildspace.constants.ROUNDING_TYPE_DISABLED_TEXT;
case buildspace.constants.ROUNDING_TYPE_UPWARD:return buildspace.constants.ROUNDING_TYPE_UPWARD_TEXT;case buildspace.constants.ROUNDING_TYPE_DOWNWARD:return buildspace.constants.ROUNDING_TYPE_DOWNWARD_TEXT;case buildspace.constants.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER:return buildspace.constants.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER_TEXT;case buildspace.constants.ROUNDING_TYPE_NEAREST_TENTH:return buildspace.constants.ROUNDING_TYPE_NEAREST_TENTH_TEXT;default:return null}}}),v=f("buildspace.apps.ProjectBuilderReport.BillManager.ColumnSettingsForm",
[e,k,l],{count:0,billId:-1,columnSettingName:"",columnSettingQuantity:"",columnSettingRemeasurementQuantityEnabled:!1,columnSettingUseOriginalQuantity:!0,columnSettingTotalFloorAreaM2:0,columnSettingTotalFloorAreaFT2:0,columnSettingShowEstimatedTotalCost:!1,columnSettingFloorAreaHasBuildUp:!1,columnSettingFloorAreaUseMetric:!1,columnSettingFloorAreaDisplayMetric:!1,editMode:!1,columnId:-1,quantity:1,locked:!1,templateString:q,billElementObj:null,_csrf_token:0,postCreate:function(){this.inherited(arguments);
this.toggleEditableInputElements(!1);this.setValues()},setValues:function(){this.nameNode.set("value",this.columnSettingName);this.quantityNode.set("value",this.columnSettingQuantity);this.totalFloorAreaM2Node.set("value",this.columnSettingTotalFloorAreaM2);this.totalFloorAreaFT2Node.set("value",this.columnSettingTotalFloorAreaFT2);this.remeasurementQuantityEnabledNode.set("checked",this.columnSettingRemeasurementQuantityEnabled);this.showEstimatedTotalCostNode.set("checked",this.columnSettingShowEstimatedTotalCost);
var d=this.columnSettingShowEstimatedTotalCost?a.yesCapital:a.noCapital;c.set(this.nameViewDivNode,this.columnSettingName);c.set(this.showEstimatedTotalCostViewDivNode,d);c.set(this.quantityViewDivNode,""+this.columnSettingQuantity+"");this.columnSettingFloorAreaUseMetric?(c.set(this.totalFloorAreaM2ViewDivNode,this.createBuildUpFloorAreaLinks("M2")),c.set(this.totalFloorAreaFT2ViewDivNode,""+this.columnSettingTotalFloorAreaFT2+"")):(c.set(this.totalFloorAreaM2ViewDivNode,""+this.columnSettingTotalFloorAreaM2+
""),c.set(this.totalFloorAreaFT2ViewDivNode,this.createBuildUpFloorAreaLinks("FT2")));this.columnSettingUseOriginalQuantity?(this.originalQtyNode.set("checked",!0),this.remeasurementQtyNode.set("disabled",!0)):(this.remeasurementQtyNode.set("checked",!0),this.originalQtyNode.set("disabled",!0));this.columnSettingFloorAreaDisplayMetric?this.floorAreaDisplayMetricNode.set("checked",!0):this.floorAreaDisplayImperialNode.set("checked",!0);this.toggleCheckUseMetric()},toggleCheckUseMetric:function(){this.columnSettingFloorAreaUseMetric?
this.floorAreaUseMetricNode.set("checked",!0):this.floorAreaUseImperialNode.set("checked",!0);this.floorAreaUseMetricNode.set("disabled",!0);this.floorAreaUseImperialNode.set("disabled",!0)},createBuildUpFloorAreaLinks:function(d){var a=this,b=null,b="M2"==d?a.columnSettingTotalFloorAreaM2:a.columnSettingTotalFloorAreaFT2;return m.create("a",{onclick:function(){(new t({billColumnSettingId:a.columnId,billId:a.billId,columnSettingForm:a,unit:d})).show()},"class":"buildUpLink",href:"#",title:"Open Build Up Floor Area",
innerHTML:b})},toggleEditableInputElements:function(){b.set(this.nameInputDivNode,"display","none");b.set(this.quantityInputDivNode,"display","none");b.set(this.remeasurementQuantityEnabledInputDivNode,"display","none");b.set(this.showEstimatedTotalCostInputDivNode,"display","none");b.set(this.nameViewDivNode,"display","");b.set(this.quantityViewDivNode,"display","");b.set(this.showEstimatedTotalCostViewDivNode,"display","");this.toggleFloorAreaInputDiv();c.set(this.remeasurementQuantityEnabledViewDivNode,
this.columnSettingRemeasurementQuantityEnabled?a.yesCapital:a.noCapital);this.toggleUseOriginalQuantity();this.toggleFloorAreaDisplayMetric()},toggleUseOriginalQuantity:function(){b.set(this.originalQtyInputDivNode,"display","none");b.set(this.remeasurementQtyInputDivNode,"display","none");b.set(this.originalQtyViewDivNode,"display","block");b.set(this.remeasurementQtyViewDivNode,"display","block");var d=null,a=null;this.columnSettingRemeasurementQuantityEnabled&&(d=this.columnSettingUseOriginalQuantity?
"icon-16-container icon-16-checkmark2":"icon-16-container icon-16-cross",a=this.columnSettingUseOriginalQuantity?"icon-16-container icon-16-cross":"icon-16-container icon-16-checkmark2");c.set(this.originalQtyViewDivNode,'<span class="dijitReset dijitInline dijitIcon '+d+'"></span>');c.set(this.remeasurementQtyViewDivNode,'<span class="dijitReset dijitInline dijitIcon '+a+'"></span>')},toggleFloorAreaInputDiv:function(){b.set(this.totalFloorAreaM2InputDivNode,"display","none");b.set(this.totalFloorAreaM2ViewDivNode,
"display","");b.set(this.totalFloorAreaFT2InputDivNode,"display","none");b.set(this.totalFloorAreaFT2ViewDivNode,"display","")},toggleFloorAreaDisplayMetric:function(){b.set(this.floorAreaDisplayMetricInputDivNode,"display","none");b.set(this.floorAreaDisplayImperialInputDivNode,"display","none");b.set(this.floorAreaDisplayMetricViewDivNode,"display","");b.set(this.floorAreaDisplayImperialViewDivNode,"display","");var a=this.columnSettingFloorAreaDisplayMetric?"icon-16-container icon-16-cross":"icon-16-container icon-16-checkmark2";
c.set(this.floorAreaDisplayMetricViewDivNode,'<span class="dijitReset dijitInline dijitIcon '+(this.columnSettingFloorAreaDisplayMetric?"icon-16-container icon-16-checkmark2":"icon-16-container icon-16-cross")+'"></span>');c.set(this.floorAreaDisplayImperialViewDivNode,'<span class="dijitReset dijitInline dijitIcon '+a+'"></span>')},checkManualFloorArea:function(){var a=h.format(this.totalFloorAreaM2Node.get("value"),{places:2}),b=h.format(this.totalFloorAreaFT2Node.get("value"),{places:2});if(0<
this.columnId&&this.columnSettingFloorAreaHasBuildUp&&(a!=this.columnSettingTotalFloorAreaM2||b!=this.columnSettingTotalFloorAreaFT2))return!0}});g=f("buildspace.apps.ProjectBuilderReport.BillManager.BillPropertiesMainInfoForm",[g,e,k,l,dojox.form.manager._Mixin,dojox.form.manager._NodeMixin,dojox.form.manager._ValueMixin,dojox.form.manager._DisplayMixin],{templateString:p,baseClass:"buildspace-form",region:"top",billId:-1,explorer:null,formData:null,buildUpRateRoundingType:null,buildUpQuantityRoundingType:null,
unitTypeText:null,description:null,nls:a,style:"padding:5px;overflow:auto;border:0px;height:140px;",constructor:function(){var a=this.BillTypeConstantArray=[];this.ROUNDING_TYPE_DISABLED=buildspace.constants.ROUNDING_TYPE_DISABLED;this.ROUNDING_TYPE_UPWARD=buildspace.constants.ROUNDING_TYPE_UPWARD;this.ROUNDING_TYPE_DOWNWARD=buildspace.constants.ROUNDING_TYPE_DOWNWARD;this.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER=buildspace.constants.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER;this.ROUNDING_TYPE_NEAREST_TENTH=buildspace.constants.ROUNDING_TYPE_NEAREST_TENTH;
this.ROUNDING_TYPE_DISABLED_TEXT=buildspace.constants.ROUNDING_TYPE_DISABLED_TEXT;this.ROUNDING_TYPE_UPWARD_TEXT=buildspace.constants.ROUNDING_TYPE_UPWARD_TEXT;this.ROUNDING_TYPE_DOWNWARD_TEXT=buildspace.constants.ROUNDING_TYPE_DOWNWARD_TEXT;this.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER_TEXT=buildspace.constants.ROUNDING_TYPE_NEAREST_WHOLE_NUMBER_TEXT;this.ROUNDING_TYPE_NEAREST_TENTH_TEXT=buildspace.constants.ROUNDING_TYPE_NEAREST_TENTH_TEXT;a[buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_STANDARD]=
buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_STANDARD_TEXT;a[buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PRELIMINARY]=buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PRELIMINARY_TEXT;a[buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PROVISIONAL]=buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PROVISIONAL_TEXT;a[buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PROVISIONAL]=
buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PROVISIONAL_TEXT;a[buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PRIMECOST]=buildspace.apps.ProjectBuilderReport.ProjectStructureConstants.BILL_TYPE_PRIMECOST_TEXT;this.currencyAbbreviation=buildspace.billCurrencyAbbreviation?buildspace.billCurrencyAbbreviation:buildspace.currencyAbbreviation;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);c.set(this.unitTypeTextNode,this.unitTypeText);
c.set(this.billTypeTextNode,this.BillTypeConstantArray[this.formData.billType])},disableForm:function(){this.buildUpQuantityRoundingTypeNode.set("disabled",!0);this.titleNode.set("disabled",!0);this.descriptionNode.set("disabled",!0)},startup:function(){this.inherited(arguments);this.setFormValues(this.formData);this.disableForm()}});return f("buildspace.apps.ProjectBuilderReport.BillManager.BillPropertiesForm",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;margin:0px;border:0px;height:100%;overflow:auto;",
gutters:!1,region:"center",billId:-1,explorer:null,billElementObj:null,nls:a,totalColumnSettings:0,locked:!1,columnSettings_csrf_token:null,postCreate:function(){this.inherited(arguments);var d=this,b=buildspace.dialog.indeterminateProgressBar({title:a.pleaseWait+"..."});b.show().then(function(){dojo.xhrGet({url:"billManager/billPropertiesForm",handleAs:"json",content:{id:d.billId},load:function(a){d.markupSettings_csrf_token=a.markup_settings_csrf_token;d.columnSettings_csrf_token=a.column_settings_csrf_token;
d.renderBillPropertiesInfoForm(a.bill_setting);d.renderMarkupSettings(a.markup_settings);d.renderBillColumnSettings(a.column_settings);d.resize();b.hide()},error:function(a){b.hide()}})})},renderBillPropertiesInfoForm:function(a){a=this.mainForm=new g({billId:this.billId,explorer:this.explorer,unitTypeText:a.unit_type_text,billElementObj:this.billElementObj,formData:a});this.addChild(a)},renderMarkupSettings:function(a){a=new u({billId:this.billId,billElementObj:this.billElementObj,markupSettings:a,
_csrf_token:this.markupSettings_csrf_token});this.addChild(a)},renderBillColumnSettings:function(b){var d=this,c=this.billId,g=this.billElementObj,m=this.columnSettings_csrf_token;this.columnSettingsTable=new (f("ColumnSettingTableWidget",[e,k,l],{style:"padding:5px;overflow:auto;border:0px;overflow:auto;",region:"bottom",locked:d.locked,baseClass:"buildspace-form",totalColumnSettings:0,columnSettings:b,templateString:"<div><fieldset><legend>"+a.columnSettings+'</legend><div style="height:2px;">&nbsp;</div><table class="buildspace-table"><thead><tr class="gridHeader"><th class="gridCell" style="text-align:center;" rowspan="2">No.</th><th class="gridCell" rowspan="2">'+
a.name+'</th><th class="gridCell" style="text-align: center;" rowspan="2">'+a.totalUnit+'</th><th class="gridCell" style="text-align: center;" rowspan="2">'+a.enable+" "+a.qty+' (2)</th><th class="gridCell" style="text-align: center;" rowspan="2">'+a.use+" "+a.qty+'</th><th class="gridCell" style="text-align: center;" rowspan="2">'+a.use+" "+a.qty+' (2)</th><th class="gridCell" style="text-align: center;" colspan="7">'+a.gross+" "+a.floorArea+'</th></tr><tr class="gridHeaderBottom"><th style="text-align:center;" colspan="2">'+
a.metreSquare+'</th><th style="text-align:center;" colspan="2">'+a.squareFeet+'</th><th style="text-align:center;">'+a.show+" "+a.metreSquare+'</th><th style="text-align:center;">'+a.show+" "+a.squareFeet+'</th><th style="text-align:center;">'+a.show+" "+a.estimation+'</th></tr></thead><tbody id="columnSettingTbody-'+c+'" data-dojo-attach-point="columnSettingsTBody"></tbody></table></fieldset></div>',postCreate:function(){this.inherited(arguments);var a=0;dojo.forEach(this.columnSettings,function(b,
f){a=this.totalColumnSettings;var e=new v({count:a,locked:d.locked,columnSettingName:b.name,columnSettingQuantity:b.quantity,columnSettingRemeasurementQuantityEnabled:b.remeasurement_quantity_enabled,columnSettingUseOriginalQuantity:b.use_original_quantity,columnSettingTotalFloorAreaM2:h.format(b.total_floor_area_m2,{places:2}),columnSettingTotalFloorAreaFT2:h.format(b.total_floor_area_ft2,{places:2}),columnSettingFloorAreaHasBuildUp:b.floor_area_has_build_up,columnSettingFloorAreaUseMetric:b.floor_area_use_metric,
columnSettingFloorAreaDisplayMetric:b.floor_area_display_metric,columnSettingShowEstimatedTotalCost:b.show_estimated_total_cost,columnId:b.id,billId:c,billElementObj:g,_csrf_token:m});e.placeAt(this.columnSettingsTBody);dojo.parser.parse(e.domNode)},this)}}));this.addChild(this.columnSettingsTable)},resize:function(){var a=n.getContentBox(this.domNode).h-265;this.columnSettingsTable&&b.set(this.columnSettingsTable.domNode,"height",a+"px");this.inherited(arguments)}})});
