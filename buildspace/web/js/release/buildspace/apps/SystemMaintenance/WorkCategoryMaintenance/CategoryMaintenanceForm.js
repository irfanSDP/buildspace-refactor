define("dojo/_base/declare dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Form dijit/form/Button dijit/form/ValidationTextBox dijit/Toolbar dojo/text!./templates/WorkCategory.html buildspace/widget/grid/cells/Formatter ./CategoryGrid dojo/i18n!buildspace/nls/WorkCategoryMaintenance dojo/html".split(" "),function(g,h,w,k,l,m,n,x,p,q,r,t,c,u){var v=g("buildspace.apps.SystemMaintenance.WorkCategoryForm",[m,h,k,l,dojox.form.manager._Mixin,dojox.form.manager._NodeMixin,
dojox.form.manager._ValueMixin,dojox.form.manager._DisplayMixin],{baseClass:"buildspace-form",formValues:[],nls:c,templateString:q,startup:function(){this.inherited(arguments);this.setFormValues(this.formValues)},submit:function(){var a=this;this.WorkCategoryMaintenanceGrid.grid.store.save();var b=dojo.formToObject(this.id),e=buildspace.dialog.indeterminateProgressBar({title:c.savingData+". "+c.pleaseWait+"..."});this.validate()&&e.show().then(function(){dojo.xhrPost({url:"systemMaintenance/workCategoryUpdate",
content:b,handleAs:"json",load:function(d){dojo.query('[id^="work_category_error-"]').forEach(function(a){a.innerHTML=""});if(1==d.success&&a.WorkCategoryMaintenanceGrid){a.setFormValues(d.values);a.WorkCategoryMaintenanceGrid.refreshGrid();var b=dijit.byId("WorkCategoryMaintenance-stackContainer");d=dijit.byId("WorkCategoryForm");b.removeChild(d);d.destroyRecursive();a.WorkCategoryMaintenanceGrid.refreshGrid()}else for(b in d=d.errors,d)a["work_category_error-"+b]&&u.set(a["work_category_error-"+
b],d[b]);e.hide()},error:function(a){e.hide()}})})}});return g("buildspace.apps.WorkCategoryMaintenance.WorkCategoryMaintenanceFormContainer",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;border:0px;",gutters:!1,resource:null,postCreate:function(){this.inherited(arguments);var a=new r,b=dijit.byId("WorkCategoryMaintenance-stackContainer");b&&dijit.byId("WorkCategoryMaintenance-stackContainer").destroyRecursive();b=this.stackContainer=new dijit.layout.StackContainer({style:"width:100%;height:100%;",
region:"center",id:"WorkCategoryMaintenance-stackContainer"});a=this.workCategoryMaintenanceGrid=new t({gridOpts:{store:new dojo.data.ItemFileWriteStore({clearOnClose:!0,url:"systemMaintenance/getWorkCategories"}),CategoryFormContainer:this,structure:[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:a.rowCountCellFormatter},{name:c.name,field:"name",editable:!1,width:"280px"},{name:c.description,field:"description",editable:!1,width:"auto"},{name:c.updatedAt,field:"updated_at",
styles:"text-align:center;",width:"120px"}],onRowDblClick:dojo.hitch(this,"editCategory")}});a=new dijit.layout.ContentPane({title:c.workCategoryList,content:a});b.addChild(a);a=new dijit.layout.StackController({region:"top",containerId:"WorkCategoryMaintenance-stackContainer"});a=new dijit.layout.ContentPane({style:"padding: 0px; overflow: hidden;",baseClass:"breadCrumbTrail",region:"top",content:a});this.addChild(b);this.addChild(a);dojo.subscribe("WorkCategoryMaintenance-stackContainer-selectChild",
"",function(a){var b=dijit.byId("WorkCategoryMaintenance-stackContainer");if(b){var c=b.getChildren();a=dojo.indexOf(c,dijit.byId(a.id));for(a+=1;c.length>a;)b.removeChild(c[a]),c[a].destroyRecursive(!0),a+=1}})},makePane:function(a,b){var c=dijit.byId("WorkCategoryMaintenance-stackContainer"),d=new dijit.layout.ContentPane({title:a,id:"WorkCategoryForm",content:b});c.addChild(d);c.selectChild(d)},CategoryFormContainer:function(a,b){var e=this.workCategoryForm=new v({region:"center",formValues:a,
WorkCategoryMaintenanceGrid:this.workCategoryMaintenanceGrid}),d=new p({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});d.addChild(new n({label:c.save,iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(this.workCategoryForm,"submit")}));var f=new dijit.layout.BorderContainer({style:"padding:0px;width:100%;height:100%;",baseClass:"form",gutters:!1,region:"center"});f.addChild(d);f.addChild(e);this.makePane(b?c.addWorkCategory:c.editWorkCategory,
f)},addCategory:function(){var a=this,b=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+"..."});b.show().then(function(){dojo.xhrGet({url:"systemMaintenance/workCategoryForm",handleAs:"json"}).then(function(c){b.hide();a.CategoryFormContainer(c,!0)})})},editCategory:function(){if(-1<this.workCategoryMaintenanceGrid.grid.selection.selectedIndex){var a=this,b=this.workCategoryMaintenanceGrid.grid.getItem(this.workCategoryMaintenanceGrid.grid.selection.selectedIndex),e=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+
"..."});b&&!isNaN(parseInt(b.id[0]))&&e.show().then(function(){dojo.xhrGet({url:"systemMaintenance/workCategoryForm/id/"+b.id,handleAs:"json"}).then(function(b){e.hide();a.CategoryFormContainer(b,!1)})})}},deleteCategory:function(){if(-1<this.workCategoryMaintenanceGrid.grid.selection.selectedIndex){var a=this,b=a.workCategoryMaintenanceGrid.grid.getItem(this.workCategoryMaintenanceGrid.grid.selection.selectedIndex),e=buildspace.dialog.indeterminateProgressBar({title:c.deleting+". "+c.pleaseWait+
"..."});b&&!isNaN(parseInt(b.id[0]))&&(b.can_be_deleted[0]?buildspace.dialog.confirm(c.confirmationCategory,"<div>"+c.firstLevelCategoryDialogMsg+"</div>",75,320,function(){e.show().then(function(){dojo.xhrPost({url:"systemMaintenance/workCategoryDelete",content:{id:b.id,_csrf_token:b._csrf_token},handleAs:"json",load:function(c){c.success&&(a.workCategoryMaintenanceGrid.grid.store.deleteItem(b),a.workCategoryMaintenanceGrid.grid.store.save(),a.workCategoryMaintenanceGrid.refreshGrid());a.workCategoryMaintenanceGrid.grid.disableToolbarButtons(!0);
e.hide()},error:function(a){e.hide()}})})}):buildspace.dialog.alert(c.itemCannotBeDeleted,c.cannotDeleteUseInUOM,75,320))}}})});
