define("dojo/_base/declare dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Form dijit/form/Button dijit/form/ValidationTextBox dijit/Toolbar dojo/text!./templates/Form.html buildspace/widget/grid/cells/Formatter ./Grid dojo/i18n!buildspace/nls/SubPackageWorkMaintenance dojo/html".split(" "),function(g,h,w,k,l,m,n,x,p,q,r,t,c,u){var v=g("buildspace.apps.SystemMaintenance.SubPackageWorkForm",[m,h,k,l,dojox.form.manager._Mixin,dojox.form.manager._NodeMixin,
dojox.form.manager._ValueMixin,dojox.form.manager._DisplayMixin],{baseClass:"buildspace-form",formValues:[],nls:c,templateString:q,param:null,startup:function(){this.inherited(arguments);this.setFormValues(this.formValues)},submit:function(){var b=this;this.MaintenanceGrid.grid.store.save();var a=dojo.formToObject(this.id),d=buildspace.dialog.indeterminateProgressBar({title:c.savingData+". "+c.pleaseWait+"..."});a["sub_package_works[type]"]=b.param;this.validate()&&d.show().then(function(){dojo.xhrPost({url:"systemMaintenance/subPackageWorkUpdate",
content:a,handleAs:"json",load:function(a){dojo.query('[id^="sub_package_works_error-"]').forEach(function(a){a.innerHTML=""});if(1==a.success&&b.MaintenanceGrid){b.setFormValues(a.values);b.MaintenanceGrid.refreshGrid();var e=dijit.byId("SubPackageWorkMaintenance_"+b.param+"-stackContainer");a=dijit.byId("SubPackageWorkForm");e.removeChild(a);a.destroyRecursive();b.MaintenanceGrid.refreshGrid()}else for(e in a=a.errors,a)b["sub_package_works_error-"+e]&&u.set(b["sub_package_works_error-"+e],a[e]);
d.hide()},error:function(a){d.hide()}})})}});return g("buildspace.apps.SubPackageWorkMaintenance.SubPackageWorkMaintenanceFormContainer",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;border:0px;",gutters:!1,resource:null,param:{},postCreate:function(){this.inherited(arguments);var b=this,a=new r,d=dijit.byId("SubPackageWorkMaintenance_"+b.param+"-stackContainer");d&&dijit.byId("SubPackageWorkMaintenance_"+b.param+"-stackContainer").destroyRecursive();d=this.stackContainer=
new dijit.layout.StackContainer({style:"width:100%;height:100%;",region:"center",id:"SubPackageWorkMaintenance_"+b.param+"-stackContainer"});a=this.maintenanceGrid=new t({gridOpts:{param:b.param,store:new dojo.data.ItemFileWriteStore({clearOnClose:!0,url:"systemMaintenance/getSubPackageWorks/type/"+b.param}),FormContainer:this,structure:[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:a.rowCountCellFormatter},{name:c.name,field:"name",editable:!1,width:"auto"}],onRowDblClick:dojo.hitch(this,
"editRecord")}});a=new dijit.layout.ContentPane({title:c.subPackageWorkList,content:a});d.addChild(a);a=new dijit.layout.StackController({region:"top",containerId:"SubPackageWorkMaintenance_"+b.param+"-stackContainer"});a=new dijit.layout.ContentPane({style:"padding: 0px; overflow: hidden;",baseClass:"breadCrumbTrail",region:"top",content:a});this.addChild(d);this.addChild(a);dojo.subscribe("SubPackageWorkMaintenance_"+b.param+"-stackContainer-selectChild","",function(a){var d=dijit.byId("SubPackageWorkMaintenance_"+
b.param+"-stackContainer");if(d){var c=d.getChildren();a=dojo.indexOf(c,dijit.byId(a.id));for(a+=1;c.length>a;)d.removeChild(c[a]),c[a].destroyRecursive(!0),a+=1}})},makePane:function(b,a){var d=dijit.byId("SubPackageWorkMaintenance_"+this.param+"-stackContainer"),c=new dijit.layout.ContentPane({title:b,id:"SubPackageWorkForm",content:a});d.addChild(c);d.selectChild(c)},FormContainer:function(b,a){var d=this.RecordForm=new v({region:"center",formValues:b,MaintenanceGrid:this.maintenanceGrid,param:this.param}),
e=new p({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});e.addChild(new n({label:c.save,iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(this.RecordForm,"submit")}));var f=new dijit.layout.BorderContainer({style:"padding:0px;width:100%;height:100%;",baseClass:"form",gutters:!1,region:"center"});f.addChild(e);f.addChild(d);this.makePane(a?c.addSubPackageWork:c.editSubPackageWork,f)},addRecord:function(){var b=this,a=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+
"..."});a.show().then(function(){dojo.xhrGet({url:"systemMaintenance/subPackageWorkForm",handleAs:"json"}).then(function(d){a.hide();b.FormContainer(d,!0)})})},editRecord:function(){if(-1<this.maintenanceGrid.grid.selection.selectedIndex){var b=this,a=this.maintenanceGrid.grid.getItem(this.maintenanceGrid.grid.selection.selectedIndex),d=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+"..."});a&&!isNaN(parseInt(a.id[0]))&&d.show().then(function(){dojo.xhrGet({url:"systemMaintenance/subPackageWorkForm/id/"+
a.id,handleAs:"json"}).then(function(a){d.hide();b.FormContainer(a,!1)})})}},deleteRecord:function(){if(-1<this.maintenanceGrid.grid.selection.selectedIndex){var b=this,a=b.maintenanceGrid.grid.getItem(this.maintenanceGrid.grid.selection.selectedIndex),d=buildspace.dialog.indeterminateProgressBar({title:c.deleting+". "+c.pleaseWait+"..."});a&&!isNaN(parseInt(a.id[0]))&&(a.can_be_deleted[0]?buildspace.dialog.confirm(c.deleteConfirmation,"<div>"+c.firstLevelCategoryDialogMsg+"</div>",75,320,function(){d.show().then(function(){dojo.xhrPost({url:"systemMaintenance/subPackageWorkDelete",
content:{id:a.id,_csrf_token:a._csrf_token},handleAs:"json",load:function(c){c.success&&(b.maintenanceGrid.grid.store.deleteItem(a),b.maintenanceGrid.grid.store.save(),b.maintenanceGrid.refreshGrid());b.maintenanceGrid.grid.disableToolbarButtons(!0);d.hide()},error:function(a){d.hide()}})})}):buildspace.dialog.alert(c.itemCannotBeDeleted,c.cannotDeleteUseInUOM,75,320))}}})});
