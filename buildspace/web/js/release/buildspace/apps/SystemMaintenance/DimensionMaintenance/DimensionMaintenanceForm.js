define("dojo/_base/declare dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dijit/form/Form dijit/form/Button dijit/form/ValidationTextBox dijit/Toolbar dojo/text!./templates/dimensionUpdateForm.html buildspace/widget/grid/cells/Formatter ./grid dojo/i18n!buildspace/nls/DimensionMaintenance dojo/html".split(" "),function(g,h,w,k,l,m,n,x,p,q,r,t,c,u){var v=g("buildspace.apps.DimensionMaintenance.DimensionUpdateForm",[m,h,k,l,dojox.form.manager._Mixin,dojox.form.manager._NodeMixin,
dojox.form.manager._ValueMixin,dojox.form.manager._DisplayMixin],{baseClass:"buildspace-form",nls:c,formValues:[],templateString:q,startup:function(){this.inherited(arguments);this.setFormValues(this.formValues)},submit:function(){var b=this,a=dojo.formToObject(this.id),e=buildspace.dialog.indeterminateProgressBar({title:c.savingData+". "+c.pleaseWait+"..."});this.validate()&&e.show().then(function(){dojo.xhrPost({url:"unitOfMeasurement/dimensionUpdate",content:a,handleAs:"json",load:function(d){dojo.query('[id^="dimension_error-"]').forEach(function(a){a.innerHTML=
""});if(1==d.success&&b.dimensionMaintenanceGrid){b.setFormValues(d.values);var a=dijit.byId("dimensionMaintenance-stackContainer");d=dijit.byId("dimensionForm");a.removeChild(d);d.destroyRecursive();b.dimensionMaintenanceGrid.refreshGrid()}else for(a in d=d.errors,d)b["dimension_error-"+a]&&u.set(b["dimension_error-"+a],d[a]);e.hide()},error:function(a){e.hide()}})})}});return g("buildspace.apps.DimensionMaintenance.DimensionMaintenanceFormContainer",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;border:0px;",
gutters:!1,resource:null,postCreate:function(){this.inherited(arguments);var b=new r,a=dijit.byId("dimensionMaintenance-stackContainer");a&&dijit.byId("dimensionMaintenance-stackContainer").destroyRecursive();a=this.stackContainer=new dijit.layout.StackContainer({style:"width:100%;height:100%;",region:"center",id:"dimensionMaintenance-stackContainer"});b=this.dimensionMaintenanceGrid=new t({gridOpts:{store:new dojo.data.ItemFileWriteStore({clearOnClose:!0,url:"unitOfMeasurement/getDimensions"}),dimensionFormContainer:this,
structure:[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:b.rowCountCellFormatter},{name:c.name,field:"name",editable:!0,width:"auto"},{name:c.lastUpdated,field:"updated_at",styles:"text-align:center;",width:"120px"}],onRowDblClick:dojo.hitch(this,"editDimension")}});b=new dijit.layout.ContentPane({title:c.dimensionList,content:b});a.addChild(b);b=new dijit.layout.StackController({region:"top",containerId:"dimensionMaintenance-stackContainer"});b=new dijit.layout.ContentPane({style:"padding: 0px; overflow: hidden;",
baseClass:"breadCrumbTrail",region:"top",content:b});this.addChild(a);this.addChild(b);dojo.subscribe("dimensionMaintenance-stackContainer-selectChild","",function(a){var b=dijit.byId("dimensionMaintenance-stackContainer");if(b){var c=b.getChildren();a=dojo.indexOf(c,dijit.byId(a.id));for(a+=1;c.length>a;)b.removeChild(c[a]),c[a].destroyRecursive(!0),a+=1}})},makePane:function(b,a){var c=dijit.byId("dimensionMaintenance-stackContainer"),d=new dijit.layout.ContentPane({title:b,id:"dimensionForm",content:a});
c.addChild(d);c.selectChild(d)},dimensionFormContainer:function(b,a){var e=this.dimensionUpdateForm=new v({region:"center",formValues:b,dimensionMaintenanceGrid:this.dimensionMaintenanceGrid}),d=new p({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});d.addChild(new n({label:c.save,iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(this.dimensionUpdateForm,"submit")}));var f=new dijit.layout.BorderContainer({style:"padding:0px;width:100%;height:100%;",
baseClass:"form",gutters:!1,region:"center"});f.addChild(d);f.addChild(e);this.makePane(a?c.addDimension:c.editDimension,f)},addDimension:function(){var b=this,a=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+"..."});a.show().then(function(){dojo.xhrGet({url:"unitOfMeasurement/dimensionForm",handleAs:"json"}).then(function(c){a.hide();b.dimensionFormContainer(c,!0)})})},editDimension:function(){if(-1<this.dimensionMaintenanceGrid.grid.selection.selectedIndex){var b=this,a=this.dimensionMaintenanceGrid.grid.getItem(this.dimensionMaintenanceGrid.grid.selection.selectedIndex),
e=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+"..."});a&&!isNaN(parseInt(a.id[0]))&&e.show().then(function(){dojo.xhrGet({url:"unitOfMeasurement/dimensionForm/id/"+a.id,handleAs:"json"}).then(function(a){e.hide();b.dimensionFormContainer(a,!1)})})}},deleteDimension:function(){if(-1<this.dimensionMaintenanceGrid.grid.selection.selectedIndex){var b=this,a=b.dimensionMaintenanceGrid.grid.getItem(this.dimensionMaintenanceGrid.grid.selection.selectedIndex),e=buildspace.dialog.indeterminateProgressBar({title:c.deleting+
". "+c.pleaseWait+"..."});a&&!isNaN(parseInt(a.id[0]))&&(a.can_be_deleted[0]?buildspace.dialog.confirm(c.confirmationDimension,"<div>"+c.firstLevelDimensionDialogMsg+"</div>",75,320,function(){e.show().then(function(){dojo.xhrPost({url:"unitOfMeasurement/dimensionDelete",content:{id:a.id,_csrf_token:a._csrf_token},handleAs:"json",load:function(c){c.success&&(b.dimensionMaintenanceGrid.grid.store.deleteItem(a),b.dimensionMaintenanceGrid.grid.store.save());b.dimensionMaintenanceGrid.grid.disableToolbarButtons(!0);
e.hide()},error:function(a){e.hide()}})})}):buildspace.dialog.alert(c.itemCannotBeDeleted,c.cannotDeleteUseInUOM,75,320))}}})});
