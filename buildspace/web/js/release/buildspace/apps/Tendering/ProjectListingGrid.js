define("buildspace/apps/Tendering/ProjectListingGrid","dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/event dojo/dom-class dijit/focus dojo/keys dojo/aspect dojox/grid/EnhancedGrid dojox/grid/enhanced/plugins/Rearrange dojox/grid/enhanced/plugins/Menu dojox/grid/enhanced/plugins/Selector ./tenderImportDialog buildspace/widget/grid/Filter dojo/i18n!buildspace/nls/Tendering".split(" "),function(k,m,A,n,p,l,q,B,r,t,C,D,u,v,d){var z=k("buildspace.apps.Tendering.ProjectListingGrid",r,{keepSelection:!0,
id:"Tendering-project_listing_grid",style:"border:none;",rowSelector:"0px",deleteUrl:null,constructor:function(a){this.rearranger=t(this,{})},canSort:function(a){return!1},canEdit:function(a,b){return!1},postCreate:function(){this.inherited(arguments);this.on("RowContextMenu",function(a){this.selection.clear();var b=this.getItem(a.rowIndex);this.selection.setSelected(a.rowIndex,!0);0<b.id&&(this.contextMenu(a),this.disableToolbarButtons(!1))},!0);this.on("RowClick",function(a){(a=this.getItem(a.rowIndex))&&
0<a.id?this.disableToolbarButtons(!1):this.disableToolbarButtons(!0)})},dodblclick:function(a){this.onRowDblClick(a)},contextMenu:function(a){var b=this.rowCtxMenu=new dijit.Menu;this.contextMenuItems(a);var c={target:a.target,coords:a.keyCode!==q.F10&&"pageX"in a?{x:a.pageX,y:a.pageY}:null},f=this.getItem(a.rowIndex);b&&f&&(this.selection.isSelected(a.rowIndex)||a.rowNode&&p.contains(a.rowNode,"dojoxGridRowbar"))&&(b._openMyself(c),n.stop(a))},contextMenuItems:function(a){},deleteRow:function(a){var b=
this,c=b.getItem(a),f=buildspace.dialog.indeterminateProgressBar({title:d.deleting+". "+d.pleaseWait+"..."});l.curNode.blur();l.curNode=null;var y=function(){f.show().then(function(){dojo.xhrPost({url:b.deleteUrl,content:{id:c.id,_csrf_token:c._csrf_token},handleAs:"json",load:function(e){if(e.success){e=e.items;for(var g=b.store,h=0,w=e.length;h<w;++h)g.fetchItemByIdentity({identity:e[h].id,onItem:function(x){g.deleteItem(x);g.save()}});e.length=0}else new buildspace.dialog.alert(d.projectCannotBeDeleted,
e.errorMsg,60,380);f.hide();b.selection.clear();window.setTimeout(function(){b.focus.setFocusIndex(a,0)},10);b.disableToolbarButtons(!0);b.selectedItem=null},error:function(e){b.selection.clear();b.disableToolbarButtons(!0);b.selectedItem=null;f.hide()}})})};c.can_be_deleted[0]?buildspace.dialog.confirm(d.confirmation,"<div>"+d.deleteProjectAndAllData+"</div>",60,280,y):new buildspace.dialog.alert(d.projectCannotBeDeleted,d.projectCannotBeDeletedMsg,80,300)},reload:function(){this.store.close();this._refresh()},
disableToolbarButtons:function(a,b){a&&b instanceof Array&&dojo.forEach(b,function(c){(c=dijit.byId("ProjectListing_"+c+"Row-button"))&&c._setDisabledAttr(!1)})}});return k("buildspace.apps.Tendering.ProjectListing",dijit.layout.BorderContainer,{style:"padding:0;margin:0;outline:none;width:100%;height:100%;",gutters:!1,title:null,gridOpts:{},postCreate:function(){this.inherited(arguments);m.mixin(this.gridOpts,{region:"center",borderContainerWidget:this});var a=this.grid=new z(this.gridOpts),b=new dijit.Toolbar({region:"top",
style:"outline:none!important;padding:2px;border:none;width:100%;"});b.addChild(new dijit.form.Button({id:"ProjectListing_ImportTenderProject-button",label:d.importTenderProject,iconClass:"icon-16-container icon-16-import",onClick:function(c){(new u({uploadUrl:"tendering/uploadTenderProject",importUrl:"tendering/importTenderProject",importType:"tender",title:d.importTenderProject})).show()}}));this.addChild(new v({region:"top",grid:a,editableGrid:!1,filterFields:["title","reference","status","country",
"state"]}));this.addChild(b);this.addChild(a)}})});
