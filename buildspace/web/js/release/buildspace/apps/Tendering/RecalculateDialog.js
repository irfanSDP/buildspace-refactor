define("buildspace/apps/Tendering/RecalculateDialog","dojo/_base/declare dojo/_base/lang dojo/keys dojo/dom-style dojo/store/Memory dojo/data/ObjectStore buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/Tendering".split(" "),function(g,r,k,l,m,n,p,b){var q=g("buildspace.apps.Tendering.RecalculateDialogGrid",dojox.grid.EnhancedGrid,{rootProject:null,billId:0,region:"center",_csrf_token:null,dialog:null,projectBreakDownGrid:null,style:"border-top:none;",canSort:function(a){return!1},
postCreate:function(){var a=this;this.inherited(arguments);this.on("RowClick",function(e){var h=e.cell.field,c=this.getItem(e.rowIndex);if("recalculate"==h&&c.recalculate){var f=buildspace.dialog.indeterminateProgressBar({title:b.recalculating+". "+b.pleaseWait+"..."});f.show();dojo.xhrPost({url:"projectAnalyzer/recalculate",content:{bill_id:a.billId,level:c.id,_csrf_token:a._csrf_token},handleAs:"json",load:function(d){if(d.success){var b=a.store;a.projectBreakDownGrid.reload();b.setValue(c,"recalculate",
!1);b.setValue(c,"bill_status",d.bill_status);"item"!=c.id&&"element"!=c.id||b.fetchItemByIdentity({identity:"item"==c.id?"element":"bill",onItem:function(a){b.setValue(a,"recalculate",!0)}});b.save();if(a.dialog&&d.bill_status==buildspace.apps.Tendering.ProjectStructureConstants.BILL_STATUS_OPEN){d=dijit.byId("resourceAnalysis-"+a.rootProject.id+"-menuItem");var e=dijit.byId("scheduleOfRateAnalysis-"+a.rootProject.id+"-menuItem");d&&d.set("disabled",!1);e&&e.set("disabled",!1);a.dialog.hide()}}f.hide()},
error:function(a){f.hide()}})}})},dodblclick:function(a){this.onRowDblClick(a)}});return g("buildspace.apps.Tendering.RecalculateDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",rootProject:null,bill:null,projectBreakDownGrid:null,buildRendering:function(){var a=this.createContent();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){l.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(a){a.keyCode==
k.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},createContent:function(){var a=this.bill,e=a.bill_status[0]==buildspace.apps.Tendering.ProjectStructureConstants.BILL_STATUS_RESOURCE_ANALYSIS_RECALCULATE_ITEM||a.bill_status[0]==buildspace.apps.Tendering.ProjectStructureConstants.BILL_STATUS_SCHEDULE_OF_RATE_ANALYSIS_RECALCULATE_ITEM?!0:!1,h=a.bill_status[0]==buildspace.apps.Tendering.ProjectStructureConstants.BILL_STATUS_RESOURCE_ANALYSIS_RECALCULATE_ELEMENT||a.bill_status[0]==
buildspace.apps.Tendering.ProjectStructureConstants.BILL_STATUS_SCHEDULE_OF_RATE_ANALYSIS_RECALCULATE_ELEMENT?!0:!1,c=a.bill_status[0]==buildspace.apps.Tendering.ProjectStructureConstants.BILL_STATUS_RESOURCE_ANALYSIS_RECALCULATE_BILL||a.bill_status[0]==buildspace.apps.Tendering.ProjectStructureConstants.BILL_STATUS_SCHEDULE_OF_RATE_ANALYSIS_RECALCULATE_BILL?!0:!1,f=new dijit.layout.BorderContainer({style:"padding:0px;width:500px;height:200px;",gutters:!1}),d=new dijit.Toolbar({region:"top",style:"outline:none!important;border:none;padding:2px;overflow:hidden;"});
d.addChild(new dijit.form.Button({label:b.close,iconClass:"icon-16-container icon-16-close",style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));var g=new p;f.addChild(d);f.addChild(new q({rootProject:this.rootProject,billId:a.id,_csrf_token:a._csrf_token,store:new n({objectStore:m({data:[{id:"item",level:b.levelBillItems,bill_status:a.bill_status[0],recalculate:e},{id:"element",level:b.levelBillElements,bill_status:a.bill_status[0],recalculate:h},{id:"bill",level:b.levelBills,bill_status:a.bill_status[0],
recalculate:c}]})}),dialog:this,projectBreakDownGrid:this.projectBreakDownGrid,structure:[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:g.rowCountCellFormatter},{name:b.level,field:"level",width:"auto"},{name:b.recalculate,field:"recalculate",width:"100px",styles:"text-align:center;",formatter:g.recalculateCellFormatter}]}));return f}})});
