define("buildspace/apps/CostData/TenderComparisonReport/TenderComparisonReportPreviewDialog","dojo/_base/declare dojo/dom-style dojo/number dojo/currency dojox/grid/EnhancedGrid buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/CostData".split(" "),function(f,g,p,h,q,k,d){var e=f("buildspace.apps.CostData.TenderComparisonReportPreview.Grid",dojox.grid.EnhancedGrid,{region:"center",style:"border-top:none;",canSort:function(a){return!1},onStyleRow:function(a){this.inherited(arguments);
if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length){var b=a.node.children[0].children[0].rows[1],c=a.node.children[0].children[0].rows[0].children;b.parentNode.removeChild(b);dojo.forEach(c,function(a,b){var c=dojo.attr(a,"rowSpan");(!c||2>c)&&dojo.attr(a,"rowSpan",2)})}}}),l=function(a,b,c){a=this.grid.getItem(b);"summary"==a.type&&c.customClasses.push("disable-cell");return!(0<a.id[0]||a.id[0]==buildspace.constants.GRID_LAST_ROW)?null:parseInt(b)+1},m=function(a,b,c){b=this.grid.getItem(b);
"row_separator"==b.id[0]&&c.customClasses.push("invalidTypeItemCell");"summary"==b.type&&(c.customClasses.push("disable-cell"),c.customClasses.push("pull-right"),a="<strong>"+a+"</strong>");return a},n=function(a,b,c){b=this.grid.getItem(b);"summary"==b.type&&c.customClasses.push("disable-cell");return a=(0<b.id||"provisional_sum"==b.id||"summary"==b.type)&&0!=a&&a&&!isNaN(a)?h.format(a):"&nbsp;"};return f("buildspace.apps.CostData.TenderComparisonReportPreview.Dialog",dijit.Dialog,{style:"padding:0px;margin:0px;",
title:d.tenderComparisonReport,exportUrl:null,gridUrl:null,project:null,selectedCostDataInfo:{},parent:null,parentItemId:null,level:null,tenderCompanies:[],exportUrl:null,buildRendering:function(){var a=this.createContent();a.startup();this.content=a;this.inherited(arguments)},postCreate:function(){g.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},onHide:function(){this.destroyRecursive()},createToolbar:function(){var a=this,
b=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;width:100%;"});b.addChild(new dijit.form.Button({label:d.close,iconClass:"icon-16-container icon-16-close",onClick:function(){a.hide()}}));b.addChild(new dijit.ToolbarSeparator);b.addChild(new dijit.form.Button({label:d.export,iconClass:"icon-16-container icon-16-print",onClick:function(){a.export()}}));return b},createContent:function(){var a=this;this.formatter=new k;var b=new dijit.layout.BorderContainer({style:"padding:0px;width:1200px;height:450px;",
gutters:!1});b.addChild(this.createToolbar());var c=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."}),e={url:"tenderComparison/getTenderCompanies/pid/"+this.project.id,handleAs:"json",load:function(d){a.tenderCompanies=d.data;switch(a.level){case buildspace.apps.CostData.Levels.overallProjectCosting:b.addChild(a.createOverallProjectCostingPreviewGrid());break;case buildspace.apps.CostData.Levels.workCategory:b.addChild(a.createWorkCategoryPreviewGrid());break;default:b.addChild(a.createElementPreviewGrid())}c.hide()},
error:function(a){c.hide()}};c.show();dojo.xhrPost(e);return b},getGridStructure:function(){var a=[{name:"No.",field:"count",width:"30px",styles:"text-align:center;",formatter:l},{name:d.description,field:"description",width:"500px",formatter:m}],b=[],c;for(c in this.tenderCompanies)b.push({name:this.tenderCompanies[c].name,field:this.tenderCompanies[c].id+"_amount",width:"140px",styles:"text-align:right;",formatter:n});return[{noscroll:!0,cells:a},{noscroll:!1,cells:b}]},createOverallProjectCostingPreviewGrid:function(){var a=
"tenderComparison/getBreakdown/cost_data_id/"+this.costData.id+"/pid/"+this.project.id,b=new dijit.layout.BorderContainer({region:"center",style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1}),a=e({structure:this.getGridStructure(),store:dojo.data.ItemFileWriteStore({url:a,clearOnClose:!0})});b.addChild(a);return b},createWorkCategoryPreviewGrid:function(){var a=new dijit.layout.BorderContainer({region:"center",style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1}),b=
"tenderComparison/getWorkCategoryList/cost_data_id/"+this.costData.id+"/pid/"+this.project.id+"/parent_id/"+this.parentItemId,b=e({structure:this.getGridStructure(),store:dojo.data.ItemFileWriteStore({url:b,clearOnClose:!0})});a.addChild(b);return a},createElementPreviewGrid:function(){var a="tenderComparison/getElementList/cost_data_id/"+this.costData.id+"/pid/"+this.project.id+"/parent_id/"+this.parentItemId,b=new dijit.layout.BorderContainer({region:"center",style:"padding:0px;border:none;width:100%;height:100%;",
gutters:!1}),a=e({structure:this.getGridStructure(),store:dojo.data.ItemFileWriteStore({url:a,clearOnClose:!0})});b.addChild(a);return b},"export":function(){this.exportUrl+="/pid/"+this.project.id;form=document.createElement("form");form.setAttribute("method","post");form.setAttribute("action",this.exportUrl);form.setAttribute("target","_self");document.body.appendChild(form);return form.submit()}})});
