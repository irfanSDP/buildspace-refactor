define("buildspace/apps/CostData/CostDataInformationForm","dojo/_base/declare dojo/query dojo/html dojo/dom dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/CostDataInformationForm.html dojo/i18n!buildspace/nls/CostData".split(" "),function(f,r,g,h,k,l,m,n,p,d){var q=f("buildspace.apps.CostData.CostDataInformationForm",[k,l,m,n],{templateString:p,baseClass:"buildspace-form",region:"center",costData:null,nls:d,startup:function(){this.inherited(arguments);
var a=this,b=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});b.show().then(function(){dojo.xhrGet({url:"costData/getCostDataInformationForm",handleAs:"json",content:{cost_data_id:a.costData.id},load:function(e){a.costDataInformationForm.setFormValues(e.formValues);b.hide()},error:function(a){b.hide()}})})},postCreate:function(){this.inherited(arguments)},save:function(){var a=this,b=dojo.formToObject(this.costDataInformationForm.id),e=buildspace.dialog.indeterminateProgressBar({title:d.submitting+
". "+d.pleaseWait+"..."});this.costDataInformationForm.validate()&&e.show().then(function(){dojo.xhrPost({url:"costData/updateCostDataInformationForm/cost_data_id/"+a.costData.id+"/_csrf_token/"+a.costData._csrf_token,content:b,handleAs:"json",load:function(c){dojo.query('[id^="cost_data_error-"]').forEach(function(a){a.innerHTML=""});if(c.success)a.costDataInformationForm.setFormValues(c.formValues),a.updateGridHeaders(c.values);else for(var b in c.errors){var d=c.errors[b];g.set(h.byId("cost_data_error-"+
b),d)}e.hide()},error:function(a){e.hide()}})})},updateHeaders:function(a,b){var e=a.structure,c,f;for(f in e)if("cells"==f)for(var g in e.cells)for(columnIndex in c=e.cells[g],c)c[columnIndex].originalName==d.budget&&b["cost_data[approved_date]"]?c[columnIndex].name=d.budget+" ("+b["cost_data[approved_date]"]+")":c[columnIndex].originalName==d.contractSum&&b["cost_data[awarded_date]"]?c[columnIndex].name=d.contractSum+" ("+b["cost_data[awarded_date]"]+")":c[columnIndex].originalName==d.adjustedSum&&
b["cost_data[adjusted_date]"]&&(c[columnIndex].name=d.adjustedSum+" ("+b["cost_data[adjusted_date]"]+")");a.setStructure(e)},updateGridHeaders:function(a){for(var b in a)this.costData.approved_date=a["cost_data[approved_date]"],this.costData.awarded_date=a["cost_data[awarded_date]"],this.costData.adjusted_date=a["cost_data[adjusted_date]"];var d,c=["costData-breakdownGrid","costData-workCategoryGrid","costData-elementGrid","costData-provisionalSumGrid"];for(b in c)(d=dijit.byId(c[b]))&&this.updateHeaders(d,
a)}});return f("buildspace.apps.CostData.CostDataInformationFormContainer",dijit.layout.BorderContainer,{region:"center",title:"",style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1,costData:null,form:null,postCreate:function(){this.inherited(arguments);this.form=new q({costData:this.costData});this.addChild(this.createToolbar());this.addChild(this.form)},createToolbar:function(){var a=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;"});a.addChild(new dijit.form.Button({label:d.save,
iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(this.form,"save")}));return a}})});
