define("buildspace/apps/CostData/LinkBillItems/ProjectListingGrid",["dojo/_base/declare","dojox/grid/EnhancedGrid","./BillListingGrid","dojo/i18n!buildspace/nls/CostData"],function(f,h,k,e){var l=f("buildspace.apps.LinkBillItems.ProjectListingGrid",h,{style:"border:none;",region:"center",keepSelection:!0,escapeHTMLInData:!1,costData:null,linkedIds:[],canSort:function(){return!1}}),m=function(a,c){return parseInt(c)+1},n=function(a,c){var b=this.grid.getItem(c);return this.grid.linkedIds.includes(b.id[0])?
'<span style="color:#4c94e6">'+a+"</span>":a};return f("buildspace.apps.CostData.LinkBillItems.ProjectListingContainer",dijit.layout.BorderContainer,{region:"center",title:"",style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1,splitter:!0,costData:null,grid:null,linkedIds:[],selectedItemIds:[],deselectedItemIds:[],conversionFactor:null,updateUrl:null,item:null,stackContainer:null,parentContainer:null,onSave:null,postCreate:function(){this.inherited(arguments);this.addChild(this.createToolbar());
var a=this.stackContainer=this.createStackContainer(),c=new dijit.layout.BorderContainer({title:this.title+" - "+e.projects,style:"padding:0px;border:none;width:100%;height:100%;",gutters:!1,region:"center"}),b=this,g=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});b.linkedProjectsUrl?g.show().then(function(){dojo.xhrGet({url:b.linkedProjectsUrl,handleAs:"json",load:function(a){a.success&&(b.linkedIds=a.ids,c.addChild(b.createBreakdownGrid()));g.hide()},error:function(a){}})}):
c.addChild(b.createBreakdownGrid());a.addChild(c)},createToolbar:function(){var a=new dijit.Toolbar({region:"top",style:"outline:none!important;border:none;padding:2px;width:100%;"});a.addChild(new dijit.form.Button({label:e.close,iconClass:"icon-16-container icon-16-container icon-16-close",style:"float:right;",onClick:dojo.hitch(this,"close")}));return a},getGridStructure:function(){return[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:m},{name:e.description,field:"description",
width:"auto",formatter:n},{name:e.status,field:"status",width:"100px",styles:"text-align: center;"}]},createStackContainer:function(){var a="billItemsLinker"+this.item.id+"-stackContainer",c=this.stackContainer=new dijit.layout.StackContainer({style:"border:0px;width:100%;height:100%;",region:"center",id:a});dojo.subscribe(a+"-selectChild","",function(b){var c=dijit.byId(a);if(c){var d=c.getChildren();b=dojo.indexOf(d,b);b+=1;if(d.length>b)for(;d.length>b;)c.removeChild(d[b]),d[b].destroyDescendants(),
d[b].destroyRecursive(),b+=1}});var b=new dijit.layout.StackController({region:"top",containerId:a}),b=new dijit.layout.ContentPane({style:"padding:0px;overflow:hidden;",baseClass:"breadCrumbTrail",region:"top",id:"costDataLinkBillItems"+this.costData.id+"-controllerPane",content:b});this.addChild(c);this.addChild(b);return c},createBreakdownGrid:function(){var a=this,c=a.grid=l({costData:a.costData,structure:a.getGridStructure(),linkedIds:a.linkedIds,store:new dojo.data.ItemFileWriteStore({clearOnClose:!0,
url:"costData/getLinkBillItemProjectsList/costData/"+a.costData.id}),onRowDblClick:function(b){b=this.getItem(b.rowIndex);0<b.id[0]&&a.createBillListingGrid(b)}});return new dijit.layout.ContentPane({style:"padding:0px;border:none;width:100%;height:100%;",region:"center",content:c,grid:c})},createBillListingGrid:function(a){a=new k({title:buildspace.truncateString(a.description,60),moduleContainer:this,costData:this.costData,item:a});this.stackContainer.addChild(a);this.stackContainer.selectChild(a)},
close:function(){this.parentContainer.removeChild(this);return this.destroyRecursive()}})});
