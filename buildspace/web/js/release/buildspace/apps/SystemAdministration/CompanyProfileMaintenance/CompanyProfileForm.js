(function(){define("buildspace/apps/SystemAdministration/CompanyProfileMaintenance/CompanyProfileForm","dojo/_base/declare dojo/on dojo/_base/lang dojo/dom-form dojo/html dojo/dom dojo/dom-attr dojo/dom-style dojo/_base/array dojox/form/Manager dojox/validate/regexp dojox/validate/web dijit/form/Form dojox/form/PasswordValidator dijit/form/ValidationTextBox dijit/form/Textarea dijit/form/DateTextBox dijit/form/RadioButton dijit/form/Select dijit/form/FilteringSelect dijit/_WidgetBase dijit/_OnDijitClickMixin dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/companyProfileForm.html dojo/i18n!buildspace/nls/CompanyProfile".split(" "),
function(h,k,u,v,w,x,l,f,y,z,A,B,C,D,E,F,G,H,I,g,m,n,p,q,r,e){var t=h("buildspace.apps.SystemAdministration.CompanyProfileMaintenance.CompanyProfileForm",[m,n,p,q],{templateString:r,baseClass:"buildspace-form",region:"center",style:"border:none;overflow:auto;",data:null,nls:e,constructor:function(b){return b.data.company_logo?this.imgPath=require.toUrl("images/company_logo/"+b.data.company_logo):this.imgPath=require.toUrl("images/profiles/default_user-icon.jpg")},postCreate:function(){var b,a;this.inherited(arguments);
b=this;a=new dojox.form.Uploader({label:b.nls.changeCompanyLogoPic,uploadOnSelect:!0,url:"systemAdministration/uploadMyCompanyLogo",styles:"padding: 5px;",name:"my_company_profile[company_logo]"});k(a,"Begin",function(a){b.pb=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});a=b["error-company_logo"];a.innerHTML=null;f.set(a,"display","none");return b.pb.show()});k(a,"Complete",function(a){var c;b.pb.hide();c=b["error-company_logo"];if(a.success)return c.innerHTML=null,f.set(c,
"display","none"),l.set(b.companyLogoPhoto,"src",a.imgURL);c.innerHTML=a.errorMsgs.company_logo;return f.set(c,"display","block")});return this.myCompanyLogoUploader.appendChild(a.domNode)},startup:function(){var b,a,d,c;this.inherited(arguments);a=this;b=new dojo.data.ItemFileReadStore({url:"projectBuilder/getCountry"});this.stateSelectStore=d=new dojo.data.ItemFileReadStore({url:"projectBuilder/getStateByCountry/regionId/"+a.data["my_company_profile[region_id]"]});c=new dojo.data.ItemFileReadStore({data:a.data.timezones});
this.countrySelect=(new g({name:"my_company_profile[region_id]",store:b,style:"padding:3px;width:178px;",searchAttr:"name",value:a.data["my_company_profile[region_id]"],required:!0,onChange:function(b){b?a.stateSelect.set("readOnly",!1):a.stateSelect.set("readOnly",!0);return a.updateStateSelectStore(b)}})).placeAt(a.countrySelectDivNode);this.stateSelect=(new g({name:"my_company_profile[subregion_id]",store:d,style:"padding:3px;width:178px;",required:!1,searchAttr:"name",readOnly:0<a.data["my_company_profile[subregion_id]"]?
!1:!0,value:a.data["my_company_profile[subregion_id]"]})).placeAt(a.stateSelectDivNode);this.timezoneSelect=(new g({name:"my_company_profile[timezone]",store:c,style:"padding:3px;width:240px;",required:!0,searchAttr:"name",value:a.data["my_company_profile[timezone]"]})).placeAt(a.timezoneSelectDiv);return this.myCompanyProfileForm.setFormValues(this.data)},updateStateSelectStore:function(b){null==b&&(b=0);b||(b=0);this.stateSelectStore=new dojo.data.ItemFileReadStore({url:"projectBuilder/getStateByCountry/regionId/"+
b,clearOnClose:!0});this.stateSelect.store.close();this.stateSelect.set("store",this.stateSelectStore);return this.stateSelect.set("value","")},save:function(){var b,a;if(!this.myCompanyProfileForm.validate())return!1;b=dojo.formToObject(this.myCompanyProfileForm.id);a=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});a.show().then(function(){dojo.xhrPost({url:"systemAdministration/updateCompanyProfile",handleAs:"json",content:b,load:function(b){a.hide()},error:function(b){return a.hide()}})})}});
return h("buildspace.apps.SystemAdministration.CompanyProfileMaintenance.CompanyProfileFormContainer",dijit.layout.BorderContainer,{region:"top",style:"padding:0px;width:100%;height:100%;",gutters:!1,data:null,nls:e,postCreate:function(){var b,a;this.inherited(arguments);a=this;b=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});b.show().then(function(){dojo.xhrGet({url:"systemAdministration/getCompanyProfile",handleAs:"json",load:function(d){var c;b.hide();d=new t({data:d});
c=new dijit.Toolbar({region:"top",style:"outline:none!important;border-bottom: 1px solid #ccc;border-top:none;border-left:none;border-right:none;padding:2px;width:100%;"});c.addChild(new dijit.form.Button({label:e.save,iconClass:"icon-16-container icon-16-save",style:"outline:none!important;",onClick:dojo.hitch(d,"save")}));a.addChild(c);return a.addChild(d)},error:function(a){return b.hide()}})})}})})}).call(this);
