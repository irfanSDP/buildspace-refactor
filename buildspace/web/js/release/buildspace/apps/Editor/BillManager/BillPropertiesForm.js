define("buildspace/apps/Editor/BillManager/BillPropertiesForm","dojo/_base/declare dojo/html dojo/dom dojo/dom-construct dojo/keys dojo/dom-style dojo/dom-attr dojo/dom-geometry dojo/number dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/billPropertiesForm.html dojo/text!./templates/columnSettingsForm.html dojo/i18n!buildspace/nls/Tendering".split(" "),function(d,b,r,t,u,k,v,l,w,e,f,g,m,n,c){var p=d("buildspace.apps.Editor.BillManager.ColumnSettingsForm",
[e,f,g],{count:0,billId:-1,columnSettingName:"",columnSettingQuantity:"",columnId:-1,quantity:1,templateString:n,postCreate:function(){this.inherited(arguments);this.setValues()},setValues:function(){b.set(this.nameViewDivNode,this.columnSettingName);b.set(this.quantityViewDivNode,""+this.columnSettingQuantity+"")}}),q=d("buildspace.apps.Editor.BillManager.BillPropertiesMainInfoForm",[e,f,g],{templateString:m,baseClass:"buildspace-form",region:"top",billId:-1,projectBreakdownGrid:null,formData:null,
unitTypeText:null,description:null,nls:c,style:"padding:5px;overflow:auto;border:0px;height:140px;",constructor:function(){var a=this.BillTypeConstantArray=[];a[buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_STANDARD]=buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_STANDARD_TEXT;a[buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PRELIMINARY]=buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PRELIMINARY_TEXT;a[buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PROVISIONAL]=
buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PROVISIONAL_TEXT;a[buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PROVISIONAL]=buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PROVISIONAL_TEXT;a[buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PRIMECOST]=buildspace.apps.Editor.ProjectStructureConstants.BILL_TYPE_PRIMECOST_TEXT;this.currencyAbbreviation=buildspace.billCurrencyAbbreviation?buildspace.billCurrencyAbbreviation:buildspace.currencyAbbreviation;
this.inherited(arguments)},postCreate:function(){this.inherited(arguments);b.set(this.titleNode,this.formData["bill_setting[title]"]);b.set(this.descriptionNode,this.formData["bill_setting[description]"]);b.set(this.unitTypeTextNode,this.unitTypeText);b.set(this.billTypeTextNode,this.BillTypeConstantArray[this.formData.billType])},startup:function(){this.inherited(arguments)}});return d("buildspace.apps.Editor.BillManager.BillPropertiesForm",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;margin:0px;border:0px;height:100%;overflow:auto;",
gutters:!1,region:"center",billId:-1,projectBreakdownGrid:null,nls:c,totalColumnSettings:0,postCreate:function(){this.inherited(arguments);var a=this,b=buildspace.dialog.indeterminateProgressBar({title:c.pleaseWait+"..."});b.show().then(function(){dojo.xhrGet({url:"billProperties/"+a.billId,handleAs:"json",load:function(h){a.renderBillPropertiesInfoForm(h.bill_setting);a.renderBillColumnSettings(h.column_settings);a.resize();b.hide()},error:function(a){b.hide()}})})},renderBillPropertiesInfoForm:function(a){a=
this.mainForm=new q({billId:this.billId,projectBreakdownGrid:this.projectBreakdownGrid,unitTypeText:a.unit_type_text,formData:a});this.addChild(a)},renderBillColumnSettings:function(a){var b=this.billId;d("ColumnSettingTableWidget",[e,f,g],{style:"padding:5px;overflow:auto;border:0px;overflow:auto;",region:"bottom",baseClass:"buildspace-form",totalColumnSettings:0,columnSettings:a,templateString:"<div><fieldset><legend>"+c.columnSettings+'</legend><div style="height:2px;">&nbsp;</div><table class="buildspace-table"><thead><tr class="gridHeader"><th class="gridCell" style="text-align:center;" rowspan="2">No.</th><th class="gridCell" rowspan="2">'+
c.name+'</th><th class="gridCell" style="text-align: center;" rowspan="2">'+c.totalUnit+'</th></tr><tbody id="columnSettingTbody-'+b+'" data-dojo-attach-point="columnSettingsTBody"></tbody></table></fieldset></div>',postCreate:function(){this.inherited(arguments);var a=this,c=0;dojo.forEach(this.columnSettings,function(d,h){a.updateTotalColumnSettings(!0);c=a.totalColumnSettings;var e=new p({count:c,columnSettingName:d.name,columnSettingQuantity:d.quantity,columnId:d.id,billId:b});e.placeAt(a.columnSettingsTBody);
dojo.parser.parse(e.domNode)},a)},updateTotalColumnSettings:function(a){this.totalColumnSettings=a?this.totalColumnSettings+1:this.totalColumnSettings-1}});this.columnSettingsTable=new ColumnSettingTableWidget;this.addChild(this.columnSettingsTable)},resize:function(){var a=l.getContentBox(this.domNode).h-125;this.columnSettingsTable&&k.set(this.columnSettingsTable.domNode,"height",a+"px");this.inherited(arguments)}})});
