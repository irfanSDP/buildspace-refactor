define("buildspace/apps/Editor/BillManager","dojo/_base/declare dojo/dom-style dojo/when dojo/currency dijit/layout/AccordionContainer dijit/layout/ContentPane dojox/grid/EnhancedGrid ./BillManager/BillPropertiesForm ./BillManager/BillGrid buildspace/apps/Tendering/BillManager/primeCostRateDialog buildspace/apps/Tendering/BillManager/lumpSumPercentDialog buildspace/widget/grid/cells/Formatter dojo/aspect dojo/i18n!buildspace/nls/Tendering".split(" "),function(g,v,l,w,x,y,z,m,k,n,p,A,q,h){g("buildspace.apps.Editor.BillPrintingSettingContainer",
dijit.layout.BorderContainer,{style:"padding:0px;width:100%;margin:0px;border:0px;height:100%;",gutters:!1,billId:null,postCreate:function(){this.inherited(arguments)}});var r=g("buildspace.apps.Editor.BillPropertiesContainer",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;margin:0px;border:0px;height:100%;",gutters:!1,bill:null,projectBreakdownGrid:null,billElementObj:null,postCreate:function(){this.inherited(arguments);var a=this.billPropertiesForm=m({billId:String(this.bill.id),projectBreakdownGrid:this.projectBreakdownGrid,
billElementObj:this.billElementObj,locked:!0});this.addChild(a)}}),u=g("buildspace.apps.Editor.BillElementContainer",dijit.layout.BorderContainer,{style:"padding:0;margin:0;border:none;width:100%;height:100%;",gutters:!1,bill:null,project:null,columnData:null,projectBreakdownGrid:null,currentPrintableRevision:null,currentBillVersion:0,postCreate:function(){this.inherited(arguments);this.createElementGrid();var a=String(this.bill.id);dojo.subscribe("billGrid"+a+"-stackContainer-selectChild","",function(d){var c=
dijit.byId("billGrid"+a+"-stackContainer");if(c){var b=c.getChildren(),e=dojo.indexOf(b,d),e=e+1;if(b.length>e){for(;b.length>e;)c.removeChild(b[e]),b[e].destroyDescendants(),b[e].destroyRecursive(),e+=1;if(d.grid){var f=d.grid.selection.selectedIndex;d.grid.store.save();d.grid.store.close();var t=q.after(d.grid,"_onFetchComplete",function(){t.remove();-1<f&&(this.scrollToRow(f),this.selection.setSelected(f,!0))});d.grid.sort()}}}})},createElementGrid:function(){var a=dijit.byId("billGrid"+String(this.bill.id)+
"-stackContainer");a&&dijit.byId("billGrid"+String(this.bill.id)+"-stackContainer").destroyRecursive();var a=this.stackContainer=new dijit.layout.StackContainer({style:"border:0px;width:100%;height:100%;",region:"center",id:"billGrid"+String(this.bill.id)+"-stackContainer"}),d=dojo.data.ItemFileWriteStore({url:"billElements/"+String(this.bill.id),clearOnClose:!0,urlPreventCache:!0}),c=this;dojo.xhrGet({url:"billInfo/"+String(this.bill.id),handleAs:"json"}).then(function(b){c.currentPrintableRevision=
b.printable_project_revision;c.currentBillVersion=b.current_bill_version;c.currentBillType=b.bill_type.type;var e=new k({stackContainerTitle:"Element",bill:c.bill,project:c.project,pageId:"element-page-"+String(c.bill.id),id:"element-page-container-"+String(c.bill.id),gridOpts:{store:d,typeColumns:b.column_settings,bqCSRFToken:b._csrf_token,currentPrintableRevision:c.currentPrintableRevision,currentBillVersion:c.currentBillVersion,currentBillType:c.currentBillType,currentGridType:"element",onRowDblClick:function(a){(a=
this.getItem(a.rowIndex))&&!isNaN(parseInt(a.id.toString()))&&null!==a.description.toString()&&""!==a.description.toString()&&c.createItemGrid(a,b,e)}}}),f=new dijit.layout.StackController({region:"top",containerId:"billGrid"+String(c.bill.id)+"-stackContainer"});c.addChild(a);c.addChild(new dijit.layout.ContentPane({style:"padding:0px;overflow:hidden;",baseClass:"breadCrumbTrail",region:"top",id:"billGrid"+String(c.bill.id)+"-controllerPane",content:f}))})},createItemGrid:function(a,d,c){var b=this,
e=new dojo.data.ItemFileWriteStore({url:"billItems/"+a.id,clearOnClose:!0}),f=dojo.xhrGet({url:"billUnits/"+String(b.bill.id),handleAs:"json"}),g=buildspace.dialog.indeterminateProgressBar({title:h.pleaseWait+"..."});g.show().then(function(){l(f,function(f){g.hide();new k({stackContainerTitle:a.description,bill:b.bill,project:b.project,id:"item-page-container-"+String(b.bill.id),elementId:a.id,pageId:"item-page-"+String(b.bill.id),type:"tree",gridOpts:{store:e,escapeHTMLInData:!1,typeColumns:d.column_settings,
unitOfMeasurements:f,elementGridStore:c,rowUpdateUrl:"billManager/itemUpdate",currentBillType:b.currentBillType,currentBillVersion:b.currentBillVersion,currentGridType:"item",editableCellDblClick:function(a){var e=a.cell.field;a=this.getItem(a.rowIndex);var d=this.store;if(a&&void 0!==a.project_revision_deleted_at&&a.project_revision_deleted_at[0])return!1;if(a&&!isNaN(parseInt(a.id.toString()))&&"rate-value"==e){var f;switch(a.type.toString()){case buildspace.widget.grid.constants.HIERARCHY_TYPE_ITEM_PC_RATE:f=
new n({itemObj:a,billGridStore:d,elementGridStore:c,currentBillLockedStatus:b.currentBillLockedStatus,currentBillVersion:b.currentBillVersion,currentItemVersion:a.version.toString(),disableEditingMode:!0});break;case buildspace.widget.grid.constants.HIERARCHY_TYPE_ITEM_LUMP_SUM_PERCENT:f=new p({itemObj:a,billGridStore:d,elementGridStore:c,currentBillLockedStatus:b.currentBillLockedStatus,currentBillVersion:b.currentBillVersion,currentItemVersion:a.version.toString(),disableEditingMode:!0})}f&&f.show()}}}})})})},
reconstructBillContainer:function(){dijit.byId("billGrid"+String(this.bill.id)+"-controllerPane").destroyRecursive();dijit.byId("billGrid"+String(this.bill.id)+"-stackContainer").destroyRecursive();this.createElementGrid()}});return g("buildspace.apps.Editor.BillManager",dijit.layout.TabContainer,{region:"center",project:null,nested:!0,style:"padding:0;border:none;margin:0;width:100%;height:100%;",bill:null,billLayoutSettingId:null,projectBreakdownGrid:null,postCreate:function(){this.inherited(arguments);
this.addChild(new u({id:"bill_element_container_"+this.project.id+"-bill-"+String(this.bill.id),title:h.elementTradeList,project:this.project,bill:this.bill,projectBreakdownGrid:this.projectBreakdownGrid}));this.addChild(new r({title:h.billProperties,bill:this.bill,projectBreakdownGrid:this.projectBreakdownGrid,billType:this.billType}))}})});
