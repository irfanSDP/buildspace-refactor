define("buildspace/apps/PostContractSubPackageReport/VariationOrder/VariationOrderClaim","dojo/_base/declare dojo/_base/lang dojo/_base/html dijit/focus dojo/_base/event dojo/keys dojox/grid/EnhancedGrid buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/PostContract".split(" "),function(e,p,q,f,r,t,g,h,d){var k=function(b,a,c){a=this.grid.getItem(a);c.customClasses.push("disable-cell");return 0<a.id?d.version+" "+d.no+" "+b:"&nbsp;"},l=function(b,a,c){if(0<this.grid.getItem(a).id)return b?
'<span class="icon-16-container icon-16-checkmark2" style="margin:0px auto; display:block;"></span>':'<a href="#" onclick="return false;">'+d.printThisRevision+"</a>";c.customClasses.push("disable-cell");return"&nbsp;"},m=function(b,a,c){a=this.grid.getItem(a);a.can_be_edited[0]||c.customClasses.push("disable-cell");return 0<a.id?1==parseInt(b)?d.addendumProgressing:d.addendumLocked:"&nbsp;"},n=e("buildspace.apps.PostContractSubPackageReport.VariationOrder.VariationOrderClaimEnhancedGrid",g,{style:"border-top:none;",
rowSelector:"0px",variationOrder:null,variationOrderItemContainer:null,region:"center",constructor:function(b){var a=new h;this.store=new dojo.data.ItemFileWriteStore({url:"variationOrder/getSpClaimList/id/"+b.variationOrder.id,clearOnClose:!0});this.structure=[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:a.rowCountCellFormatter},{name:d.claimVersion,field:"revision",width:"auto",formatter:k},{name:d.currentPrintingRevision,field:"is_viewing",width:"140px",styles:"text-align: center;",
formatter:l},{name:d.status,field:"status",width:"120px",styles:"text-align: center;",formatter:m},{name:d.lastUpdated,field:"updated_at",width:"120px",styles:"text-align: center;"}]},canSort:function(b){return!1},postCreate:function(){var b=this;b.inherited(arguments);this.on("CellClick",function(a){var c=a.cell.field;a=b.getItem(a.rowIndex);"is_viewing"==c&&a&&0<a.id&&!a.is_viewing[0]&&b.changeCurrentViewingRevision(a)})},changeCurrentViewingRevision:function(b){var a=this,c=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+
"..."});f.curNode.blur();f.curNode=null;c.show();dojo.xhrPost({url:"variationOrder/viewSpClaimRevision",content:{id:b.id,_csrf_token:b._csrf_token},handleAs:"json",load:function(b){if(b.success){var d=a.store;dojo.forEach(b.items,function(a){d.fetchItemByIdentity({identity:a.id,onItem:function(b){for(var c in a)b.hasOwnProperty(c)&&c!=d._getIdentifierAttribute()&&d.setValue(b,c,a[c])}})});d.save();dojo.xhrGet({url:"variationOrder/getSpClaimStatus",content:{id:a.variationOrder.id},handleAs:"json"}).then(function(b){dojo.xhrGet({url:"variationOrder/getUnits",
handleAs:"json"}).then(function(c){a.variationOrderItemContainer.createVariationOrderItemGrid(c,b,!1)})})}c.hide();a.selection.clear()},error:function(b){a.selection.clear();c.hide()}})}});return e("buildspace.apps.PostContractSubPackageReport.VariationOrder.VariationOrderClaim",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;",gutters:!1,variationOrder:null,variationOrderItemContainer:null,claimStatus:null,postCreate:function(){this.inherited(arguments);var b=new n({variationOrder:this.variationOrder,
variationOrderItemContainer:this.variationOrderItemContainer});this.addChild(new dijit.layout.ContentPane({style:"width:100%",content:b,region:"center"}))}})});
