define("buildspace/apps/ViewTendererReport/BillGrid","dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/dom-attr dojo/json dojo/request dojo/aspect dijit/Menu dojox/grid/enhanced/plugins/Rearrange dojox/grid/enhanced/plugins/IndirectSelection buildspace/widget/grid/plugins/FormulatedColumn dojo/_base/event dojo/keys dijit/focus dojo/store/Memory dijit/DropDownMenu dijit/form/DropDownButton dijit/MenuItem dijit/PopupMenuItem buildspace/widget/grid/cells/Formatter ./PrintPreviewDialog/PrintSelectedElementGridDialog ./PrintPreviewDialog/PrintSelectedElementRevisionsGridDialog ./PrintPreviewDialog/PrintSelectedItemRateGridDialog ./PrintPreviewDialog/PrintSelectedItemTotalGridDialog ./PrintPreviewDialog/PrintSelectedItemRateAndTotalGridDialog ./PrintPreviewDialog/PrintSelectedItemRateAndTotalRevisionsGridDialog ./PrintPreviewDialog/PrintSelectedItemRateAndTotalPerUnitGridDialog ./PrintPreviewDialog/PrintSelectedElementByTypeAndTendererGridDialog dojo/i18n!buildspace/nls/TenderingReport".split(" "),
function(r,x,q,J,K,k,l,B,n,L,M,N,O,P,Q,t,u,w,m,p,C,v,D,y,z,E,F,G,H,f){var I=r("buildspace.apps.ViewTendererReport.BillGrid",dojox.grid.EnhancedGrid,{type:null,billId:-1,elementId:0,itemId:-1,style:"border-top:none;",selectedItem:null,borderContainerWidget:null,keepSelection:!0,rowSelector:"0px",headerMenu:null,typeColumns:null,markupSettings:null,parentGrid:null,elementGridStore:null,project:null,gridContainer:null,constructor:function(a){this.type=a.type;this.billId=a.billId;this.elementId=a.elementId;
this.itemId=a.itemId;this.hierarchyTypes=a.hierarchyTypes;this.hierarchyTypesForHead=a.hierarchyTypesForHead;this.unitOfMeasurements=a.unitOfMeasurements;this.columnGroup=a.columnGroup;this.typeColumns=a.typeColumns;this.tender_setting=a.tender_setting;this.tender_companies=a.tender_companies;this.currencySetting=buildspace.billCurrencyAbbreviation?buildspace.billCurrencyAbbreviation:buildspace.currencyAbbreviation;this.gridContainer=a.gridContainer;var b=this.formatter=new C;this.companyColumnChildren=
[{name:f.rate,field_name:"rate-value",width:"85px",styles:"text-align:right;",formatter:b.companyRateCurrencyCellFormatter},{name:f.grandTotal,field_name:"grand_total_after_markup",width:"100px",styles:"text-align:right;",formatter:b.unEditableCurrencyCellFormatter}];this.setColumnStructure();this.plugins={indirectSelection:{headerSelector:!0,width:"40px",styles:"text-align: center;"}};this.inherited(arguments)},postCreate:function(){var a=this;a.inherited(arguments);var b="tree"===a.type?"viewTendererItemPreviewStore":
"viewTendererElementPreviewStore";B.after(a,"_onFetchComplete",function(){a.gridContainer.markedCheckBoxObject(a,a.gridContainer[b][a.billId])})},startup:function(){var a=this;a.inherited(arguments);this._connects.push(q.connect(this,"onCellClick",function(b){""===b.cell.name&&a.singleCheckBoxSelection(b)}));this._connects.push(q.connect(this.rowSelectCell,"toggleAllSelection",function(b){a.toggleAllSelection(b)}))},singleCheckBoxSelection:function(a){var b=a.rowIndex;a=this.selection.selected[b];
b=this.getItem(b);return a?"tree"===this.type?this.getAffectedElementAndBillsByItems(b,"add"):this.getAffectedItemsAndBillsByElement(b,"add"):"tree"===this.type?this.getAffectedElementAndBillsByItems(b,"remove"):this.getAffectedItemsAndBillsByElement(b,"remove")},toggleAllSelection:function(a){var b=this,c=this.selection;var d="tree"===b.type?"viewTendererItemPreviewStore":"viewTendererElementPreviewStore";if(a)return c.selectRange(0,b.rowCount-1),b.store.fetch({onComplete:function(a){dojo.forEach(a,
function(a,c){0<a.id&&b.gridContainer[d][b.billId].put({id:a.id[0]})})}}),"tree"===b.type?b.getAffectedElementAndBillsByItems(null,"add"):b.getAffectedItemsAndBillsByElement(null,"add");c.deselectAll();return"tree"===b.type?(b.store.fetch({onComplete:function(a){dojo.forEach(a,function(a,c){0<a.id&&b.gridContainer[d][b.billId].remove(a.id[0])})}}),b.getAffectedElementAndBillsByItems(null,"remove")):b.getAffectedItemsAndBillsByElement(null,"remove")},getAffectedItemsAndBillsByElement:function(a,b){var c=
this,d=c.gridContainer.viewTendererElementPreviewStore[c.billId],e=[],g=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});g.show();a?(c.gridContainer.viewTendererElementPreviewStore[c.billId].put({id:a.id[0]}),e.push(a.id[0])):d.query().forEach(function(a){e.push(a.id)});l.post("viewTendererReporting/getAffectedBillsAndItems",{handleAs:"json",data:{bill_id:c.billId,element_ids:k.stringify(c.borderContainerWidget.arrayUnique(e))}}).then(function(a){var e=dijit.byId("viewTenderer-bill-page-container-"+
c.project.id);if("add"===b)for(var d in a){e.store.fetchItemByIdentity({identity:d,onItem:function(a){if(a)return c.gridContainer.viewTendererBillPreviewStore.put({id:d}),e.rowSelectCell.toggleRow(a._0,!0)}});for(var f in a[d])for(var h in a[d][f])c.gridContainer.viewTendererItemPreviewStore[c.billId].put({id:a[d][f][h]})}else for(d in a){for(f in a[d])for(h in c.gridContainer.viewTendererElementPreviewStore[c.billId].remove(f),a[d][f])c.gridContainer.viewTendererItemPreviewStore[c.billId].remove(a[d][f][h]);
e.store.fetchItemByIdentity({identity:d,onItem:function(a){if(a&&0===c.gridContainer.viewTendererElementPreviewStore[c.billId].data.length)return c.gridContainer.viewTendererBillPreviewStore.remove(d),e.rowSelectCell.toggleRow(a._0,!1)}})}g.hide()},function(a){g.hide();console.log(a)})},getAffectedElementAndBillsByItems:function(a,b){var c=this,d=[],e=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});e.show();a&&("remove"===b?c.gridContainer.viewTendererItemPreviewStore[c.billId].remove(a.id[0]):
c.gridContainer.viewTendererItemPreviewStore[c.billId].put({id:a.id[0]}));c.gridContainer.viewTendererItemPreviewStore[c.billId].query().forEach(function(a){d.push(a.id)});l.post("viewTendererReporting/getAffectedBillsAndElements",{handleAs:"json",data:{bill_id:c.billId,itemIds:k.stringify(c.borderContainerWidget.arrayUnique(d))}}).then(function(a){c.gridContainer.viewTendererBillPreviewStore=new t({idProperty:"id"});c.gridContainer.viewTendererElementPreviewStore[c.billId]=new t({idProperty:"id"});
c.updateElementAndBillGridSelectBox(a);e.hide()},function(a){e.hide();console.log(a)})},updateElementAndBillGridSelectBox:function(a){var b=this,c=dijit.byId("viewTenderer-bill-page-container-"+b.project.id),d=dijit.byId("viewTenderer-element-page-container-"+b.billId);c.store.fetch({onItem:function(a){if(a)return c.rowSelectCell.toggleRow(a._0,!1)}});d.grid.store.fetch({onItem:function(a){if(a)return d.grid.rowSelectCell.toggleRow(a._0,!1)}});for(var e in a){c.store.fetchItemByIdentity({identity:e,
onItem:function(a){if(a)return b.gridContainer.viewTendererBillPreviewStore.put({id:e}),c.rowSelectCell.toggleRow(a._0,!0)}});for(var g in a[e])d.grid.store.fetchItemByIdentity({identity:g,onItem:function(a){if(a)return b.gridContainer.viewTendererElementPreviewStore[b.billId].put({id:g}),d.grid.rowSelectCell.toggleRow(a._0,!0)}})}},pushIntoStore:function(a,b){a&&a.id&&b.put({id:a.id[0]});return b},removeFromStore:function(a,b){a&&a.id&&b.remove(a.id[0]);return b},dodblclick:function(a){if(a.cellNode)if(a.cell.editable)this.editableCellDblClick(a);
else this.onCellDblClick(a);else this.onRowDblClick(a)},editableCellDblClick:function(a){var b=1<this._click.length&&has("ie")?this._click[1]:1<this._click.length&&this._click[0].rowIndex!=this._click[1].rowIndex?this._click[0]:a;this.focus.setFocusCell(b.cell,b.rowIndex);this.onRowClick(b);this.onRowDblClick(a)},setColumnStructure:function(){var a=this.formatter,b="auto";if("tree"==this.type){0<this.tender_companies.length&&(b="500px");a=this.fixedColumns={noscroll:!1,width:57.8,cells:[[{name:"No",
field:"id",styles:"text-align:center;",width:"30px",formatter:a.rowCountCellFormatter,noresize:!0,showInCtxMenu:!0,rowSpan:2},{name:f.billReference,field:"bill_ref",styles:"text-align:center; color: red;",width:"80px",noresize:!0,showInCtxMenu:!0,formatter:a.billRefCellFormatter,rowSpan:2,hidden:!1},{name:f.description,field:"description",width:b,formatter:a.treeCellFormatter,noresize:!0,showInCtxMenu:!0,rowSpan:2},{name:f.type,field:"type",width:"70px",styles:"text-align:center;",formatter:a.typeCellFormatter,
noresize:!0,showInCtxMenu:!0,rowSpan:2},{name:f.unit,field:"uom_id",width:"50px",styles:"text-align:center;",formatter:a.unitIdCellFormatter,noresize:!0,showInCtxMenu:!0,rowSpan:2},{name:f.grandTotalQty,field:"grand_total_quantity",styles:"text-align:right;color:blue;",width:"90px",formatter:a.unEditableNumberCellFormatter,noresize:!0,showInCtxMenu:!0,rowSpan:2},{name:f.rate,field:"rate_after_markup",styles:"text-align:right;",width:"75px",formatter:a.rateAfterMarkupCellFormatter,noresize:!0,rowSpan:2},
{name:f.grandTotal,field:"grand_total_after_markup",styles:"text-align:right;color:blue;",width:"100px",formatter:a.unEditableCurrencyCellFormatter,noresize:!0,showInCtxMenu:!0,rowSpan:2}]]};b=[];var c=this.generateContractorRateColumn(a)}else 5<this.tender_companies.length&&(b="480px"),a=this.fixedColumns={noscroll:!1,width:"50",cells:[[{name:"No",field:"id",styles:"text-align:center;",width:"30px",formatter:a.rowCountCellFormatter,noresize:!0},{name:f.description,field:"description",width:b,formatter:a.treeCellFormatter,
noresize:!0},{name:f.grandTotal,field:"overall_total_after_markup",styles:"text-align:right;color:blue;",width:"100px",formatter:a.unEditableCurrencyCellFormatter,noresize:!0,showInCtxMenu:!0}]]},b=this.generateContractorGrandTotalColumn(),c=a;dojo.forEach(b,function(a){c.cells[0].push(a)});this.structure=c},generateContractorRateColumn:function(a){var b=this.companyColumnChildren,c=[],d=0;dojo.forEach(this.tender_companies,function(e){var g=b.length;d++;var f=e.awarded?'<span style="color:blue;">'+
buildspace.truncateString(e.name,28)+"</span>":buildspace.truncateString(e.name,28);c.push({name:f,styles:"text-align:center;",headerClasses:"staticHeader typeHeader"+d,colSpan:g,headerId:e.id,hidden:!1});for(i=0;i<b.length;i++)g=e.id+"-"+b[i].field_name,g={field:g,columnType:"contractorColumn",companyId:e.id,headerClasses:"typeHeader"+d},x.mixin(g,b[i]),a.cells[0].push(g)});a.cells.push(c);return a},generateContractorGrandTotalColumn:function(){var a=[],b=this.formatter,c=0;dojo.forEach(this.tender_companies,
function(d){c++;var e=d.awarded?'<span style="color:blue;">'+buildspace.truncateString(d.name,28)+"</span>":buildspace.truncateString(d.name,28);a.push({name:e,field:d.id+"-overall_total_after_markup",styles:"text-align:right;",width:"120px",formatter:b.unEditableCurrencyCellFormatter,headerClasses:"typeHeader"+c,noresize:!0})});return a},canSort:function(a){return!1},onStyleRow:function(a){this.inherited(arguments);if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length){var b=a.node.children[0].children[0].rows[1],
c=a.node.children[0].children[0].rows[0].children;b.parentNode.removeChild(b);dojo.forEach(c,function(a,b){b=dojo.attr(a,"rowSpan");(!b||2>b)&&dojo.attr(a,"rowSpan",2)})}},destroy:function(){this.inherited(arguments);dojo.forEach(this._connects,q.disconnect);delete this._connects}});return r("buildspace.apps.ViewTendererReport.BillGridBuilder",dijit.layout.BorderContainer,{pageId:"page-00",style:"padding:0px;width:100%;height:100%;",gutters:!1,stackContainerTitle:"",rootProject:null,billId:-1,elementId:0,
itemId:-1,rowSelector:null,gridOpts:{},type:null,postCreate:function(){var a=this;a.inherited(arguments);x.mixin(a.gridOpts,{billId:a.billId,project:a.rootProject,elementId:a.elementId,type:a.type,region:"center",borderContainerWidget:a});var b=this.grid=new I(a.gridOpts),c=new dijit.Toolbar({region:"top",style:"outline:none!important; border-bottom:none; padding:2px; width:100%;"}),d=["summaryAllTenderersLowToHighest","summaryAllTenderersHighToLowest"],e=!1;0===a.gridOpts.tender_companies.length&&
(e=!0);0<a.gridOpts.tender_companies.length&&!1===a.gridOpts.tender_companies[0].awarded&&(e=!0);if("element"===this.type){var g=new u({style:"display: none;"}),h=new n,A=new n;dojo.forEach(d,function(b){var c=new m({id:b+"-"+a.rootProject.id+"-"+a.type+"-menuElement",label:f[b],onClick:function(){a.openElementPreviewDialogForAllTenderers(b)}});h.addChild(c);c=new m({id:b+"-"+a.rootProject.id+"-"+a.type+"-revisionMenuElement",label:f[b],onClick:function(){a.openElementRevisionsPreviewDialogForAllTenderers(b)}});
A.addChild(c)});g.addChild(new m({id:a.rootProject.id+"-"+this.type+"-ProjectElementSummarySelectedTenderer-button",label:f.projectSummarySelectedTenderers,iconClass:"icon-16-container icon-16-print",disabled:e,onClick:function(){a.openElementPreviewDialogForSelectedTender()}}));g.addChild(new m({id:a.rootProject.id+"-"+this.type+"-ProjectElementSummaryPerUnitTypeByTenderers-button",label:f.summaryPerUnit,iconClass:"icon-16-container icon-16-print",onClick:function(){a.openElementPreviewDialogAmountPerUnitTypeForSelectedTenderer()}}));
var k=new p({label:f.projectSummaryAllTenderers,iconClass:"icon-16-container icon-16-print",popup:h});g.addChild(k);k=new p({label:f.projectSummaryRevisionsAllTenderers,iconClass:"icon-16-container icon-16-print",popup:A});g.addChild(k);c.addChild(new w({label:f.summary,iconClass:"icon-16-container icon-16-print",dropDown:g}));c.addChild(new dijit.ToolbarSeparator)}g=new u({style:"display: none;"});var l=new n;dojo.forEach(d,function(b){var c=new m({id:b+"-"+a.rootProject.id+"-"+a.type+"-menuItemRate",
label:f[b],onClick:function(){a.openItemRatePreviewDialogForAllTenderers(b)}});l.addChild(c)});g.addChild(new m({id:a.rootProject.id+"-"+this.type+"-ProjectItemRateSelectedTenderer-button",label:f.itemRateSelectedTenderers,iconClass:"icon-16-container icon-16-print",disabled:e,onClick:function(){a.openItemRatePreviewDialogForSelectedTender()}}));k=new p({label:f.itemRateAllTenderers,iconClass:"icon-16-container icon-16-print",popup:l});g.addChild(k);c.addChild(new w({label:f.itemRate,id:a.rootProject.id+
"-"+this.type+"-ProjectItemRateAllTenderersPrint-button",iconClass:"icon-16-container icon-16-print",dropDown:g}));c.addChild(new dijit.ToolbarSeparator);g=new u({style:"display: none;"});var q=new n;dojo.forEach(d,function(b){var c=new m({id:b+"-"+a.rootProject.id+"-"+a.type+"-menuItemTotal",label:f[b],onClick:function(){a.openItemTotalPreviewDialogForAllTenderers(b)}});q.addChild(c)});g.addChild(new m({id:a.rootProject.id+"-"+this.type+"-ProjectItemTotalSelectedTenderer-button",label:f.itemTotalSelectedTenderers,
iconClass:"icon-16-container icon-16-print",disabled:e,onClick:function(){a.openItemTotalPreviewDialogForSelectedTender()}}));e=new p({label:f.itemTotalAllTenderers,iconClass:"icon-16-container icon-16-print",popup:q});g.addChild(e);c.addChild(new w({label:f.itemTotal,id:a.rootProject.id+"-"+this.type+"-ProjectItemTotalAllTenderersPrint-button",iconClass:"icon-16-container icon-16-print",dropDown:g}));c.addChild(new dijit.ToolbarSeparator);e=new u({style:"display: none;"});var r=new n;dojo.forEach(d,
function(b){var c=new m({id:b+"-"+a.rootProject.id+"-"+a.type+"-itemRateAndTotalPerUnitMenu",label:f[b],onClick:function(){a.openItemRateAndTotalPerUnitPreviewDialogForAllTenderers(b)}});r.addChild(c)});g=new p({label:f.itemRateAndTotalPerUnitAllTenderers,iconClass:"icon-16-container icon-16-print",popup:r});e.addChild(g);var t=new n;dojo.forEach(d,function(b){var c=new m({id:b+"-"+a.rootProject.id+"-"+a.type+"-itemRateAndTotalMenu",label:f[b],onClick:function(){a.openItemRateAndTotalPreviewDialogForAllTenderers(b)}});
t.addChild(c)});g=new p({label:f.itemRateAndTotalAllTenderers,iconClass:"icon-16-container icon-16-print",popup:t});e.addChild(g);c.addChild(new w({label:f.itemRateAndTotal,id:a.rootProject.id+"-"+this.type+"-ProjectItemRateAndTotalAllTenderersPrint-button",iconClass:"icon-16-container icon-16-print",dropDown:e}));new u({style:"display: none;"});var v=new n;dojo.forEach(d,function(b){var c=new m({id:b+"-"+a.rootProject.id+"-"+a.type+"-itemRateAndTotalRevisionsMenu",label:f[b],onClick:function(){a.openItemRateAndTotalRevisionsPreviewDialogForAllTenderers(b)}});
v.addChild(c)});d=new p({label:f.itemRateAndTotalRevisionsAllTenderers,iconClass:"icon-16-container icon-16-print",popup:v});e.addChild(d);a.addChild(c);a.addChild(new dijit.layout.ContentPane({style:"width:100%",content:b,region:"center"}));if(b=dijit.byId("viewTendererReportBreakdown"+this.rootProject.id+"-stackContainer"))c=document.createElement("div"),c=new dojox.layout.ContentPane({title:buildspace.truncateString(a.stackContainerTitle,60),id:a.pageId},c),b.addChild(c),c.set("content",a),b.selectChild(a.pageId)},
openElementPreviewDialogForSelectedTender:function(){var a=this,b=a.gridOpts.tender_companies,c=[];a.gridOpts.gridContainer.viewTendererElementPreviewStore[a.billId].query().forEach(function(a){c.push(a.id)});var d=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});d.show();l.post("viewTendererReporting/getPrintingSelectedElementByTenderer",{handleAs:"json",data:{bill_id:a.billId,elementIds:k.stringify(a.arrayUnique(c))}}).then(function(e){var g,h;dojo.forEach(b,function(a){a.awarded&&
(g=a.id,h=buildspace.truncateString(a.name,28))});(new v({title:f.projectSummarySelectedTenderers,companyId:g,companyName:h,data:e,billId:a.billId,selectedElements:c})).show();d.hide()},function(a){console.log(a);d.hide()})},openElementPreviewDialogForAllTenderers:function(a){var b=this,c=b.gridOpts.tender_companies,d=b.gridOpts.gridContainer.viewTendererElementPreviewStore[b.billId],e=[],g=[];b.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){e.push(a.id)});d.query().forEach(function(a){g.push(a.id)});
var h=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});h.show();l.post("viewTendererReporting/getPrintingSelectedElementByAllTenderer",{handleAs:"json",data:{bill_id:b.billId,tendererIds:k.stringify(b.arrayUnique(e)),elementIds:k.stringify(b.arrayUnique(g)),type:a}}).then(function(d){(new v({project:b.rootProject,title:f.projectSummaryAllTenderers+" ("+f[a]+")",companies:c,data:d,selectedTenderers:e,selectedElements:g,billId:b.billId,type:a})).show();h.hide()},function(a){console.log(a);
h.hide()})},openItemRatePreviewDialogForSelectedTender:function(){var a=this,b=a.gridOpts.tender_companies,c=[];a.gridOpts.gridContainer.viewTendererItemPreviewStore[a.billId].query().forEach(function(a){c.push(a.id)});var d=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});d.show();l.post("viewTendererReporting/getPrintingSelectedItemRateByTenderer",{handleAs:"json",data:{bill_id:a.billId,itemIds:k.stringify(a.arrayUnique(c))}}).then(function(e){var g,h;dojo.forEach(b,function(a){a.awarded&&
(g=a.id,h=buildspace.truncateString(a.name,28))});(new y({project:a.rootProject,title:f.itemRateSelectedTenderers,companyId:g,companyName:h,data:e,billId:a.billId,elementId:a.elementId,selectedItems:c})).show();d.hide()},function(a){console.log(a);d.hide()})},openItemRatePreviewDialogForAllTenderers:function(a){var b=this,c=b.gridOpts.tender_companies,d=b.gridOpts.gridContainer.viewTendererItemPreviewStore[b.billId],e=[],g=[];b.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){e.push(a.id)});
d.query().forEach(function(a){g.push(a.id)});var h=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});h.show();l.post("viewTendererReporting/getPrintingSelectedItemRateByAllTenderer",{handleAs:"json",data:{bill_id:b.billId,tendererIds:k.stringify(b.arrayUnique(e)),itemIds:k.stringify(b.arrayUnique(g)),type:a}}).then(function(d){(new y({project:b.rootProject,title:f.itemRateAllTenderers+" ("+f[a]+")",companies:c,data:d,selectedTenderers:e,selectedItems:g,billId:b.billId,elementId:b.elementId,
type:a})).show();h.hide()},function(a){console.log(a);h.hide()})},openItemTotalPreviewDialogForSelectedTender:function(){var a=this,b=a.gridOpts.tender_companies,c=[];a.gridOpts.gridContainer.viewTendererItemPreviewStore[a.billId].query().forEach(function(a){c.push(a.id)});var d=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});d.show();l.post("viewTendererReporting/getPrintingSelectedItemTotalByTenderer",{handleAs:"json",data:{bill_id:a.billId,itemIds:k.stringify(a.arrayUnique(c))}}).then(function(e){var g,
h;dojo.forEach(b,function(a){a.awarded&&(g=a.id,h=buildspace.truncateString(a.name,28))});(new z({project:a.rootProject,title:f.itemTotalSelectedTenderers,companyId:g,companyName:h,data:e,selectedItems:c,billId:a.billId,elementId:a.elementId})).show();d.hide()},function(a){console.log(a);d.hide()})},openItemTotalPreviewDialogForAllTenderers:function(a){var b=this,c=b.gridOpts.tender_companies,d=b.gridOpts.gridContainer.viewTendererItemPreviewStore[b.billId],e=[],g=[];b.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){e.push(a.id)});
d.query().forEach(function(a){g.push(a.id)});var h=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});h.show();l.post("viewTendererReporting/getPrintingSelectedItemTotalByAllTenderer",{handleAs:"json",data:{bill_id:b.billId,tendererIds:k.stringify(b.arrayUnique(e)),itemIds:k.stringify(b.arrayUnique(g)),type:a}}).then(function(d){(new z({project:b.rootProject,title:f.itemTotalAllTenderers+" ("+f[a]+")",companies:c,data:d,selectedTenderers:e,selectedItems:g,billId:b.billId,elementId:b.elementId,
type:a})).show();h.hide()},function(a){console.log(a);h.hide()})},openItemRateAndTotalPreviewDialogForAllTenderers:function(a){var b=this,c=b.gridOpts.tender_companies,d=b.gridOpts.gridContainer.viewTendererItemPreviewStore[b.billId],e=[],g=[];b.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){e.push(a.id)});d.query().forEach(function(a){g.push(a.id)});var h=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});h.show();l.post("viewTendererReporting/getSelectedItemByAllTenderers",
{handleAs:"json",data:{bill_id:b.billId,tendererIds:k.stringify(b.arrayUnique(e)),itemIds:k.stringify(b.arrayUnique(g)),type:a}}).then(function(d){(new E({project:b.rootProject,title:f.itemRateAndTotalAllTenderers+" ("+f[a]+")",companies:c,data:d,selectedTenderers:e,selectedItems:g,billId:b.billId,elementId:b.elementId,type:a})).show();h.hide()},function(a){console.log(a);h.hide()})},openItemRateAndTotalRevisionsPreviewDialogForAllTenderers:function(a){var b=this,c=b.gridOpts.tender_companies,d=b.gridOpts.gridContainer.viewTendererItemPreviewStore[b.billId],
e=[],g=[];b.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){e.push(a.id)});d.query().forEach(function(a){g.push(a.id)});var h=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});h.show();l.post("viewTendererReporting/getSelectedItemRevisionsByAllTenderers",{handleAs:"json",data:{bill_id:b.billId,tendererIds:k.stringify(b.arrayUnique(e)),itemIds:k.stringify(b.arrayUnique(g)),type:a}}).then(function(d){(new F({project:b.rootProject,title:f.itemRateAndTotalRevisionsAllTenderers+
" ("+f[a]+")",companies:c,data:d,selectedTenderers:e,selectedItems:g,billId:b.billId,elementId:b.elementId,type:a})).show();h.hide()},function(a){console.log(a);h.hide()})},openElementRevisionsPreviewDialogForAllTenderers:function(a){var b=this,c=b.gridOpts.tender_companies,d=b.gridOpts.gridContainer.viewTendererElementPreviewStore[b.billId],e=[],g=[];b.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){e.push(a.id)});d.query().forEach(function(a){g.push(a.id)});var h=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+
"..."});h.show();l.post("viewTendererReporting/getPrintingSelectedElementRevisionsByAllTenderer",{handleAs:"json",data:{bill_id:b.billId,tendererIds:k.stringify(b.arrayUnique(e)),elementIds:k.stringify(b.arrayUnique(g)),type:a}}).then(function(d){(new D({project:b.rootProject,title:f.projectSummaryRevisionsAllTenderers+" ("+f[a]+")",companies:c,data:d,selectedTenderers:e,selectedElements:g,billId:b.billId,type:a})).show();h.hide()},function(a){console.log(a);h.hide()})},openItemRateAndTotalPerUnitPreviewDialogForAllTenderers:function(a){var b=
this,c=b.gridOpts.tender_companies,d=b.gridOpts.gridContainer.viewTendererItemPreviewStore[b.billId],e=[],g=[];b.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){e.push(a.id)});d.query().forEach(function(a){g.push(a.id)});var h=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});h.show();l.post("viewTendererReporting/getSelectedItemPerUnitByAllTenderers",{handleAs:"json",data:{bill_id:b.billId,tendererIds:k.stringify(b.arrayUnique(e)),itemIds:k.stringify(b.arrayUnique(g)),
type:a}}).then(function(d){(new G({project:b.rootProject,title:f.itemRateAndTotalPerUnitAllTenderers+" ("+f[a]+")",companies:c,data:d,selectedTenderers:e,selectedItems:g,billId:b.billId,elementId:b.elementId,type:a})).show();h.hide()},function(a){console.log(a);h.hide()})},openElementPreviewDialogAmountPerUnitTypeForSelectedTenderer:function(){var a=this,b=a.gridOpts.tender_companies,c=a.gridOpts.gridContainer.viewTendererElementPreviewStore[a.billId],d=[],e=[];a.gridOpts.builderContainer.selectedTenderers.query().forEach(function(a){d.push(a.id)});
c.query().forEach(function(a){e.push(a.id)});var g=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});g.show();l.post("viewTendererReporting/getPrintingSelectedElementSummaryPerUnitTypeByTenderer",{handleAs:"json",data:{bill_id:a.billId,tendererIds:k.stringify(a.arrayUnique(d)),elementIds:k.stringify(a.arrayUnique(e))}}).then(function(c){(new H({project:a.rootProject,label:f.summaryPerUnit,companies:b,unitTypes:c.unitTypes,data:c.item,selectedTenderers:d,selectedElements:e,billId:a.billId})).show();
g.hide()},function(a){console.log(a);g.hide()})},arrayUnique:function(a){return a.reverse().filter(function(a,c,d){return-1===d.indexOf(a,c+1)}).reverse()}})});
