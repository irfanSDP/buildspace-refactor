define("buildspace/apps/ViewTendererReport/AssignContractorDialog","dojo/_base/declare dojo/aspect dojo/_base/lang dojo/_base/connect dojo/html dojo/dom dojo/keys dojo/dom-style dojo/currency buildspace/widget/grid/cells/Formatter dojox/grid/enhanced/plugins/IndirectSelection dojo/i18n!buildspace/nls/ViewTenderer".split(" "),function(e,g,h,f,r,t,k,l,m,n,u,d){var p=e("buildspace.apps.ViewTendererReport.ContractorGrid",dojox.grid.EnhancedGrid,{builderContainer:null,project:null,style:"border-top:none;",
region:"center",constructor:function(a){this.inherited(arguments);this.plugins={indirectSelection:{headerSelector:!0,width:"20px",styles:"text-align:center;"}}},canSort:function(a){return!1},onStyleRow:function(a){this.inherited(arguments);if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length){var b=a.node.children[0].children[0].rows[1],c=a.node.children[0].children[0].rows[0].children;b.parentNode.removeChild(b);dojo.forEach(c,function(a,b){var c=dojo.attr(a,"rowSpan");(!c||2>c)&&
dojo.attr(a,"rowSpan",2)})}},postCreate:function(){var a=this;a.inherited(arguments);g.after(a,"_onFetchComplete",function(){a.markedCheckBoxObject(a,a.builderContainer.selectedTenderers)})},startup:function(){var a=this;a.inherited(arguments);this._connects.push(f.connect(this,"onCellClick",function(b){""===b.cell.name&&a.singleCheckBoxSelection(b)}));this._connects.push(f.connect(this.rowSelectCell,"toggleAllSelection",function(b){a.toggleAllSelection(b)}))},singleCheckBoxSelection:function(a){var b=
this.getItem(a.rowIndex);this.selection.isSelected(a.rowIndex)?this.builderContainer.selectedTenderers.put({id:b.id[0]}):this.builderContainer.selectedTenderers.remove(b.id[0])},toggleAllSelection:function(a){var b=this,c=this.selection;c.selectRange(0,b.rowCount-1);a?b.store.fetch({onComplete:function(a){dojo.forEach(a,function(a,c){0<a.id&&b.builderContainer.selectedTenderers.put({id:a.id[0]})})}}):(c.deselectAll(),b.store.fetch({onComplete:function(a){dojo.forEach(a,function(a,c){0<a.id&&b.builderContainer.selectedTenderers.remove(a.id[0])})}}))},
markedCheckBoxObject:function(a,b){var c=a.store;b.query().forEach(function(b){b.id!=buildspace.constants.GRID_LAST_ROW&&c.fetchItemByIdentity({identity:b.id,onItem:function(b){if(b)return a.rowSelectCell.toggleRow(b._0,!0)}})})},destroy:function(){this.inherited(arguments);dojo.forEach(this._connects,f.disconnect);delete this._connects}}),q=e("buildspace.apps.ViewTendererReport.ContractorGridContainer",dijit.layout.BorderContainer,{style:"padding:0px;border:0px;width:100%;height:100%;",gutters:!1,
region:"center",project:null,grid:null,gridOpts:{},postCreate:function(){this.inherited(arguments);h.mixin(this.gridOpts,{project:this.project,region:"center"});var a=this.grid=new p(this.gridOpts);this.addChild(new dijit.layout.ContentPane({style:"width:100%",content:a,region:"center"}))}});return e("buildspace.apps.ViewTendererReport.AssignContractorDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",title:d.assignContractors,builderContainer:null,project:null,formValues:[],buildRendering:function(){var a=
this.createContent();a.startup();this.content=a;this.title=d.assignContractors+" :: "+buildspace.truncateString(this.project.title,45);this.inherited(arguments)},postCreate:function(){l.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";this.inherited(arguments)},_onKey:function(a){a.keyCode==k.ESCAPE&&dojo.stopEvent(a)},onHide:function(){this.destroyRecursive()},createContent:function(){var a=new dijit.layout.BorderContainer({style:"padding:0px;width:850px;height:350px;",
gutters:!1}),b=new n,c=new dijit.Toolbar({region:"top",style:"outline:none!important;padding:2px;overflow:hidden;border:none;"}),e=new dojo.data.ItemFileWriteStore({url:"viewTenderer/getContractors/id/"+this.project.id,clearOnClose:!0}),b=new q({project:this.project,gridOpts:{id:"viewTenderer-contractorGrid_"+this.project.id,store:e,structure:{cells:[[{name:"No.",field:"id",width:"30px",styles:"text-align:center;",formatter:b.rowCountCellFormatter,rowSpan:2},{name:d.name,field:"name",width:"auto",
rowSpan:2},{name:d.originalTotal,field:"total",width:"120px",headerClasses:"typeHeader1",styles:"text-align:right;",formatter:b.unEditableCurrencyCellFormatter},{name:d.adjustedTotal,field:"adjusted_total",headerClasses:"typeHeader1",width:"120px",styles:"text-align:right;",formatter:b.unEditableCurrencyCellFormatter}],[{colSpan:2,headerClasses:"staticHeader typeHeader1",headerId:1,hidden:!1,name:d.diff+": "+m.format(0),styles:"text-align:center;"}]]},builderContainer:this.builderContainer}});c.addChild(new dijit.form.Button({label:d.close,
iconClass:"icon-16-container icon-16-close",style:"outline:none!important;",onClick:dojo.hitch(this,"hide")}));a.addChild(c);a.addChild(b);return a}})});
