(function(){define("buildspace/apps/ViewTendererReport/PrintPreviewDialog/PrintSelectedElementRevisionsGridDialog","dojo/_base/declare dojo/aspect dojo/_base/lang dojo/_base/connect dojo/when dojo/html dojo/dom dojo/keys dojo/dom-style dojo/request dojo/json ./PrintPreviewFormDialog buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/TenderingReport".split(" "),function(h,y,z,A,B,C,D,t,u,g,v,w,x,e){var q,r;q=h("buildspace.apps.TenderingReport.SelectedElementRevisionsGrid",dojox.grid.EnhancedGrid,
{style:"border-top:none;",region:"center",selectedElements:[],escapeHTMLInData:!1,canSort:function(){return!1},onStyleRow:function(a){this.inherited(arguments);if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length){var b=a.node.children[0].children[0].rows[1],c=a.node.children[0].children[0].rows[0].children;b.parentNode.removeChild(b);dojo.forEach(c,function(a,b){var c=dojo.attr(a,"rowSpan");(!c||2>c)&&dojo.attr(a,"rowSpan",2)})}}});r=h("buildspace.apps.TenderingReport.SelectedElementRevisionsGridContainer",
dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;",region:"center",gutters:!1,billId:-1,dialog:null,store:null,structure:null,selectedTenderers:[],selectedElements:[],type:null,postCreate:function(){var a,b,c;b=this;b.inherited(arguments);a=this.grid=new q({store:b.store,structure:b.structure,selectedElements:b.selectedElements});c=new dijit.Toolbar({region:"top",style:"padding:2px;border-bottom:none;width:100%;"});c.addChild(new dijit.form.Button({label:e.print,iconClass:"icon-16-container icon-16-print",
onClick:function(a){return b.openPrintingDialog()}}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({label:e.close,iconClass:"icon-16-container icon-16-close",onClick:function(){return b.dialog.hide()}}));b.addChild(c);return b.addChild(new dijit.layout.ContentPane({style:"width:100%",content:a,region:"center"}))},openPrintingDialog:function(a){var b;null==a&&(a=this);b=buildspace.dialog.indeterminateProgressBar({title:e.pleaseWait+"..."});b.show();return g.get("viewTendererReporting/getPrintingInformation",
{handleAs:"json"}).then(function(c){c=new w({title:a.dialog.title,selectedTenderers:a.selectedTenderers,selectedRows:a.selectedElements,billId:a.billId,type:a.type,printURL:null,exportURL:"exportExcelReport/exportSelectedElementRevisions",_csrf_token:c._csrf_token});b.hide();return c.show()},function(a){return b.hide()})}});return h("buildspace.apps.TenderingReport.GroupProjectAssignmentDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",companyId:-1,billId:-1,companyName:null,data:null,selectedTenderers:[],
selectedElements:[],buildRendering:function(){var a;a=this.createContent();a.startup();this.content=a;return this.inherited(arguments)},postCreate:function(){u.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";return this.inherited(arguments)},_onKey:function(a){if(a.keyCode===t.ESCAPE)return dojo.stopEvent(a)},onHide:function(){return this.destroyRecursive()},createContent:function(){var a,b,c;b={};var d=[];a=new dijit.layout.BorderContainer({style:"padding:0px;width:1280px;height:600px;",
gutters:!1});0<this.selectedTenderers.length&&this.type&&g("viewTendererReporting/getContractors",{sync:!0,handleAs:"json",query:{id:this.project.id,type:this.type,contractorIds:v.stringify(this.selectedTenderers)}}).then(function(a){return b=a},function(a){return console.log(a)});g("viewTendererReporting/getRevisions",{sync:!0,handleAs:"json",query:{id:this.project.id}}).then(function(a){return d=a.revisions},function(a){console.log(a)});c=new r({store:dojo.data.ItemFileWriteStore({data:this.data}),
dialog:this,billId:this.billId,selectedTenderers:this.selectedTenderers,selectedElements:this.selectedElements,structure:this.constructGridStructure(b,d),type:this.type});a.addChild(c);return a},constructGridStructure:function(a,b,c,d){var l,k,n,h,g=[],m=[],p=b.length-1;null==a&&(a=[]);d=new x;h=[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:d.rowCountCellFormatter},{name:e.description,field:"description",width:"auto",formatter:d.printPreviewTreeCellFormatter,noresize:!0}];
for(var f=0;f<p;f++)k=b[f].revision,m.push({name:k+" "+e.grandTotal,field:"grand_total-revision-"+f,width:"100px",styles:"text-align:right;color:blue;",formatter:d.unEditableCurrencyCellFormatter,noresize:!0});m.push({name:e.grandTotal,field:"grand_total",styles:"text-align:right;color:blue;",width:"100px",formatter:d.unEditableCurrencyCellFormatter,noresize:!0});g.push({name:e.estimate,styles:"text-align:center;",colSpan:1+p});for(l in a){n=a[l].awarded?"blue":"black";c=buildspace.truncateString(a[l].name,
28);for(f=0;f<p;f++)k=b[f].revision,m.push({name:k+" "+e.grandTotal,field:a[l].id+"-grand_total-revision-"+f,width:"100px",styles:"text-align:right;color:"+n+";",formatter:d.printPreviewTendererCurrencyCellFormatter,noresize:!0});k={name:e.grandTotal,field:a[l].id+"-grand_total",styles:"text-align:right;color:"+n+";",width:"100px",formatter:d.printPreviewTendererCurrencyCellFormatter,noresize:!0};m.push(k);g.push({name:'<span style="color:'+n+'">'+c+"</span>",styles:"text-align:center;",colSpan:1+
p})}return[{cells:[h],width:"410px",noscroll:!0},{cells:[m,g]}]}})})}).call(this);
