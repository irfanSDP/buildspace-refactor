(function(){define("buildspace/apps/ViewTendererReport/PrintPreviewDialog/PrintSelectedItemRateAndTotalPerUnitGridDialog","dojo/_base/declare dojo/aspect dojo/_base/lang dojo/_base/connect dojo/when dojo/html dojo/dom dojo/keys dojo/dom-style dojo/request dojo/json ./PrintPreviewFormDialog buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/TenderingReport".split(" "),function(f,w,x,y,z,A,B,q,r,g,t,u,v,d){var l,m;l=f("buildspace.apps.TenderingReport.SelectedItemRateAndTotalPerUnitGrid",
dojox.grid.EnhancedGrid,{style:"border-top:none;",region:"center",selectedItems:[],escapeHTMLInData:!1,canSort:function(){return!1},onHeaderCellMouseOver:function(a){dojo.hasClass(a.cell.id,"staticHeader")||dojo.addClass(a.cellNode,this.cellOverClass)},onStyleRow:function(a){this.inherited(arguments);if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length){var b=a.node.children[0].children[0].rows[1],c=a.node.children[0].children[0].rows[0].children;b.parentNode.removeChild(b);dojo.forEach(c,
function(a,b){var c=dojo.attr(a,"rowSpan");(!c||2>c)&&dojo.attr(a,"rowSpan",2)})}}});m=f("buildspace.apps.TenderingReport.SelectedItemRateAndTotalPerUnitGridContainer",dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;",region:"center",gutters:!1,billId:-1,elementId:-1,dialog:null,store:null,structure:null,selectedTenderers:[],selectedItems:[],type:null,postCreate:function(){var a,b,c;b=this;b.inherited(arguments);a=this.grid=new l({store:b.store,structure:b.structure,selectedItems:b.selectedItems});
c=new dijit.Toolbar({region:"top",style:"padding:2px;border-bottom:none;width:100%;"});c.addChild(new dijit.form.Button({label:d.print,iconClass:"icon-16-container icon-16-print",onClick:function(a){return b.openPrintingDialog()}}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({label:d.close,iconClass:"icon-16-container icon-16-close",onClick:function(){return b.dialog.hide()}}));b.addChild(c);return b.addChild(new dijit.layout.ContentPane({style:"width:100%",content:a,
region:"center"}))},openPrintingDialog:function(a){var b;null==a&&(a=this);b=buildspace.dialog.indeterminateProgressBar({title:d.pleaseWait+"..."});b.show();return g.get("viewTendererReporting/getPrintingInformation",{handleAs:"json"}).then(function(c){c=new u({title:a.dialog.title,selectedTenderers:a.selectedTenderers,selectedRows:a.selectedItems,type:a.type,printURL:"printReport/printItemRateAndTotalPerUnit",exportURL:"exportExcelReport/exportItemRateAndTotalPerUnit",billId:a.billId,elementId:a.elementId,
_csrf_token:c._csrf_token});b.hide();return c.show()},function(a){return b.hide()})}});return f("buildspace.apps.TenderingReport.GroupProjectAssignmentDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",project:null,companyId:-1,companyName:null,billId:-1,elementId:-1,data:null,type:null,selectedTenderers:[],selectedItems:[],buildRendering:function(){var a;a=this.createContent();a.startup();this.content=a;return this.inherited(arguments)},postCreate:function(){r.set(this.containerNode,{padding:"0px",
margin:"0px"});this.closeButtonNode.style.display="none";return this.inherited(arguments)},_onKey:function(a){if(a.keyCode===q.ESCAPE)return dojo.stopEvent(a)},onHide:function(){return this.destroyRecursive()},createContent:function(){var a,b,c,d;b={};d=[];a=new dijit.layout.BorderContainer({style:"padding:0px;width:1280px;height:600px;",gutters:!1});0<this.selectedTenderers.length&&this.type&&g("viewTendererReporting/getContractors",{sync:!0,handleAs:"json",query:{id:this.project.id,type:this.type,
contractorIds:t.stringify(this.selectedTenderers)}}).then(function(a){return b=a},function(a){return console.log(a)});g("billManager/getBillInfo",{sync:!0,handleAs:"json",query:{id:this.billId}}).then(function(a){return d=a.column_settings},function(a){return console.log(a)});c=new m({store:dojo.data.ItemFileWriteStore({data:this.data}),dialog:this,billId:this.billId,elementId:this.elementId,selectedTenderers:this.selectedTenderers,selectedItems:this.selectedItems,structure:this.constructGridStructure(b,
d),type:this.type});a.addChild(c);return a},constructGridStructure:function(a,b,c,f){var g,e,h,p,l;c=[];f=1;null==a&&(a=[]);for(g in a)f++;e=new v;l=[{name:d.no,field:"id",width:"30px",styles:"text-align: center;",formatter:e.rowCountCellFormatter},{name:d.billReference,field:"bill_ref",width:"80px",styles:"text-align:center; color: red;",formatter:e.billRefCellFormatter,noresize:!0},{name:d.description,field:"description",width:"auto",formatter:e.printPreviewTreeCellFormatter,noresize:!0},{name:d.unit,
field:"uom_id",width:"70px",styles:"text-align:center;",formatter:e.unitIdCellFormatter,noresize:!0}];p=[];var m=[],n,k;for(k in b)for(n in p.push({name:d.estimate,styles:"text-align:center;",headerClasses:"staticHeader",colSpan:2}),m.push({name:b[k].name+"<br/>("+d.totalUnits+": "+b[k].quantity+")",styles:"text-align:center;",headerClasses:"staticHeader",colSpan:1+2*f}),c.push({name:d.singleUnitQuantity,field:b[k].id+"-quantity_per_unit-final_value",width:"70px",rowSpan:2,styles:"text-align:right;color:blue;",
formatter:e.unEditableNumberAndTextCellFormatter,noresize:!0}),c.push({name:d.rate,field:"single_unit_quantity",width:"100px",styles:"text-align:right;color:blue;",formatter:e.unEditableCurrencyCellFormatter,noresize:!0}),c.push({name:d.singleUnitTotal,field:b[k].id+"-total_per_unit",width:"100px",styles:"text-align:right;color:blue;",formatter:e.unEditableCurrencyCellFormatter,noresize:!0}),a)h=a[n].awarded?"blue":"black",g=buildspace.truncateString(a[n].name,28),c.push({name:'<span style="color:'+
h+'">'+d.rate+"</span>",field:a[n].id+"-rate-value",styles:"text-align:right;color:"+h+";",width:"100px",formatter:e.printPreviewTendererRateCellFormatter,noresize:!0}),c.push({name:'<span style="color:'+h+'">'+d.singleUnitTotal+"</span>",field:a[n].id+"-"+b[k].id+"-total_per_unit",styles:"text-align:right;color:"+h+";",width:"100px",formatter:e.printPreviewTendererCurrencyCellFormatter,noresize:!0}),p.push({name:'<span style="color:'+h+'">'+g+"</span>",styles:"text-align:center;color:"+h+";",headerClasses:"staticHeader",
colSpan:2});return[{cells:[l],width:"560px",noscroll:!0},{cells:[c,p,m]}]}})})}).call(this);
