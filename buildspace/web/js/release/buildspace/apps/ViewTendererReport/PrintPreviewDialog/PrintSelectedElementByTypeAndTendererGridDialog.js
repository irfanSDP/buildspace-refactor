(function(){define("buildspace/apps/ViewTendererReport/PrintPreviewDialog/PrintSelectedElementByTypeAndTendererGridDialog","dojo/_base/declare dojo/aspect dojo/_base/lang dojo/_base/connect dojo/when dojo/html dojo/dom dojo/keys dojo/dom-style dojo/request dojo/json ./PrintPreviewFormDialog buildspace/widget/grid/cells/Formatter dojo/i18n!buildspace/nls/TenderingReport".split(" "),function(d,x,y,z,A,B,C,r,t,n,u,v,w,f){var p,q;p=d("buildspace.apps.TenderingReport.SelectedElementGrid",dojox.grid.EnhancedGrid,
{style:"border-top:none;",region:"center",selectedElements:[],escapeHTMLInData:!1,canSort:function(){return!1},onStyleRow:function(a){var b,c;this.inherited(arguments);if(a.node.children[0]&&2<=a.node.children[0].children[0].rows.length)return c=a.node.children[0].children[0].rows[1],b=a.node.children[0].children[0].rows[0].children,c.parentNode.removeChild(c),dojo.forEach(b,function(a,b){var c;c=dojo.attr(a,"rowSpan");if(!c||2>c)return dojo.attr(a,"rowSpan",2)})}});q=d("buildspace.apps.TenderingReport.SelectedElementGridContainer",
dijit.layout.BorderContainer,{style:"padding:0px;width:100%;height:100%;",region:"center",gutters:!1,billId:-1,dialog:null,store:null,structure:null,selectedTenderers:[],selectedElements:[],postCreate:function(){var a,b,c;b=this;b.inherited(arguments);a=this.grid=new p({store:b.store,structure:b.structure,selectedElements:b.selectedElements});c=new dijit.Toolbar({region:"top",style:"padding:2px;border-bottom:none;width:100%;"});c.addChild(new dijit.form.Button({label:f.print,iconClass:"icon-16-container icon-16-print",
onClick:function(a){return b.openPrintingDialog()}}));c.addChild(new dijit.ToolbarSeparator);c.addChild(new dijit.form.Button({label:f.close,iconClass:"icon-16-container icon-16-close",onClick:function(){return b.dialog.hide()}}));b.addChild(c);return b.addChild(new dijit.layout.ContentPane({style:"width:100%",content:a,region:"center"}))},openPrintingDialog:function(a){var b;null==a&&(a=this);b=buildspace.dialog.indeterminateProgressBar({title:f.pleaseWait+"..."});b.show();return n.get("viewTendererReporting/getPrintingInformation",
{handleAs:"json"}).then(function(c){c=new v({title:a.dialog.title,selectedTenderers:a.selectedTenderers,selectedRows:a.selectedElements,billId:a.billId,printURL:"printReport/printSelectedElementSummaryPerUnitTypeByTenderer",exportURL:"exportExcelReport/exportSelectedElementSummaryPerUnitTypeByTenderer",_csrf_token:c._csrf_token});b.hide();return c.show()},function(a){return b.hide()})}});return d("buildspace.apps.TenderingReport.GroupProjectAssignmentDialog",dijit.Dialog,{style:"padding:0px;margin:0px;",
billId:-1,companyName:null,data:null,unitTypes:null,selectedTenderers:[],selectedElements:[],buildRendering:function(){var a;a=this.createContent();a.startup();this.content=a;return this.inherited(arguments)},postCreate:function(){t.set(this.containerNode,{padding:"0px",margin:"0px"});this.closeButtonNode.style.display="none";return this.inherited(arguments)},_onKey:function(a){if(a.keyCode===r.ESCAPE)return dojo.stopEvent(a)},onHide:function(){return this.destroyRecursive()},createContent:function(){var a,
b,c;b={};a=new dijit.layout.BorderContainer({style:"padding:0px;width:1280px;height:600px;",gutters:!1});0<this.selectedTenderers.length&&n("viewTendererReporting/getContractorsForSummaryPerUnitType",{sync:!0,handleAs:"json",query:{id:this.project.id,contractorIds:u.stringify(this.selectedTenderers)}}).then(function(a){return b=a},function(a){return console.log(a)});c=new q({store:dojo.data.ItemFileWriteStore({data:this.data}),dialog:this,billId:this.billId,selectedTenderers:this.selectedTenderers,
selectedElements:this.selectedElements,structure:this.constructGridStructure(b)});a.addChild(c);return a},constructGridStructure:function(a){var b,c,h,d;null==a&&(a=[]);h=new w;c=0;d=[];b={noscroll:!1,width:"50",cells:[[{name:"No",field:"id",width:"30px",styles:"text-align: center;",formatter:h.rowCountCellFormatter,rowSpan:2},{name:f.description,field:"description",width:"380px",noresize:!0,rowSpan:2}]]};dojo.forEach(this.unitTypes,function(l){var e,g,k,m;g=a.length+1;c++;d.push({name:l.name,styles:"text-align:center;",
headerClasses:"staticHeader typeHeader"+c,colSpan:g});e={name:f.estimate,field:l.id+"-estimate_total",styles:"text-align:right;",width:"100px",formatter:h.printPreviewTendererCurrencyCellFormatter,noresize:!0};b.cells[0].push(e);g=[];for(k in a)m=a[k].awarded?"blue":"black",e=buildspace.truncateString(a[k].name,28),e={name:'<span style="color:'+m+'">'+e+"</span>",field:l.id+"-"+a[k].id+"-total",styles:"text-align:right;color:"+m+";",width:"100px",formatter:h.printPreviewTendererCurrencyCellFormatter,
noresize:!0},g.push(b.cells[0].push(e));return g});b.cells.push(d);return b}})})}).call(this);
