require(["dojo/_base/declare","buildspace/apps/_App"],function(n,p){buildspace.app={appList:[],instances:[],instanceCount:0,currentApp:"",loadAppList:!0,init:function(a){(this.loadAppList=a.loadAppList)&&dojo.xhrGet({url:"default/getMyApps",sync:!0,load:dojo.hitch(this,function(a,f){this.appList=a;buildspace.app.appList=this.appList}),handleAs:"json"})},launch:function(a,h,f,k){if(a.sysname){var b=a.sysname,l=buildspace.dialog.indeterminateProgressBar({title:"Please wait..."});require(["buildspace/apps/"+
b]);l.show().then(function(){dojo.addOnLoad(function(){l.hide();dojo.publish("launchApp",[b]);var c=new dojo.Deferred;f&&c.addCallback(f);k&&c.addErrback(k);var e=!1;try{var e=buildspace.app.instances.length,g=buildspace.app.instances[e]=new buildspace.apps[b]({sysname:b,name:a.title,instance:e,icon:a.icon,args:h});try{g.init(h||{})}catch(d){dojo.publish("launchAppEnd",[b]);console.error(d);c.errback(d);return}g.status="active"}catch(d){dojo.publish("launchAppEnd",[b]);console.error(d);c.errback(d);
return}c.callback(g);dojo.publish("launchAppEnd",[b]);return e})})}else{var m=dijit.byId("buildspace-main_window");m&&m.close()}}}});
