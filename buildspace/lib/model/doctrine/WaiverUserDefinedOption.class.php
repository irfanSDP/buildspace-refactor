<?php

/**
 * WaiverUserDefinedOption
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 *  
 * @package    buildspace
 * @subpackage model
 * @author     1337 developers
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class WaiverUserDefinedOption extends BaseWaiverUserDefinedOption
{
    public static function find(ProjectStructure $project, $waiverOptionType)
    {
        $query = DoctrineQuery::create()
                    ->select('*')
                    ->from('WaiverUserDefinedOption o')
                    ->where('o.project_structure_id = ?', $project->id)
                    ->andWhere('o.waiver_option_type = ?', $waiverOptionType);
        
        return $query->fetchOne();
    }

    public static function addOrUpdateEntry(ProjectStructure $project, $waiverOptionType, $description)
    {
        $record = self::find($project, $waiverOptionType);

        if(!$record)
        {

            $record = new self;
            $record->project_structure_id = $project->id;
            $record->waiver_option_type = $waiverOptionType;
        }

        $record->description = $description;
        $record->save();
    }

    public static function deleteEntry(ProjectStructure $project, $waiverOptionTypes)
    {
        Doctrine_Query::create()
                    ->delete('WaiverUserDefinedOption o')
                    ->where('o.project_structure_id = ?', $project->id)
                    ->andWhereNotIn('o.waiver_option_type', $waiverOptionTypes)
                    ->execute();
    }
}
