<?php

/**
 * UnitOfMeasurement
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 *
 * @package    buildspace
 * @subpackage model
 * @author     1337 developers
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class UnitOfMeasurement extends BaseUnitOfMeasurement
{
    const UNIT_TYPE_METRIC   = 1;
    const UNIT_TYPE_IMPERIAL = 2;

    public function delete(Doctrine_Connection $conn = null)
    {
        $conn = !$conn ? Doctrine_Manager::getInstance()->connection() : $conn;

        if($this->canBeDeleted())
        {
            UnitOfMeasurementTable::resetResourceItemUom($this, $conn);

            UnitOfMeasurementTable::resetBQLibraryItemUom($this, $conn);
            UnitOfMeasurementTable::resetBQLibraryBuildUpRateItemUom($this, $conn);

            UnitOfMeasurementTable::resetScheduleOfRateItemUom($this, $conn);
            UnitOfMeasurementTable::resetScheduleOfRateBuildUpRateItemUom($this, $conn);

            UnitOfMeasurementTable::resetBillItemUom($this, $conn);
            UnitOfMeasurementTable::resetBillBuildUpRateItemUom($this, $conn);

            parent::delete($conn);
        }
        else
        {
            throw new Exception('Unit of measurement with id: '.$this->id." cannot be deleted");
        }
    }

    public function canBeDeleted()
    {
        return UnitOfMeasurementTable::canBeDeletedById($this->id);
    }
}