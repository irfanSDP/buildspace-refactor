<?php

/**
 * ItemCodeSettingObject
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 * 
 *  
 * @package    buildspace
 * @subpackage model
 * @author     1337 developers
 * @version    SVN: $Id: Builder.php 7490 2010-03-29 19:53:27Z jwage $
 */
class ItemCodeSettingObject extends BaseItemCodeSettingObject
{
    const TYPE_BILL = 1;
    const TYPE_VARIATION_ORDER = 2;
    const TYPE_REQUEST_FOR_VARIATION_CLAIM = 4;
    const TYPE_MATERIAL_ON_SITE = 8;

    public static function find(ProjectStructure $project, $objectId, $objectType)
    {
        $query = DoctrineQuery::create()
                    ->select('*')
                    ->from('ItemCodeSettingObject obj')
                    ->where('obj.project_structure_id = ?', $project->id)
                    ->andWhere('obj.object_id = ?', $objectId)
                    ->andWhere('obj.object_type = ?', $objectType);
                    
        return $query->fetchOne();
    }

    public static function create(ProjectStructure $project, $objectId, $objectType)
    {
        $newItemCodeSettingObject = new self;
        $newItemCodeSettingObject->project_structure_id = $project->id;
        $newItemCodeSettingObject->object_id = $objectId;
        $newItemCodeSettingObject->object_type = $objectType;
        $newItemCodeSettingObject->created_by = sfContext::getInstance()->getUser()->getGuardUser()->getId();
        $newItemCodeSettingObject->updated_by = sfContext::getInstance()->getUser()->getGuardUser()->getId();
        $newItemCodeSettingObject->save();

        return $newItemCodeSettingObject;
    }
}
