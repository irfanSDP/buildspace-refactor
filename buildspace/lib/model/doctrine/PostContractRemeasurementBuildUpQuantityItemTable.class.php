<?php

/**
 * PostContractRemeasurementBuildUpQuantityItemTable
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class PostContractRemeasurementBuildUpQuantityItemTable extends Doctrine_Table
{
	/**
	 * Returns an instance of this class.
	 *
	 * @return object PostContractRemeasurementBuildUpQuantityItemTable
	 */
	public static function getInstance()
	{
		return Doctrine_Core::getTable('PostContractRemeasurementBuildUpQuantityItem');
	}

	public static function getSignTextBySign($sign)
	{
		switch($sign)
		{
			case BillBuildUpQuantityItem::SIGN_POSITIVE:
				return BillBuildUpQuantityItem::SIGN_POSITIVE_TEXT;
			case BillBuildUpQuantityItem::SIGN_NEGATIVE:
				return BillBuildUpQuantityItem::SIGN_NEGATIVE_TEXT;
			default:
				throw new Exception('invalid sign');
		}
	}

	public static function getFormulatedColumnNames(UnitOfMeasurement $unitOfMeasurement)
	{
		$columnNames = array();
		foreach($unitOfMeasurement->Dimensions as $dimension)
		{
			$columnNames[] = $dimension->id.'-dimension_column';
		}

		array_push($columnNames, BillBuildUpQuantityItem::FORMULATED_COLUMN_FACTOR);

		return $columnNames;
	}

	public static function getFormulatedColumnByRelationIdAndColumnName($id, $columnName, $hydrate=null)
	{
		$query = DoctrineQuery::create()
		->select('*')
		->from('PostContractRemeasurementBuildUpQuantityFormulatedColumn c')
		->where('c.relation_id = ?', $id)
		->andWhere('c.column_name = ?', $columnName)
		->limit(1);

		if(!is_null($hydrate))
		{
			$query->setHydrationMode($hydrate);
		}

		return $query->fetchOne();
	}
}