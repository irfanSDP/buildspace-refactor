<?php

/**
 * MasterCostDataParticularTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class MasterCostDataParticularTable extends Doctrine_Table
{
    /**
     * Returns an instance of this class.
     *
     * @return MasterCostDataParticularTable The table instance
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('MasterCostDataParticular');
    }

    public static function unitsMatch(array $projectParticularIds)
    {
        if(empty($projectParticularIds)) return false;

        $pdo = self::getInstance()->getConnection()->getDbh();

        $idStatement = implode(',', $projectParticularIds);

        $statement = "SELECT distinct(uom_id) FROM ".self::getInstance()->getTableName()." p
        WHERE p.id in ({$idStatement})";

        $stmt = $pdo->prepare($statement);

        $stmt->execute();

        $records =  $stmt->fetchAll(PDO::FETCH_COLUMN,0);

        return count($records) == 1;
    }
}