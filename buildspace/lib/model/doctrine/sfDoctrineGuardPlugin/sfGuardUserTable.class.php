<?php

/**
 * sfGuardUserTable
 *
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class sfGuardUserTable extends PluginsfGuardUserTable {

    /**
     * Returns an instance of this class.
     *
     * @return object sfGuardUserTable
     */
    public static function getInstance()
    {
        return Doctrine_Core::getTable('sfGuardUser');
    }

    public static function getUserCount()
    {
        $maxUsers = sfConfig::get('app_maximum_users');

        $userCount = Doctrine_Query::create()
            ->from('sfGuardUser u')
            ->select('count(*) as userCount')
            ->execute(array(), Doctrine_Core::HYDRATE_SINGLE_SCALAR);

        if ( $userCount >= $maxUsers )
        {
            throw new Exception('Reached the maximum users count of ' . $maxUsers);
        }
    }

}